Target Seasons: ['20252026', '20242025', '20232024', '20222023', '20212022', '20202021', '20192020', '20182019', '20172018', '20162017', '20152016']

==========================================
 PHASE 0: DELETING OLD DATA
==========================================

Config: Mode=aggressive, Workers=1, Platform=Pi
Deleting /ssd/new_puck/data/20182019...
Deleting /ssd/new_puck/data/20252026...
Deleting /ssd/new_puck/data/20152016...
Deleting /ssd/new_puck/data/20222023...
Deleting /ssd/new_puck/data/20162017...
Deleting /ssd/new_puck/data/20232024...
Deleting /ssd/new_puck/data/20242025...
Deleting /ssd/new_puck/data/20172018...
Deleting /ssd/new_puck/data/20202021...
Deleting /ssd/new_puck/data/20212022...
Deleting /ssd/new_puck/data/20192020...

==========================================
 PHASE 1: DOWNLOADING & PARSING (Pi Optimized)
==========================================

Fetching games list for 20252026...
Found 89 games for 20252026. Processing sequentially...
  Progress: 0/89 games processed...
  Progress: 50/89 games processed...
Saving 9758 events for 20252026...
Fetching games list for 20242025...
Found 89 games for 20242025. Processing sequentially...
  Progress: 0/89 games processed...
  Progress: 50/89 games processed...
Saving 24173 events for 20242025...
Fetching games list for 20232024...
Found 88 games for 20232024. Processing sequentially...
  Progress: 0/88 games processed...
  Progress: 50/88 games processed...
Saving 23930 events for 20232024...
Fetching games list for 20222023...
Found 88 games for 20222023. Processing sequentially...
  Progress: 0/88 games processed...
  Progress: 50/88 games processed...
Saving 23440 events for 20222023...
Fetching games list for 20212022...
Found 88 games for 20212022. Processing sequentially...
  Progress: 0/88 games processed...
  Progress: 50/88 games processed...
Saving 22788 events for 20212022...
Fetching games list for 20202021...
Found 56 games for 20202021. Processing sequentially...
  Progress: 0/56 games processed...
  Progress: 50/56 games processed...
Saving 14055 events for 20202021...
Fetching games list for 20192020...
Found 93 games for 20192020. Processing sequentially...
  Progress: 0/93 games processed...
  Progress: 50/93 games processed...
Saving 24391 events for 20192020...
Fetching games list for 20182019...
Found 90 games for 20182019. Processing sequentially...
  Progress: 0/90 games processed...
  Progress: 50/90 games processed...
Saving 23750 events for 20182019...
Fetching games list for 20172018...
Found 96 games for 20172018. Processing sequentially...
  Progress: 0/96 games processed...
  Progress: 50/96 games processed...
Saving 24843 events for 20172018...
Fetching games list for 20162017...
Found 90 games for 20162017. Processing sequentially...
  Progress: 0/90 games processed...
  Progress: 50/90 games processed...
Saving 24289 events for 20162017...
Fetching games list for 20152016...
Found 95 games for 20152016. Processing sequentially...
  Progress: 0/95 games processed...
  Progress: 50/95 games processed...
Saving 26283 events for 20152016...

==========================================
 PHASE 2: TRAINING MODELS
==========================================

Loading 20252026 from disk...
Loading 20242025 from disk...
Loading 20232024 from disk...
Loading 20222023 from disk...
Loading 20212022 from disk...
Loading 20202021 from disk...
Loading 20192020 from disk...
Loading 20182019 from disk...
Loading 20172018 from disk...
Loading 20162017 from disk...
Loading 20152016 from disk...
Concatenating 11 seasons...
Total training rows (all events): 241700

--- Training Single Layer Model (No Blocks) ---
Saved Single Layer Model to /ssd/new_puck/analysis/xgs/xg_model_single.joblib

--- Training Nested Model (With Blocks + Imputation) ---
Applying 'mean_6' imputation...
Saved Nested Model to /ssd/new_puck/analysis/xgs/xg_model_nested.joblib

Backfill Complete!
Config: Mode=aggressive, Workers=1, Platform=Pi
--- Starting Daily Update for Season 20252026 ---
DEBUG: get_season finished. Found 1340 games for 20252026 matching prefix 2025
_season: starting fetch for season=20252026, team=all, games=1340, workers=4, use_cache=True
Fetching feeds: 1/1340
Fetching feeds: 2/1340
Fetching feeds: 3/1340
Fetching feeds: 4/1340
Fetching feeds: 5/1340
Fetching feeds: 6/1340
Fetching feeds: 7/1340
Fetching feeds: 8/1340
Fetching feeds: 9/1340
Fetching feeds: 10/1340
Fetching feeds: 11/1340
Fetching feeds: 12/1340
Fetching feeds: 13/1340
Fetching feeds: 14/1340
Fetching feeds: 15/1340
Fetching feeds: 16/1340
Fetching feeds: 17/1340
Fetching feeds: 18/1340
Fetching feeds: 19/1340
Fetching feeds: 20/1340
Fetching feeds: 21/1340
Fetching feeds: 22/1340
Fetching feeds: 23/1340
Fetching feeds: 24/1340
Fetching feeds: 25/1340
Fetching feeds: 26/1340
Fetching feeds: 27/1340
Fetching feeds: 28/1340
Fetching feeds: 29/1340
Fetching feeds: 30/1340
Fetching feeds: 31/1340
Fetching feeds: 32/1340
Fetching feeds: 33/1340
Fetching feeds: 34/1340
Fetching feeds: 35/1340
Fetching feeds: 36/1340
Fetching feeds: 37/1340
Fetching feeds: 38/1340
Fetching feeds: 39/1340
Fetching feeds: 40/1340
Fetching feeds: 41/1340
Fetching feeds: 42/1340
Fetching feeds: 43/1340
Fetching feeds: 44/1340
Fetching feeds: 45/1340
Fetching feeds: 46/1340
Fetching feeds: 47/1340
Fetching feeds: 48/1340
Fetching feeds: 49/1340
Fetching feeds: 50/1340
Fetching feeds: 51/1340
Fetching feeds: 52/1340
Fetching feeds: 53/1340
Fetching feeds: 54/1340
Fetching feeds: 55/1340
Fetching feeds: 56/1340
Fetching feeds: 57/1340
Fetching feeds: 58/1340
Fetching feeds: 59/1340
Fetching feeds: 60/1340
Fetching feeds: 61/1340
Fetching feeds: 62/1340
Fetching feeds: 63/1340
Fetching feeds: 64/1340
Fetching feeds: 65/1340
Fetching feeds: 66/1340
Fetching feeds: 67/1340
Fetching feeds: 68/1340
Fetching feeds: 69/1340
Fetching feeds: 70/1340
Fetching feeds: 71/1340
Fetching feeds: 72/1340
Fetching feeds: 73/1340
Fetching feeds: 74/1340
Fetching feeds: 75/1340
Fetching feeds: 76/1340
Fetching feeds: 77/1340
Fetching feeds: 78/1340
Fetching feeds: 79/1340
Fetching feeds: 80/1340
Fetching feeds: 81/1340
Fetching feeds: 82/1340
Fetching feeds: 83/1340
Fetching feeds: 84/1340
Fetching feeds: 85/1340
Fetching feeds: 86/1340
Fetching feeds: 87/1340
Fetching feeds: 88/1340
Fetching feeds: 89/1340
Fetching feeds: 90/1340
Fetching feeds: 91/1340
Fetching feeds: 92/1340
Fetching feeds: 93/1340
Fetching feeds: 94/1340
Fetching feeds: 95/1340
Fetching feeds: 96/1340
Fetching feeds: 97/1340
Fetching feeds: 98/1340
Fetching feeds: 99/1340
Fetching feeds: 100/1340
Fetching feeds: 101/1340
Fetching feeds: 102/1340
Fetching feeds: 103/1340
Fetching feeds: 104/1340
Fetching feeds: 105/1340
Fetching feeds: 106/1340
Fetching feeds: 107/1340
Fetching feeds: 108/1340
Fetching feeds: 109/1340
Fetching feeds: 110/1340
Fetching feeds: 111/1340
Fetching feeds: 112/1340
Fetching feeds: 113/1340
Fetching feeds: 114/1340
Fetching feeds: 115/1340
Fetching feeds: 116/1340
Fetching feeds: 117/1340
Fetching feeds: 118/1340
Fetching feeds: 119/1340
Fetching feeds: 120/1340
Fetching feeds: 121/1340
Fetching feeds: 122/1340
Fetching feeds: 123/1340
Fetching feeds: 124/1340
Fetching feeds: 125/1340
Fetching feeds: 126/1340
Fetching feeds: 127/1340
Fetching feeds: 128/1340
Fetching feeds: 129/1340
Fetching feeds: 130/1340
Fetching feeds: 131/1340
Fetching feeds: 132/1340
Fetching feeds: 133/1340
Fetching feeds: 134/1340
Fetching feeds: 135/1340
Fetching feeds: 136/1340
Fetching feeds: 137/1340
Fetching feeds: 138/1340
Fetching feeds: 139/1340
Fetching feeds: 140/1340
Fetching feeds: 141/1340
Fetching feeds: 142/1340
Fetching feeds: 143/1340
Fetching feeds: 144/1340
Fetching feeds: 145/1340
Fetching feeds: 146/1340
Fetching feeds: 147/1340
Fetching feeds: 148/1340
Fetching feeds: 149/1340
Fetching feeds: 150/1340
Fetching feeds: 151/1340
Fetching feeds: 152/1340
Fetching feeds: 153/1340
Fetching feeds: 154/1340
Fetching feeds: 155/1340
Fetching feeds: 156/1340
Fetching feeds: 157/1340
Fetching feeds: 158/1340
Fetching feeds: 159/1340
Fetching feeds: 160/1340
Fetching feeds: 161/1340
Fetching feeds: 162/1340
Fetching feeds: 163/1340
Fetching feeds: 164/1340
Fetching feeds: 165/1340
Fetching feeds: 166/1340
Fetching feeds: 167/1340
Fetching feeds: 168/1340
Fetching feeds: 169/1340
Fetching feeds: 170/1340
Fetching feeds: 171/1340
Fetching feeds: 172/1340
Fetching feeds: 173/1340
Fetching feeds: 174/1340
Fetching feeds: 175/1340
Fetching feeds: 176/1340
Fetching feeds: 177/1340
Fetching feeds: 178/1340
Fetching feeds: 179/1340
Fetching feeds: 180/1340
Fetching feeds: 181/1340
Fetching feeds: 182/1340
Fetching feeds: 183/1340
Fetching feeds: 184/1340
Fetching feeds: 185/1340
Fetching feeds: 186/1340
Fetching feeds: 187/1340
Fetching feeds: 188/1340
Fetching feeds: 189/1340
Fetching feeds: 190/1340
Fetching feeds: 191/1340
Fetching feeds: 192/1340
Fetching feeds: 193/1340
Fetching feeds: 194/1340
Fetching feeds: 195/1340
Fetching feeds: 196/1340
Fetching feeds: 197/1340
Fetching feeds: 198/1340
Fetching feeds: 199/1340
Fetching feeds: 200/1340
Fetching feeds: 201/1340
Fetching feeds: 202/1340
Fetching feeds: 203/1340
Fetching feeds: 204/1340
Fetching feeds: 205/1340
Fetching feeds: 206/1340
Fetching feeds: 207/1340
Fetching feeds: 208/1340
Fetching feeds: 209/1340
Fetching feeds: 210/1340
Fetching feeds: 211/1340
Fetching feeds: 212/1340
Fetching feeds: 213/1340
Fetching feeds: 214/1340
Fetching feeds: 215/1340
Fetching feeds: 216/1340
Fetching feeds: 217/1340
Fetching feeds: 218/1340
Fetching feeds: 219/1340
Fetching feeds: 220/1340
Fetching feeds: 221/1340
Fetching feeds: 222/1340
Fetching feeds: 223/1340
Fetching feeds: 224/1340
Fetching feeds: 225/1340
Fetching feeds: 226/1340
Fetching feeds: 227/1340
Fetching feeds: 228/1340
Fetching feeds: 229/1340
Fetching feeds: 230/1340
Fetching feeds: 231/1340
Fetching feeds: 232/1340
Fetching feeds: 233/1340
Fetching feeds: 234/1340
Fetching feeds: 235/1340
Fetching feeds: 236/1340
Fetching feeds: 237/1340
Fetching feeds: 238/1340
Fetching feeds: 239/1340
Fetching feeds: 240/1340
Fetching feeds: 241/1340
Fetching feeds: 242/1340
Fetching feeds: 243/1340
Fetching feeds: 244/1340
Fetching feeds: 245/1340
Fetching feeds: 246/1340
Fetching feeds: 247/1340
Fetching feeds: 248/1340
Fetching feeds: 249/1340
Fetching feeds: 250/1340
Fetching feeds: 251/1340
Fetching feeds: 252/1340
Fetching feeds: 253/1340
Fetching feeds: 254/1340
Fetching feeds: 255/1340
Fetching feeds: 256/1340
Fetching feeds: 257/1340
Fetching feeds: 258/1340
Fetching feeds: 259/1340
Fetching feeds: 260/1340
Fetching feeds: 261/1340
Fetching feeds: 262/1340
Fetching feeds: 263/1340
Fetching feeds: 264/1340
Fetching feeds: 265/1340
Fetching feeds: 266/1340
Fetching feeds: 267/1340
Fetching feeds: 268/1340
Fetching feeds: 269/1340
Fetching feeds: 270/1340
Fetching feeds: 271/1340
Fetching feeds: 272/1340
Fetching feeds: 273/1340
Fetching feeds: 274/1340
Fetching feeds: 275/1340
Fetching feeds: 276/1340
Fetching feeds: 277/1340
Fetching feeds: 278/1340
Fetching feeds: 279/1340
Fetching feeds: 280/1340
Fetching feeds: 281/1340
Fetching feeds: 282/1340
Fetching feeds: 283/1340
Fetching feeds: 284/1340
Fetching feeds: 285/1340
Fetching feeds: 286/1340
Fetching feeds: 287/1340
Fetching feeds: 288/1340
Fetching feeds: 289/1340
Fetching feeds: 290/1340
Fetching feeds: 291/1340
Fetching feeds: 292/1340
Fetching feeds: 293/1340
Fetching feeds: 294/1340
Fetching feeds: 295/1340
Fetching feeds: 296/1340
Fetching feeds: 297/1340
Fetching feeds: 298/1340
Fetching feeds: 299/1340
Fetching feeds: 300/1340
Fetching feeds: 301/1340
Fetching feeds: 302/1340
Fetching feeds: 303/1340
Fetching feeds: 304/1340
Fetching feeds: 305/1340
Fetching feeds: 306/1340
Fetching feeds: 307/1340
Fetching feeds: 308/1340
Fetching feeds: 309/1340
Fetching feeds: 310/1340
Fetching feeds: 311/1340
Fetching feeds: 312/1340
Fetching feeds: 313/1340
Fetching feeds: 314/1340
Fetching feeds: 315/1340
Fetching feeds: 316/1340
Fetching feeds: 317/1340
Fetching feeds: 318/1340
Fetching feeds: 319/1340
Fetching feeds: 320/1340
Fetching feeds: 321/1340
Fetching feeds: 322/1340
Fetching feeds: 323/1340
Fetching feeds: 324/1340
Fetching feeds: 325/1340
Fetching feeds: 326/1340
Fetching feeds: 327/1340
Fetching feeds: 328/1340
Fetching feeds: 329/1340
Fetching feeds: 330/1340
Fetching feeds: 331/1340
Fetching feeds: 332/1340
Fetching feeds: 333/1340
Fetching feeds: 334/1340
Fetching feeds: 335/1340
Fetching feeds: 336/1340
Fetching feeds: 337/1340
Fetching feeds: 338/1340
Fetching feeds: 339/1340
Fetching feeds: 340/1340
Fetching feeds: 341/1340
Fetching feeds: 342/1340
Fetching feeds: 343/1340
Fetching feeds: 344/1340
Fetching feeds: 345/1340
Fetching feeds: 346/1340
Fetching feeds: 347/1340
Fetching feeds: 348/1340
Fetching feeds: 349/1340
Fetching feeds: 350/1340
Fetching feeds: 351/1340
Fetching feeds: 352/1340
Fetching feeds: 353/1340
Fetching feeds: 354/1340
Fetching feeds: 355/1340
Fetching feeds: 356/1340
Fetching feeds: 357/1340
Fetching feeds: 358/1340
Fetching feeds: 359/1340
Fetching feeds: 360/1340
Fetching feeds: 361/1340
Fetching feeds: 362/1340
Fetching feeds: 363/1340
Fetching feeds: 364/1340
Fetching feeds: 365/1340
Fetching feeds: 366/1340
Fetching feeds: 367/1340
Fetching feeds: 368/1340
Fetching feeds: 369/1340
Fetching feeds: 370/1340
Fetching feeds: 371/1340
Fetching feeds: 372/1340
Fetching feeds: 373/1340
Fetching feeds: 374/1340
Fetching feeds: 375/1340
Fetching feeds: 376/1340
Fetching feeds: 377/1340
Fetching feeds: 378/1340
Fetching feeds: 379/1340
Fetching feeds: 380/1340
Fetching feeds: 381/1340
Fetching feeds: 382/1340
Fetching feeds: 383/1340
Fetching feeds: 384/1340
Fetching feeds: 385/1340
Fetching feeds: 386/1340
Fetching feeds: 387/1340
Fetching feeds: 388/1340
Fetching feeds: 389/1340
Fetching feeds: 390/1340
Fetching feeds: 391/1340
Fetching feeds: 392/1340
Fetching feeds: 393/1340
Fetching feeds: 394/1340
Fetching feeds: 395/1340
Fetching feeds: 396/1340
Fetching feeds: 397/1340
Fetching feeds: 398/1340
Fetching feeds: 399/1340
Fetching feeds: 400/1340
Fetching feeds: 401/1340
Fetching feeds: 402/1340
Fetching feeds: 403/1340
Fetching feeds: 404/1340
Fetching feeds: 405/1340
Fetching feeds: 406/1340
Fetching feeds: 407/1340
Fetching feeds: 408/1340
Fetching feeds: 409/1340
Fetching feeds: 410/1340
Fetching feeds: 411/1340
Fetching feeds: 412/1340
Fetching feeds: 413/1340
Fetching feeds: 414/1340
Fetching feeds: 415/1340
Fetching feeds: 416/1340
Fetching feeds: 417/1340
Fetching feeds: 418/1340
Fetching feeds: 419/1340
Fetching feeds: 420/1340
Fetching feeds: 421/1340
Fetching feeds: 422/1340
Fetching feeds: 423/1340
Fetching feeds: 424/1340
Fetching feeds: 425/1340
Fetching feeds: 426/1340
Fetching feeds: 427/1340
Fetching feeds: 428/1340
Fetching feeds: 429/1340
Fetching feeds: 430/1340
Fetching feeds: 431/1340
Fetching feeds: 432/1340
Fetching feeds: 433/1340
Fetching feeds: 434/1340
Fetching feeds: 435/1340
Fetching feeds: 436/1340
Fetching feeds: 437/1340
Fetching feeds: 438/1340
Fetching feeds: 439/1340
Fetching feeds: 440/1340
Fetching feeds: 441/1340
Fetching feeds: 442/1340
Fetching feeds: 443/1340
Fetching feeds: 444/1340
Fetching feeds: 445/1340
Fetching feeds: 446/1340
Fetching feeds: 447/1340
Fetching feeds: 448/1340
Fetching feeds: 449/1340
Fetching feeds: 450/1340
Fetching feeds: 451/1340
Fetching feeds: 452/1340
Fetching feeds: 453/1340
Fetching feeds: 454/1340
Fetching feeds: 455/1340
Fetching feeds: 456/1340
Fetching feeds: 457/1340
Fetching feeds: 458/1340
Fetching feeds: 459/1340
Fetching feeds: 460/1340
Fetching feeds: 461/1340
Fetching feeds: 462/1340
Fetching feeds: 463/1340
Fetching feeds: 464/1340
Fetching feeds: 465/1340
Fetching feeds: 466/1340
Fetching feeds: 467/1340
Fetching feeds: 468/1340
Fetching feeds: 469/1340
Fetching feeds: 470/1340
Fetching feeds: 471/1340
Fetching feeds: 472/1340
Fetching feeds: 473/1340
Fetching feeds: 474/1340
Fetching feeds: 475/1340
Fetching feeds: 476/1340
Fetching feeds: 477/1340
Fetching feeds: 478/1340
Fetching feeds: 479/1340
Fetching feeds: 480/1340
Fetching feeds: 481/1340
Fetching feeds: 482/1340
Fetching feeds: 483/1340
Fetching feeds: 484/1340
Fetching feeds: 485/1340
Fetching feeds: 486/1340
Fetching feeds: 487/1340
Fetching feeds: 488/1340
Fetching feeds: 489/1340
Fetching feeds: 490/1340
Fetching feeds: 491/1340
Fetching feeds: 492/1340
Fetching feeds: 493/1340
Fetching feeds: 494/1340
Fetching feeds: 495/1340
Fetching feeds: 496/1340
Fetching feeds: 497/1340
Fetching feeds: 498/1340
Fetching feeds: 499/1340
Fetching feeds: 500/1340
Fetching feeds: 501/1340
Fetching feeds: 502/1340
Fetching feeds: 503/1340
Fetching feeds: 504/1340
Fetching feeds: 505/1340
Fetching feeds: 506/1340
Fetching feeds: 507/1340
Fetching feeds: 508/1340
Fetching feeds: 509/1340
Fetching feeds: 510/1340
Fetching feeds: 511/1340
Fetching feeds: 512/1340
Fetching feeds: 513/1340
Fetching feeds: 514/1340
Fetching feeds: 515/1340
Fetching feeds: 516/1340
Fetching feeds: 517/1340
Fetching feeds: 518/1340
Fetching feeds: 519/1340
Fetching feeds: 520/1340
Fetching feeds: 521/1340
Fetching feeds: 522/1340
Fetching feeds: 523/1340
Fetching feeds: 524/1340
Fetching feeds: 525/1340
Fetching feeds: 526/1340
Fetching feeds: 527/1340
Fetching feeds: 528/1340
Fetching feeds: 529/1340
Fetching feeds: 530/1340
Fetching feeds: 531/1340
Fetching feeds: 532/1340
Fetching feeds: 533/1340
Fetching feeds: 534/1340
Fetching feeds: 535/1340
Fetching feeds: 536/1340
Fetching feeds: 537/1340
Fetching feeds: 538/1340
Fetching feeds: 539/1340
Fetching feeds: 540/1340
Fetching feeds: 541/1340
Fetching feeds: 542/1340
Fetching feeds: 543/1340
Fetching feeds: 544/1340
Fetching feeds: 545/1340
Fetching feeds: 546/1340
Fetching feeds: 547/1340
Fetching feeds: 548/1340
Fetching feeds: 549/1340
Fetching feeds: 550/1340
Fetching feeds: 551/1340
Fetching feeds: 552/1340
Fetching feeds: 553/1340
Fetching feeds: 554/1340
Fetching feeds: 555/1340
Fetching feeds: 556/1340
Fetching feeds: 557/1340
Fetching feeds: 558/1340
Fetching feeds: 559/1340
Fetching feeds: 560/1340
Fetching feeds: 561/1340
Fetching feeds: 562/1340
Fetching feeds: 563/1340
Fetching feeds: 564/1340
Fetching feeds: 565/1340
Fetching feeds: 566/1340
Fetching feeds: 567/1340
Fetching feeds: 568/1340
Fetching feeds: 569/1340
Fetching feeds: 570/1340
Fetching feeds: 571/1340
Fetching feeds: 572/1340
Fetching feeds: 573/1340
Fetching feeds: 574/1340
Fetching feeds: 575/1340
Fetching feeds: 576/1340
Fetching feeds: 577/1340
Fetching feeds: 578/1340
Fetching feeds: 579/1340
Fetching feeds: 580/1340
Fetching feeds: 581/1340
Fetching feeds: 582/1340
Fetching feeds: 583/1340
Fetching feeds: 584/1340
Fetching feeds: 585/1340
Fetching feeds: 586/1340
Fetching feeds: 587/1340
Fetching feeds: 588/1340
Fetching feeds: 589/1340
Fetching feeds: 590/1340
Fetching feeds: 591/1340
Fetching feeds: 592/1340
Fetching feeds: 593/1340
Fetching feeds: 594/1340
Fetching feeds: 595/1340
Fetching feeds: 596/1340
Fetching feeds: 597/1340
Fetching feeds: 598/1340
Fetching feeds: 599/1340
Fetching feeds: 600/1340
Fetching feeds: 601/1340
Fetching feeds: 602/1340
Fetching feeds: 603/1340
Fetching feeds: 604/1340
Fetching feeds: 605/1340
Fetching feeds: 606/1340
Fetching feeds: 607/1340
Fetching feeds: 608/1340
Fetching feeds: 609/1340
Fetching feeds: 610/1340
Fetching feeds: 611/1340
Fetching feeds: 612/1340
Fetching feeds: 613/1340
Fetching feeds: 614/1340
Fetching feeds: 615/1340
Fetching feeds: 616/1340
Fetching feeds: 617/1340
Fetching feeds: 618/1340
Fetching feeds: 619/1340
Fetching feeds: 620/1340
Fetching feeds: 621/1340
Fetching feeds: 622/1340
Fetching feeds: 623/1340
Fetching feeds: 624/1340
Fetching feeds: 625/1340
Fetching feeds: 626/1340
Fetching feeds: 627/1340
Fetching feeds: 628/1340
Fetching feeds: 629/1340
Fetching feeds: 630/1340
Fetching feeds: 631/1340
Fetching feeds: 632/1340
Fetching feeds: 633/1340
Fetching feeds: 634/1340
Fetching feeds: 635/1340
Fetching feeds: 636/1340
Fetching feeds: 637/1340
Fetching feeds: 638/1340
Fetching feeds: 639/1340
Fetching feeds: 640/1340
Fetching feeds: 641/1340
Fetching feeds: 642/1340
Fetching feeds: 643/1340
Fetching feeds: 644/1340
Fetching feeds: 645/1340
Fetching feeds: 646/1340
Fetching feeds: 647/1340
Fetching feeds: 648/1340
Fetching feeds: 649/1340
Fetching feeds: 650/1340
Fetching feeds: 651/1340
Fetching feeds: 652/1340
Fetching feeds: 653/1340
Fetching feeds: 654/1340
Fetching feeds: 655/1340
Fetching feeds: 656/1340
Fetching feeds: 657/1340
Fetching feeds: 658/1340
Fetching feeds: 659/1340
Fetching feeds: 660/1340
Fetching feeds: 661/1340
Fetching feeds: 662/1340
Fetching feeds: 663/1340
Fetching feeds: 664/1340
Fetching feeds: 665/1340
Fetching feeds: 666/1340
Fetching feeds: 667/1340
Fetching feeds: 668/1340
Fetching feeds: 669/1340
Fetching feeds: 670/1340
Fetching feeds: 671/1340
Fetching feeds: 672/1340
Fetching feeds: 673/1340
Fetching feeds: 674/1340
Fetching feeds: 675/1340
Fetching feeds: 676/1340
Fetching feeds: 677/1340
Fetching feeds: 678/1340
Fetching feeds: 679/1340
Fetching feeds: 680/1340
Fetching feeds: 681/1340
Fetching feeds: 682/1340
Fetching feeds: 683/1340
Fetching feeds: 684/1340
Fetching feeds: 685/1340
Fetching feeds: 686/1340
Fetching feeds: 687/1340
Fetching feeds: 688/1340
Fetching feeds: 689/1340
Fetching feeds: 690/1340
Fetching feeds: 691/1340
Fetching feeds: 692/1340
Fetching feeds: 693/1340
Fetching feeds: 694/1340
Fetching feeds: 695/1340
Fetching feeds: 696/1340
Fetching feeds: 697/1340
Fetching feeds: 698/1340
Fetching feeds: 699/1340
Fetching feeds: 700/1340
Fetching feeds: 701/1340
Fetching feeds: 702/1340
Fetching feeds: 703/1340
Fetching feeds: 704/1340
Fetching feeds: 705/1340
Fetching feeds: 706/1340
Fetching feeds: 707/1340
Fetching feeds: 708/1340
Fetching feeds: 709/1340
Fetching feeds: 710/1340
Fetching feeds: 711/1340
Fetching feeds: 712/1340
Fetching feeds: 713/1340
Fetching feeds: 714/1340
Fetching feeds: 715/1340
Fetching feeds: 716/1340
Fetching feeds: 717/1340
Fetching feeds: 718/1340
Fetching feeds: 719/1340
Fetching feeds: 720/1340
Fetching feeds: 721/1340
Fetching feeds: 722/1340
Fetching feeds: 723/1340
Fetching feeds: 724/1340
Fetching feeds: 725/1340
Fetching feeds: 726/1340
Fetching feeds: 727/1340
Fetching feeds: 728/1340
Fetching feeds: 729/1340
Fetching feeds: 730/1340
Fetching feeds: 731/1340
Fetching feeds: 732/1340
Fetching feeds: 733/1340
Fetching feeds: 734/1340
Fetching feeds: 735/1340
Fetching feeds: 736/1340
Fetching feeds: 737/1340
Fetching feeds: 738/1340
Fetching feeds: 739/1340
Fetching feeds: 740/1340
Fetching feeds: 741/1340
Fetching feeds: 742/1340
Fetching feeds: 743/1340
Fetching feeds: 744/1340
Fetching feeds: 745/1340
Fetching feeds: 746/1340
Fetching feeds: 747/1340
Fetching feeds: 748/1340
Fetching feeds: 749/1340
Fetching feeds: 750/1340
Fetching feeds: 751/1340
Fetching feeds: 752/1340
Fetching feeds: 753/1340
Fetching feeds: 754/1340
Fetching feeds: 755/1340
Fetching feeds: 756/1340
Fetching feeds: 757/1340
Fetching feeds: 758/1340
Fetching feeds: 759/1340
Fetching feeds: 760/1340
Fetching feeds: 761/1340
Fetching feeds: 762/1340
Fetching feeds: 763/1340
Fetching feeds: 764/1340
Fetching feeds: 765/1340
Fetching feeds: 766/1340
Fetching feeds: 767/1340
Fetching feeds: 768/1340
Fetching feeds: 769/1340
Fetching feeds: 770/1340
Fetching feeds: 771/1340
Fetching feeds: 772/1340
Fetching feeds: 773/1340
Fetching feeds: 774/1340
Fetching feeds: 775/1340
Fetching feeds: 776/1340
Fetching feeds: 777/1340
Fetching feeds: 778/1340
Fetching feeds: 779/1340
Fetching feeds: 780/1340
Fetching feeds: 781/1340
Fetching feeds: 782/1340
Fetching feeds: 783/1340
Fetching feeds: 784/1340
Fetching feeds: 785/1340
Fetching feeds: 786/1340
Fetching feeds: 787/1340
Fetching feeds: 788/1340
Fetching feeds: 789/1340
Fetching feeds: 790/1340
Fetching feeds: 791/1340
Fetching feeds: 792/1340
Fetching feeds: 793/1340
Fetching feeds: 794/1340
Fetching feeds: 795/1340
Fetching feeds: 796/1340
Fetching feeds: 797/1340
Fetching feeds: 798/1340
Fetching feeds: 799/1340
Fetching feeds: 800/1340
Fetching feeds: 801/1340
Fetching feeds: 802/1340
Fetching feeds: 803/1340
Fetching feeds: 804/1340
Fetching feeds: 805/1340
Fetching feeds: 806/1340
Fetching feeds: 807/1340
Fetching feeds: 808/1340
Fetching feeds: 809/1340
Fetching feeds: 810/1340
Fetching feeds: 811/1340
Fetching feeds: 812/1340
Fetching feeds: 813/1340
Fetching feeds: 814/1340
Fetching feeds: 815/1340
Fetching feeds: 816/1340
Fetching feeds: 817/1340
Fetching feeds: 818/1340
Fetching feeds: 819/1340
Fetching feeds: 820/1340
Fetching feeds: 821/1340
Fetching feeds: 822/1340
Fetching feeds: 823/1340
Fetching feeds: 824/1340
Fetching feeds: 825/1340
Fetching feeds: 826/1340
Fetching feeds: 827/1340
Fetching feeds: 828/1340
Fetching feeds: 829/1340
Fetching feeds: 830/1340
Fetching feeds: 831/1340
Fetching feeds: 832/1340
Fetching feeds: 833/1340
Fetching feeds: 834/1340
Fetching feeds: 835/1340
Fetching feeds: 836/1340
Fetching feeds: 837/1340
Fetching feeds: 838/1340
Fetching feeds: 839/1340
Fetching feeds: 840/1340
Fetching feeds: 841/1340
Fetching feeds: 842/1340
Fetching feeds: 843/1340
Fetching feeds: 844/1340
Fetching feeds: 845/1340
Fetching feeds: 846/1340
Fetching feeds: 847/1340
Fetching feeds: 848/1340
Fetching feeds: 849/1340
Fetching feeds: 850/1340
Fetching feeds: 851/1340
Fetching feeds: 852/1340
Fetching feeds: 853/1340
Fetching feeds: 854/1340
Fetching feeds: 855/1340
Fetching feeds: 856/1340
Fetching feeds: 857/1340
Fetching feeds: 858/1340
Fetching feeds: 859/1340
Fetching feeds: 860/1340
Fetching feeds: 861/1340
Fetching feeds: 862/1340
Fetching feeds: 863/1340
Fetching feeds: 864/1340
Fetching feeds: 865/1340
Fetching feeds: 866/1340
Fetching feeds: 867/1340
Fetching feeds: 868/1340
Fetching feeds: 869/1340
Fetching feeds: 870/1340
Fetching feeds: 871/1340
Fetching feeds: 872/1340
Fetching feeds: 873/1340
Fetching feeds: 874/1340
Fetching feeds: 875/1340
Fetching feeds: 876/1340
Fetching feeds: 877/1340
Fetching feeds: 878/1340
Fetching feeds: 879/1340
Fetching feeds: 880/1340
Fetching feeds: 881/1340
Fetching feeds: 882/1340
Fetching feeds: 883/1340
Fetching feeds: 884/1340
Fetching feeds: 885/1340
Fetching feeds: 886/1340
Fetching feeds: 887/1340
Fetching feeds: 888/1340
Fetching feeds: 889/1340
Fetching feeds: 890/1340
Fetching feeds: 891/1340
Fetching feeds: 892/1340
Fetching feeds: 893/1340
Fetching feeds: 894/1340
Fetching feeds: 895/1340
Fetching feeds: 896/1340
Fetching feeds: 897/1340
Fetching feeds: 898/1340
Fetching feeds: 899/1340
Fetching feeds: 900/1340
Fetching feeds: 901/1340
Fetching feeds: 902/1340
Fetching feeds: 903/1340
Fetching feeds: 904/1340
Fetching feeds: 905/1340
Fetching feeds: 906/1340
Fetching feeds: 907/1340
Fetching feeds: 908/1340
Fetching feeds: 909/1340
Fetching feeds: 910/1340
Fetching feeds: 911/1340
Fetching feeds: 912/1340
Fetching feeds: 913/1340
Fetching feeds: 914/1340
Fetching feeds: 915/1340
Fetching feeds: 916/1340
Fetching feeds: 917/1340
Fetching feeds: 918/1340
Fetching feeds: 919/1340
Fetching feeds: 920/1340
Fetching feeds: 921/1340
Fetching feeds: 922/1340
Fetching feeds: 923/1340
Fetching feeds: 924/1340
Fetching feeds: 925/1340
Fetching feeds: 926/1340
Fetching feeds: 927/1340
Fetching feeds: 928/1340
Fetching feeds: 929/1340
Fetching feeds: 930/1340
Fetching feeds: 931/1340
Fetching feeds: 932/1340
Fetching feeds: 933/1340
Fetching feeds: 934/1340
Fetching feeds: 935/1340
Fetching feeds: 936/1340
Fetching feeds: 937/1340
Fetching feeds: 938/1340
Fetching feeds: 939/1340
Fetching feeds: 940/1340
Fetching feeds: 941/1340
Fetching feeds: 942/1340
Fetching feeds: 943/1340
Fetching feeds: 944/1340
Fetching feeds: 945/1340
Fetching feeds: 946/1340
Fetching feeds: 947/1340
Fetching feeds: 948/1340
Fetching feeds: 949/1340
Fetching feeds: 950/1340
Fetching feeds: 951/1340
Fetching feeds: 952/1340
Fetching feeds: 953/1340
Fetching feeds: 954/1340
Fetching feeds: 955/1340
Fetching feeds: 956/1340
Fetching feeds: 957/1340
Fetching feeds: 958/1340
Fetching feeds: 959/1340
Fetching feeds: 960/1340
Fetching feeds: 961/1340
Fetching feeds: 962/1340
Fetching feeds: 963/1340
Fetching feeds: 964/1340
Fetching feeds: 965/1340
Fetching feeds: 966/1340
Fetching feeds: 967/1340
Fetching feeds: 968/1340
Fetching feeds: 969/1340
Fetching feeds: 970/1340
Fetching feeds: 971/1340
Fetching feeds: 972/1340
Fetching feeds: 973/1340
Fetching feeds: 974/1340
Fetching feeds: 975/1340
Fetching feeds: 976/1340
Fetching feeds: 977/1340
Fetching feeds: 978/1340
Fetching feeds: 979/1340
Fetching feeds: 980/1340
Fetching feeds: 981/1340
Fetching feeds: 982/1340
Fetching feeds: 983/1340
Fetching feeds: 984/1340
Fetching feeds: 985/1340
Fetching feeds: 986/1340
Fetching feeds: 987/1340
Fetching feeds: 988/1340
Fetching feeds: 989/1340
Fetching feeds: 990/1340
Fetching feeds: 991/1340
Fetching feeds: 992/1340
Fetching feeds: 993/1340
Fetching feeds: 994/1340
Fetching feeds: 995/1340
Fetching feeds: 996/1340
Fetching feeds: 997/1340
Fetching feeds: 998/1340
Fetching feeds: 999/1340
Fetching feeds: 1000/1340
Fetching feeds: 1001/1340
Fetching feeds: 1002/1340
Fetching feeds: 1003/1340
Fetching feeds: 1004/1340
Fetching feeds: 1005/1340
Fetching feeds: 1006/1340
Fetching feeds: 1007/1340
Fetching feeds: 1008/1340
Fetching feeds: 1009/1340
Fetching feeds: 1010/1340
Fetching feeds: 1011/1340
Fetching feeds: 1012/1340
Fetching feeds: 1013/1340
Fetching feeds: 1014/1340
Fetching feeds: 1015/1340
Fetching feeds: 1016/1340
Fetching feeds: 1017/1340
Fetching feeds: 1018/1340
Fetching feeds: 1019/1340
Fetching feeds: 1020/1340
Fetching feeds: 1021/1340
Fetching feeds: 1022/1340
Fetching feeds: 1023/1340
Fetching feeds: 1024/1340
Fetching feeds: 1025/1340
Fetching feeds: 1026/1340
Fetching feeds: 1027/1340
Fetching feeds: 1028/1340
Fetching feeds: 1029/1340
Fetching feeds: 1030/1340
Fetching feeds: 1031/1340
Fetching feeds: 1032/1340
Fetching feeds: 1033/1340
Fetching feeds: 1034/1340
Fetching feeds: 1035/1340
Fetching feeds: 1036/1340
Fetching feeds: 1037/1340
Fetching feeds: 1038/1340
Fetching feeds: 1039/1340
Fetching feeds: 1040/1340
Fetching feeds: 1041/1340
Fetching feeds: 1042/1340
Fetching feeds: 1043/1340
Fetching feeds: 1044/1340
Fetching feeds: 1045/1340
Fetching feeds: 1046/1340
Fetching feeds: 1047/1340
Fetching feeds: 1048/1340
Fetching feeds: 1049/1340
Fetching feeds: 1050/1340
Fetching feeds: 1051/1340
Fetching feeds: 1052/1340
Fetching feeds: 1053/1340
Fetching feeds: 1054/1340
Fetching feeds: 1055/1340
Fetching feeds: 1056/1340
Fetching feeds: 1057/1340
Fetching feeds: 1058/1340
Fetching feeds: 1059/1340
Fetching feeds: 1060/1340
Fetching feeds: 1061/1340
Fetching feeds: 1062/1340
Fetching feeds: 1063/1340
Fetching feeds: 1064/1340
Fetching feeds: 1065/1340
Fetching feeds: 1066/1340
Fetching feeds: 1067/1340
Fetching feeds: 1068/1340
Fetching feeds: 1069/1340
Fetching feeds: 1070/1340
Fetching feeds: 1071/1340
Fetching feeds: 1072/1340
Fetching feeds: 1073/1340
Fetching feeds: 1074/1340
Fetching feeds: 1075/1340
Fetching feeds: 1076/1340
Fetching feeds: 1077/1340
Fetching feeds: 1078/1340
Fetching feeds: 1079/1340
Fetching feeds: 1080/1340
Fetching feeds: 1081/1340
Fetching feeds: 1082/1340
Fetching feeds: 1083/1340
Fetching feeds: 1084/1340
Fetching feeds: 1085/1340
Fetching feeds: 1086/1340
Fetching feeds: 1087/1340
Fetching feeds: 1088/1340
Fetching feeds: 1089/1340
Fetching feeds: 1090/1340
Fetching feeds: 1091/1340
Fetching feeds: 1092/1340
Fetching feeds: 1093/1340
Fetching feeds: 1094/1340
Fetching feeds: 1095/1340
Fetching feeds: 1096/1340
Fetching feeds: 1097/1340
Fetching feeds: 1098/1340
Fetching feeds: 1099/1340
Fetching feeds: 1100/1340
Fetching feeds: 1101/1340
Fetching feeds: 1102/1340
Fetching feeds: 1103/1340
Fetching feeds: 1104/1340
Fetching feeds: 1105/1340
Fetching feeds: 1106/1340
Fetching feeds: 1107/1340
Fetching feeds: 1108/1340
Fetching feeds: 1109/1340
Fetching feeds: 1110/1340
Fetching feeds: 1111/1340
Fetching feeds: 1112/1340
Fetching feeds: 1113/1340
Fetching feeds: 1114/1340
Fetching feeds: 1115/1340
Fetching feeds: 1116/1340
Fetching feeds: 1117/1340
Fetching feeds: 1118/1340
Fetching feeds: 1119/1340
Fetching feeds: 1120/1340
Fetching feeds: 1121/1340
Fetching feeds: 1122/1340
Fetching feeds: 1123/1340
Fetching feeds: 1124/1340
Fetching feeds: 1125/1340
Fetching feeds: 1126/1340
Fetching feeds: 1127/1340
Fetching feeds: 1128/1340
Fetching feeds: 1129/1340
Fetching feeds: 1130/1340
Fetching feeds: 1131/1340
Fetching feeds: 1132/1340
Fetching feeds: 1133/1340
Fetching feeds: 1134/1340
Fetching feeds: 1135/1340
Fetching feeds: 1136/1340
Fetching feeds: 1137/1340
Fetching feeds: 1138/1340
Fetching feeds: 1139/1340
Fetching feeds: 1140/1340
Fetching feeds: 1141/1340
Fetching feeds: 1142/1340
Fetching feeds: 1143/1340
Fetching feeds: 1144/1340
Fetching feeds: 1145/1340
Fetching feeds: 1146/1340
Fetching feeds: 1147/1340
Fetching feeds: 1148/1340
Fetching feeds: 1149/1340
Fetching feeds: 1150/1340
Fetching feeds: 1151/1340
Fetching feeds: 1152/1340
Fetching feeds: 1153/1340
Fetching feeds: 1154/1340
Fetching feeds: 1155/1340
Fetching feeds: 1156/1340
Fetching feeds: 1157/1340
Fetching feeds: 1158/1340
Fetching feeds: 1159/1340
Fetching feeds: 1160/1340
Fetching feeds: 1161/1340
Fetching feeds: 1162/1340
Fetching feeds: 1163/1340
Fetching feeds: 1164/1340
Fetching feeds: 1165/1340
Fetching feeds: 1166/1340
Fetching feeds: 1167/1340
Fetching feeds: 1168/1340
Fetching feeds: 1169/1340
Fetching feeds: 1170/1340
Fetching feeds: 1171/1340
Fetching feeds: 1172/1340
Fetching feeds: 1173/1340
Fetching feeds: 1174/1340
Fetching feeds: 1175/1340
Fetching feeds: 1176/1340
Fetching feeds: 1177/1340
Fetching feeds: 1178/1340
Fetching feeds: 1179/1340
Fetching feeds: 1180/1340
Fetching feeds: 1181/1340
Fetching feeds: 1182/1340
Fetching feeds: 1183/1340
Fetching feeds: 1184/1340
Fetching feeds: 1185/1340
Fetching feeds: 1186/1340
Fetching feeds: 1187/1340
Fetching feeds: 1188/1340
Fetching feeds: 1189/1340
Fetching feeds: 1190/1340
Fetching feeds: 1191/1340
Fetching feeds: 1192/1340
Fetching feeds: 1193/1340
Fetching feeds: 1194/1340
Fetching feeds: 1195/1340
Fetching feeds: 1196/1340
Fetching feeds: 1197/1340
Fetching feeds: 1198/1340
Fetching feeds: 1199/1340
Fetching feeds: 1200/1340
Fetching feeds: 1201/1340
Fetching feeds: 1202/1340
Fetching feeds: 1203/1340
Fetching feeds: 1204/1340
Fetching feeds: 1205/1340
Fetching feeds: 1206/1340
Fetching feeds: 1207/1340
Fetching feeds: 1208/1340
Fetching feeds: 1209/1340
Fetching feeds: 1210/1340
Fetching feeds: 1211/1340
Fetching feeds: 1212/1340
Fetching feeds: 1213/1340
Fetching feeds: 1214/1340
Fetching feeds: 1215/1340
Fetching feeds: 1216/1340
Fetching feeds: 1217/1340
Fetching feeds: 1218/1340
Fetching feeds: 1219/1340
Fetching feeds: 1220/1340
Fetching feeds: 1221/1340
Fetching feeds: 1222/1340
Fetching feeds: 1223/1340
Fetching feeds: 1224/1340
Fetching feeds: 1225/1340
Fetching feeds: 1226/1340
Fetching feeds: 1227/1340
Fetching feeds: 1228/1340
Fetching feeds: 1229/1340
Fetching feeds: 1230/1340
Fetching feeds: 1231/1340
Fetching feeds: 1232/1340
Fetching feeds: 1233/1340
Fetching feeds: 1234/1340
Fetching feeds: 1235/1340
Fetching feeds: 1236/1340
Fetching feeds: 1237/1340
Fetching feeds: 1238/1340
Fetching feeds: 1239/1340
Fetching feeds: 1240/1340
Fetching feeds: 1241/1340
Fetching feeds: 1242/1340
Fetching feeds: 1243/1340
Fetching feeds: 1244/1340
Fetching feeds: 1245/1340
Fetching feeds: 1246/1340
Fetching feeds: 1247/1340
Fetching feeds: 1248/1340
Fetching feeds: 1249/1340
Fetching feeds: 1250/1340
Fetching feeds: 1251/1340
Fetching feeds: 1252/1340
Fetching feeds: 1253/1340
Fetching feeds: 1254/1340
Fetching feeds: 1255/1340
Fetching feeds: 1256/1340
Fetching feeds: 1257/1340
Fetching feeds: 1258/1340
Fetching feeds: 1259/1340
Fetching feeds: 1260/1340
Fetching feeds: 1261/1340
Fetching feeds: 1262/1340
Fetching feeds: 1263/1340
Fetching feeds: 1264/1340
Fetching feeds: 1265/1340
Fetching feeds: 1266/1340
Fetching feeds: 1267/1340
Fetching feeds: 1268/1340
Fetching feeds: 1269/1340
Fetching feeds: 1270/1340
Fetching feeds: 1271/1340
Fetching feeds: 1272/1340
Fetching feeds: 1273/1340
Fetching feeds: 1274/1340
Fetching feeds: 1275/1340
Fetching feeds: 1276/1340
Fetching feeds: 1277/1340
Fetching feeds: 1278/1340
Fetching feeds: 1279/1340
Fetching feeds: 1280/1340
Fetching feeds: 1281/1340
Fetching feeds: 1282/1340
Fetching feeds: 1283/1340
Fetching feeds: 1284/1340
Fetching feeds: 1285/1340
Fetching feeds: 1286/1340
Fetching feeds: 1287/1340
Fetching feeds: 1288/1340
Fetching feeds: 1289/1340
Fetching feeds: 1290/1340
Fetching feeds: 1291/1340
Fetching feeds: 1292/1340
Fetching feeds: 1293/1340
Fetching feeds: 1294/1340
Fetching feeds: 1295/1340
Fetching feeds: 1296/1340
Fetching feeds: 1297/1340
Fetching feeds: 1298/1340
Fetching feeds: 1299/1340
Fetching feeds: 1300/1340
Fetching feeds: 1301/1340
Fetching feeds: 1302/1340
Fetching feeds: 1303/1340
Fetching feeds: 1304/1340
Fetching feeds: 1305/1340
Fetching feeds: 1306/1340
Fetching feeds: 1307/1340
Fetching feeds: 1308/1340
Fetching feeds: 1309/1340
Fetching feeds: 1310/1340
Fetching feeds: 1311/1340
Fetching feeds: 1312/1340
Fetching feeds: 1313/1340
Fetching feeds: 1314/1340
Fetching feeds: 1315/1340
Fetching feeds: 1316/1340
Fetching feeds: 1317/1340
Fetching feeds: 1318/1340
Fetching feeds: 1319/1340
Fetching feeds: 1320/1340
Fetching feeds: 1321/1340
Fetching feeds: 1322/1340
Fetching feeds: 1323/1340
Fetching feeds: 1324/1340
Fetching feeds: 1325/1340
Fetching feeds: 1326/1340
Fetching feeds: 1327/1340
Fetching feeds: 1328/1340
Fetching feeds: 1329/1340
Fetching feeds: 1330/1340
Fetching feeds: 1331/1340
Fetching feeds: 1332/1340
Fetching feeds: 1333/1340
Fetching feeds: 1334/1340
Fetching feeds: 1335/1340
Fetching feeds: 1336/1340
Fetching feeds: 1337/1340
Fetching feeds: 1338/1340
Fetching feeds: 1339/1340
Fetching feeds: 1340/1340
Finished fetching feeds: 1340/1340
INFO:root:Saved raw game feeds JSON to data/20252026_raw_game_feeds.json
INFO:root:Saved raw game feeds CSV to data/20252026_raw_game_feeds.csv
Parsing feeds: 1/1340
Parsing feeds: 2/1340
Parsing feeds: 3/1340
Parsing feeds: 4/1340
Parsing feeds: 5/1340
Parsing feeds: 6/1340
Parsing feeds: 7/1340
Parsing feeds: 8/1340
Parsing feeds: 9/1340
Parsing feeds: 10/1340
Parsing feeds: 11/1340
Parsing feeds: 12/1340
Parsing feeds: 13/1340
Parsing feeds: 14/1340
Parsing feeds: 15/1340
Parsing feeds: 16/1340
Parsing feeds: 17/1340
Parsing feeds: 18/1340
Parsing feeds: 19/1340
Parsing feeds: 20/1340
Parsing feeds: 21/1340
Parsing feeds: 22/1340
Parsing feeds: 23/1340
Parsing feeds: 24/1340
Parsing feeds: 25/1340
Parsing feeds: 26/1340
Parsing feeds: 27/1340
Parsing feeds: 28/1340
Parsing feeds: 29/1340
Parsing feeds: 30/1340
Parsing feeds: 31/1340
Parsing feeds: 32/1340
Parsing feeds: 33/1340
Parsing feeds: 34/1340
Parsing feeds: 35/1340
Parsing feeds: 36/1340
Parsing feeds: 37/1340
Parsing feeds: 38/1340
Parsing feeds: 39/1340
Parsing feeds: 40/1340
Parsing feeds: 41/1340
Parsing feeds: 42/1340
Parsing feeds: 43/1340
Parsing feeds: 44/1340
Parsing feeds: 45/1340
Parsing feeds: 46/1340
Parsing feeds: 47/1340
Parsing feeds: 48/1340
Parsing feeds: 49/1340
Parsing feeds: 50/1340
Parsing feeds: 51/1340
Parsing feeds: 52/1340
Parsing feeds: 53/1340
Parsing feeds: 54/1340
Parsing feeds: 55/1340
Parsing feeds: 56/1340
Parsing feeds: 57/1340
Parsing feeds: 58/1340
Parsing feeds: 59/1340
Parsing feeds: 60/1340
Parsing feeds: 61/1340
Parsing feeds: 62/1340
Parsing feeds: 63/1340
Parsing feeds: 64/1340
Parsing feeds: 65/1340
Parsing feeds: 66/1340
Parsing feeds: 67/1340
Parsing feeds: 68/1340
Parsing feeds: 69/1340
Parsing feeds: 70/1340
Parsing feeds: 71/1340
Parsing feeds: 72/1340
Parsing feeds: 73/1340
Parsing feeds: 74/1340
Parsing feeds: 75/1340
Parsing feeds: 76/1340
Parsing feeds: 77/1340
Parsing feeds: 78/1340
Parsing feeds: 79/1340
Parsing feeds: 80/1340
Parsing feeds: 81/1340
Parsing feeds: 82/1340
Parsing feeds: 83/1340
Parsing feeds: 84/1340
Parsing feeds: 85/1340
Parsing feeds: 86/1340
Parsing feeds: 87/1340
Parsing feeds: 88/1340
Parsing feeds: 89/1340
Parsing feeds: 90/1340
Parsing feeds: 91/1340
Parsing feeds: 92/1340
Parsing feeds: 93/1340
Parsing feeds: 94/1340
Parsing feeds: 95/1340
Parsing feeds: 96/1340
Parsing feeds: 97/1340
Parsing feeds: 98/1340
Parsing feeds: 99/1340
Parsing feeds: 100/1340
Parsing feeds: 101/1340
Parsing feeds: 102/1340
Parsing feeds: 103/1340
Parsing feeds: 104/1340
Parsing feeds: 105/1340
Parsing feeds: 106/1340
Parsing feeds: 107/1340
Parsing feeds: 108/1340
Parsing feeds: 109/1340
Parsing feeds: 110/1340
Parsing feeds: 111/1340
Parsing feeds: 112/1340
Parsing feeds: 113/1340
Parsing feeds: 114/1340
Parsing feeds: 115/1340
Parsing feeds: 116/1340
Parsing feeds: 117/1340
Parsing feeds: 118/1340
Parsing feeds: 119/1340
Parsing feeds: 120/1340
Parsing feeds: 121/1340
Parsing feeds: 122/1340
Parsing feeds: 123/1340
Parsing feeds: 124/1340
Parsing feeds: 125/1340
Parsing feeds: 126/1340
Parsing feeds: 127/1340
Parsing feeds: 128/1340
Parsing feeds: 129/1340
Parsing feeds: 130/1340
Parsing feeds: 131/1340
Parsing feeds: 132/1340
Parsing feeds: 133/1340
Parsing feeds: 134/1340
Parsing feeds: 135/1340
Parsing feeds: 136/1340
Parsing feeds: 137/1340
Parsing feeds: 138/1340
Parsing feeds: 139/1340
Parsing feeds: 140/1340
Parsing feeds: 141/1340
Parsing feeds: 142/1340
Parsing feeds: 143/1340
Parsing feeds: 144/1340
Parsing feeds: 145/1340
Parsing feeds: 146/1340
Parsing feeds: 147/1340
Parsing feeds: 148/1340
Parsing feeds: 149/1340
Parsing feeds: 150/1340
Parsing feeds: 151/1340
Parsing feeds: 152/1340
Parsing feeds: 153/1340
Parsing feeds: 154/1340
Parsing feeds: 155/1340
Parsing feeds: 156/1340
Parsing feeds: 157/1340
Parsing feeds: 158/1340
Parsing feeds: 159/1340
Parsing feeds: 160/1340
Parsing feeds: 161/1340
Parsing feeds: 162/1340
Parsing feeds: 163/1340
Parsing feeds: 164/1340
Parsing feeds: 165/1340
Parsing feeds: 166/1340
Parsing feeds: 167/1340
Parsing feeds: 168/1340
Parsing feeds: 169/1340
Parsing feeds: 170/1340
Parsing feeds: 171/1340
Parsing feeds: 172/1340
Parsing feeds: 173/1340
Parsing feeds: 174/1340
Parsing feeds: 175/1340
Parsing feeds: 176/1340
Parsing feeds: 177/1340
Parsing feeds: 178/1340
Parsing feeds: 179/1340
Parsing feeds: 180/1340
Parsing feeds: 181/1340
Parsing feeds: 182/1340
Parsing feeds: 183/1340
Parsing feeds: 184/1340
Parsing feeds: 185/1340
Parsing feeds: 186/1340
Parsing feeds: 187/1340
Parsing feeds: 188/1340
Parsing feeds: 189/1340
Parsing feeds: 190/1340
Parsing feeds: 191/1340
Parsing feeds: 192/1340
Parsing feeds: 193/1340
Parsing feeds: 194/1340
Parsing feeds: 195/1340
Parsing feeds: 196/1340
Parsing feeds: 197/1340
Parsing feeds: 198/1340
Parsing feeds: 199/1340
Parsing feeds: 200/1340
Parsing feeds: 201/1340
Parsing feeds: 202/1340
Parsing feeds: 203/1340
Parsing feeds: 204/1340
Parsing feeds: 205/1340
Parsing feeds: 206/1340
Parsing feeds: 207/1340
Parsing feeds: 208/1340
Parsing feeds: 209/1340
Parsing feeds: 210/1340
Parsing feeds: 211/1340
Parsing feeds: 212/1340
Parsing feeds: 213/1340
Parsing feeds: 214/1340
Parsing feeds: 215/1340
Parsing feeds: 216/1340
Parsing feeds: 217/1340
Parsing feeds: 218/1340
Parsing feeds: 219/1340
Parsing feeds: 220/1340
Parsing feeds: 221/1340
Parsing feeds: 222/1340
Parsing feeds: 223/1340
Parsing feeds: 224/1340
Parsing feeds: 225/1340
Parsing feeds: 226/1340
Parsing feeds: 227/1340
Parsing feeds: 228/1340
Parsing feeds: 229/1340
Parsing feeds: 230/1340
Parsing feeds: 231/1340
Parsing feeds: 232/1340
Parsing feeds: 233/1340
Parsing feeds: 234/1340
Parsing feeds: 235/1340
Parsing feeds: 236/1340
Parsing feeds: 237/1340
Parsing feeds: 238/1340
Parsing feeds: 239/1340
Parsing feeds: 240/1340
Parsing feeds: 241/1340
Parsing feeds: 242/1340
Parsing feeds: 243/1340
Parsing feeds: 244/1340
Parsing feeds: 245/1340
Parsing feeds: 246/1340
Parsing feeds: 247/1340
Parsing feeds: 248/1340
Parsing feeds: 249/1340
Parsing feeds: 250/1340
Parsing feeds: 251/1340
Parsing feeds: 252/1340
Parsing feeds: 253/1340
Parsing feeds: 254/1340
Parsing feeds: 255/1340
Parsing feeds: 256/1340
Parsing feeds: 257/1340
Parsing feeds: 258/1340
Parsing feeds: 259/1340
Parsing feeds: 260/1340
Parsing feeds: 261/1340
Parsing feeds: 262/1340
Parsing feeds: 263/1340
Parsing feeds: 264/1340
Parsing feeds: 265/1340
Parsing feeds: 266/1340
Parsing feeds: 267/1340
Parsing feeds: 268/1340
Parsing feeds: 269/1340
Parsing feeds: 270/1340
Parsing feeds: 271/1340
Parsing feeds: 272/1340
Parsing feeds: 273/1340
Parsing feeds: 274/1340
Parsing feeds: 275/1340
Parsing feeds: 276/1340
Parsing feeds: 277/1340
Parsing feeds: 278/1340
Parsing feeds: 279/1340
Parsing feeds: 280/1340
Parsing feeds: 281/1340
Parsing feeds: 282/1340
Parsing feeds: 283/1340
Parsing feeds: 284/1340
Parsing feeds: 285/1340
Parsing feeds: 286/1340
Parsing feeds: 287/1340
Parsing feeds: 288/1340
Parsing feeds: 289/1340
Parsing feeds: 290/1340
Parsing feeds: 291/1340
Parsing feeds: 292/1340
Parsing feeds: 293/1340
Parsing feeds: 294/1340
Parsing feeds: 295/1340
Parsing feeds: 296/1340
Parsing feeds: 297/1340
Parsing feeds: 298/1340
Parsing feeds: 299/1340
Parsing feeds: 300/1340
Parsing feeds: 301/1340
Parsing feeds: 302/1340
Parsing feeds: 303/1340
Parsing feeds: 304/1340
Parsing feeds: 305/1340
Parsing feeds: 306/1340
Parsing feeds: 307/1340
Parsing feeds: 308/1340
Parsing feeds: 309/1340
Parsing feeds: 310/1340
Parsing feeds: 311/1340
Parsing feeds: 312/1340
Parsing feeds: 313/1340
Parsing feeds: 314/1340
Parsing feeds: 315/1340
Parsing feeds: 316/1340
Parsing feeds: 317/1340
Parsing feeds: 318/1340
Parsing feeds: 319/1340
Parsing feeds: 320/1340
Parsing feeds: 321/1340
Parsing feeds: 322/1340
Parsing feeds: 323/1340
Parsing feeds: 324/1340
Parsing feeds: 325/1340
Parsing feeds: 326/1340
Parsing feeds: 327/1340
Parsing feeds: 328/1340
Parsing feeds: 329/1340
Parsing feeds: 330/1340
Parsing feeds: 331/1340
Parsing feeds: 332/1340
Parsing feeds: 333/1340
Parsing feeds: 334/1340
Parsing feeds: 335/1340
Parsing feeds: 336/1340
Parsing feeds: 337/1340
Parsing feeds: 338/1340
Parsing feeds: 339/1340
Parsing feeds: 340/1340
Parsing feeds: 341/1340
Parsing feeds: 342/1340
Parsing feeds: 343/1340
Parsing feeds: 344/1340
Parsing feeds: 345/1340
Parsing feeds: 346/1340
Parsing feeds: 347/1340
Parsing feeds: 348/1340
Parsing feeds: 349/1340
Parsing feeds: 350/1340
Parsing feeds: 351/1340
Parsing feeds: 352/1340
Parsing feeds: 353/1340
Parsing feeds: 354/1340
Parsing feeds: 355/1340
Parsing feeds: 356/1340
Parsing feeds: 357/1340
Parsing feeds: 358/1340
Parsing feeds: 359/1340
Parsing feeds: 360/1340
Parsing feeds: 361/1340
Parsing feeds: 362/1340
Parsing feeds: 363/1340
Parsing feeds: 364/1340
Parsing feeds: 365/1340
Parsing feeds: 366/1340
Parsing feeds: 367/1340
Parsing feeds: 368/1340
Parsing feeds: 369/1340
Parsing feeds: 370/1340
Parsing feeds: 371/1340
Parsing feeds: 372/1340
Parsing feeds: 373/1340
Parsing feeds: 374/1340
Parsing feeds: 375/1340
Parsing feeds: 376/1340
Parsing feeds: 377/1340
Parsing feeds: 378/1340
Parsing feeds: 379/1340
Parsing feeds: 380/1340
Parsing feeds: 381/1340
Parsing feeds: 382/1340
Parsing feeds: 383/1340
Parsing feeds: 384/1340
Parsing feeds: 385/1340
Parsing feeds: 386/1340
Parsing feeds: 387/1340
Parsing feeds: 388/1340
Parsing feeds: 389/1340
Parsing feeds: 390/1340
Parsing feeds: 391/1340
Parsing feeds: 392/1340
Parsing feeds: 393/1340
Parsing feeds: 394/1340
Parsing feeds: 395/1340
Parsing feeds: 396/1340
Parsing feeds: 397/1340
Parsing feeds: 398/1340
Parsing feeds: 399/1340
Parsing feeds: 400/1340
Parsing feeds: 401/1340
Parsing feeds: 402/1340
Parsing feeds: 403/1340
Parsing feeds: 404/1340
Parsing feeds: 405/1340
Parsing feeds: 406/1340
Parsing feeds: 407/1340
Parsing feeds: 408/1340
Parsing feeds: 409/1340
Parsing feeds: 410/1340
Parsing feeds: 411/1340
Parsing feeds: 412/1340
Parsing feeds: 413/1340
Parsing feeds: 414/1340
Parsing feeds: 415/1340
Parsing feeds: 416/1340
Parsing feeds: 417/1340
Parsing feeds: 418/1340
Parsing feeds: 419/1340
Parsing feeds: 420/1340
Parsing feeds: 421/1340
Parsing feeds: 422/1340
Parsing feeds: 423/1340
Parsing feeds: 424/1340
Parsing feeds: 425/1340
Parsing feeds: 426/1340
Parsing feeds: 427/1340
Parsing feeds: 428/1340
Parsing feeds: 429/1340
Parsing feeds: 430/1340
Parsing feeds: 431/1340
Parsing feeds: 432/1340
Parsing feeds: 433/1340
Parsing feeds: 434/1340
Parsing feeds: 435/1340
Parsing feeds: 436/1340
Parsing feeds: 437/1340
Parsing feeds: 438/1340
Parsing feeds: 439/1340
Parsing feeds: 440/1340
Parsing feeds: 441/1340
Parsing feeds: 442/1340
Parsing feeds: 443/1340
Parsing feeds: 444/1340
Parsing feeds: 445/1340
Parsing feeds: 446/1340
Parsing feeds: 447/1340
Parsing feeds: 448/1340
Parsing feeds: 449/1340
Parsing feeds: 450/1340
Parsing feeds: 451/1340
Parsing feeds: 452/1340
Parsing feeds: 453/1340
Parsing feeds: 454/1340
Parsing feeds: 455/1340
Parsing feeds: 456/1340
Parsing feeds: 457/1340
Parsing feeds: 458/1340
Parsing feeds: 459/1340
Parsing feeds: 460/1340
Parsing feeds: 461/1340
Parsing feeds: 462/1340
Parsing feeds: 463/1340
Parsing feeds: 464/1340
Parsing feeds: 465/1340
Parsing feeds: 466/1340
Parsing feeds: 467/1340
Parsing feeds: 468/1340
Parsing feeds: 469/1340
Parsing feeds: 470/1340
Parsing feeds: 471/1340
Parsing feeds: 472/1340
Parsing feeds: 473/1340
Parsing feeds: 474/1340
Parsing feeds: 475/1340
Parsing feeds: 476/1340
Parsing feeds: 477/1340
Parsing feeds: 478/1340
Parsing feeds: 479/1340
Parsing feeds: 480/1340
Parsing feeds: 481/1340
Parsing feeds: 482/1340
Parsing feeds: 483/1340
Parsing feeds: 484/1340
Parsing feeds: 485/1340
Parsing feeds: 486/1340
Parsing feeds: 487/1340
Parsing feeds: 488/1340
Parsing feeds: 489/1340
Parsing feeds: 490/1340
Parsing feeds: 491/1340
Parsing feeds: 492/1340
Parsing feeds: 493/1340
Parsing feeds: 494/1340
Parsing feeds: 495/1340
Parsing feeds: 496/1340
Parsing feeds: 497/1340
Parsing feeds: 498/1340
Parsing feeds: 499/1340
Parsing feeds: 500/1340
Parsing feeds: 501/1340
Parsing feeds: 502/1340
Parsing feeds: 503/1340
Parsing feeds: 504/1340
Parsing feeds: 505/1340
Parsing feeds: 506/1340
Parsing feeds: 507/1340
Parsing feeds: 508/1340
Parsing feeds: 509/1340
Parsing feeds: 510/1340
Parsing feeds: 511/1340
Parsing feeds: 512/1340
Parsing feeds: 513/1340
Parsing feeds: 514/1340
Parsing feeds: 515/1340
Parsing feeds: 516/1340
Parsing feeds: 517/1340
Parsing feeds: 518/1340
Parsing feeds: 519/1340
Parsing feeds: 520/1340
Parsing feeds: 521/1340
Parsing feeds: 522/1340
Parsing feeds: 523/1340
Parsing feeds: 524/1340
Parsing feeds: 525/1340
Parsing feeds: 526/1340
Parsing feeds: 527/1340
Parsing feeds: 528/1340
Parsing feeds: 529/1340
Parsing feeds: 530/1340
Parsing feeds: 531/1340
Parsing feeds: 532/1340
Parsing feeds: 533/1340
Parsing feeds: 534/1340
Parsing feeds: 535/1340
Parsing feeds: 536/1340
Parsing feeds: 537/1340
Parsing feeds: 538/1340
Parsing feeds: 539/1340
Parsing feeds: 540/1340
Parsing feeds: 541/1340
Parsing feeds: 542/1340
Parsing feeds: 543/1340
Parsing feeds: 544/1340
Parsing feeds: 545/1340
Parsing feeds: 546/1340
Parsing feeds: 547/1340
Parsing feeds: 548/1340
Parsing feeds: 549/1340
Parsing feeds: 550/1340
Parsing feeds: 551/1340
Parsing feeds: 552/1340
Parsing feeds: 553/1340
Parsing feeds: 554/1340
Parsing feeds: 555/1340
Parsing feeds: 556/1340
Parsing feeds: 557/1340
Parsing feeds: 558/1340
Parsing feeds: 559/1340
Parsing feeds: 560/1340
Parsing feeds: 561/1340
Parsing feeds: 562/1340
Parsing feeds: 563/1340
Parsing feeds: 564/1340
Parsing feeds: 565/1340
Parsing feeds: 566/1340
Parsing feeds: 567/1340
Parsing feeds: 568/1340
Parsing feeds: 569/1340
Parsing feeds: 570/1340
Parsing feeds: 571/1340
Parsing feeds: 572/1340
Parsing feeds: 573/1340
Parsing feeds: 574/1340
Parsing feeds: 575/1340
Parsing feeds: 576/1340
Parsing feeds: 577/1340
Parsing feeds: 578/1340
Parsing feeds: 579/1340
Parsing feeds: 580/1340
Parsing feeds: 581/1340
Parsing feeds: 582/1340
Parsing feeds: 583/1340
Parsing feeds: 584/1340
Parsing feeds: 585/1340
Parsing feeds: 586/1340
Parsing feeds: 587/1340
Parsing feeds: 588/1340
Parsing feeds: 589/1340
Parsing feeds: 590/1340
Parsing feeds: 591/1340
Parsing feeds: 592/1340
Parsing feeds: 593/1340
Parsing feeds: 594/1340
Parsing feeds: 595/1340
Parsing feeds: 596/1340
Parsing feeds: 597/1340
Parsing feeds: 598/1340
Parsing feeds: 599/1340
Parsing feeds: 600/1340
Parsing feeds: 601/1340
Parsing feeds: 602/1340
Parsing feeds: 603/1340
Parsing feeds: 604/1340
Parsing feeds: 605/1340
Parsing feeds: 606/1340
Parsing feeds: 607/1340
Parsing feeds: 608/1340
Parsing feeds: 609/1340
Parsing feeds: 610/1340
Parsing feeds: 611/1340
Parsing feeds: 612/1340
Parsing feeds: 613/1340
Parsing feeds: 614/1340
Parsing feeds: 615/1340
Parsing feeds: 616/1340
Parsing feeds: 617/1340
Parsing feeds: 618/1340
Parsing feeds: 619/1340
Parsing feeds: 620/1340
Parsing feeds: 621/1340
Parsing feeds: 622/1340
Parsing feeds: 623/1340
Parsing feeds: 624/1340
Parsing feeds: 625/1340
Parsing feeds: 626/1340
Parsing feeds: 627/1340
Parsing feeds: 628/1340
Parsing feeds: 629/1340
Parsing feeds: 630/1340
Parsing feeds: 631/1340
Parsing feeds: 632/1340
Parsing feeds: 633/1340
Parsing feeds: 634/1340
Parsing feeds: 635/1340
Parsing feeds: 636/1340
Parsing feeds: 637/1340
Parsing feeds: 638/1340
Parsing feeds: 639/1340
Parsing feeds: 640/1340
Parsing feeds: 641/1340
Parsing feeds: 642/1340
Parsing feeds: 643/1340
Parsing feeds: 644/1340
Parsing feeds: 645/1340
Parsing feeds: 646/1340
Parsing feeds: 647/1340
Parsing feeds: 648/1340
Parsing feeds: 649/1340
Parsing feeds: 650/1340
Parsing feeds: 651/1340
Parsing feeds: 652/1340
Parsing feeds: 653/1340
Parsing feeds: 654/1340
Parsing feeds: 655/1340
Parsing feeds: 656/1340
Parsing feeds: 657/1340
Parsing feeds: 658/1340
Parsing feeds: 659/1340
Parsing feeds: 660/1340
Parsing feeds: 661/1340
Parsing feeds: 662/1340
Parsing feeds: 663/1340
Parsing feeds: 664/1340
Parsing feeds: 665/1340
Parsing feeds: 666/1340
Parsing feeds: 667/1340
Parsing feeds: 668/1340
Parsing feeds: 669/1340
Parsing feeds: 670/1340
Parsing feeds: 671/1340
Parsing feeds: 672/1340
Parsing feeds: 673/1340
Parsing feeds: 674/1340
Parsing feeds: 675/1340
Parsing feeds: 676/1340
Parsing feeds: 677/1340
Parsing feeds: 678/1340
Parsing feeds: 679/1340
Parsing feeds: 680/1340
Parsing feeds: 681/1340
Parsing feeds: 682/1340
Parsing feeds: 683/1340
Parsing feeds: 684/1340
Parsing feeds: 685/1340
Parsing feeds: 686/1340
Parsing feeds: 687/1340
Parsing feeds: 688/1340
Parsing feeds: 689/1340
Parsing feeds: 690/1340
Parsing feeds: 691/1340
Parsing feeds: 692/1340
Parsing feeds: 693/1340
Parsing feeds: 694/1340
Parsing feeds: 695/1340
Parsing feeds: 696/1340
Parsing feeds: 697/1340
Parsing feeds: 698/1340
Parsing feeds: 699/1340
Parsing feeds: 700/1340
Parsing feeds: 701/1340
Parsing feeds: 702/1340
Parsing feeds: 703/1340
Parsing feeds: 704/1340
Parsing feeds: 705/1340
Parsing feeds: 706/1340
Parsing feeds: 707/1340
Parsing feeds: 708/1340
Parsing feeds: 709/1340
Parsing feeds: 710/1340
Parsing feeds: 711/1340
Parsing feeds: 712/1340
Parsing feeds: 713/1340
Parsing feeds: 714/1340
Parsing feeds: 715/1340
Parsing feeds: 716/1340
Parsing feeds: 717/1340
Parsing feeds: 718/1340
Parsing feeds: 719/1340
Parsing feeds: 720/1340
Parsing feeds: 721/1340
Parsing feeds: 722/1340
Parsing feeds: 723/1340
Parsing feeds: 724/1340
Parsing feeds: 725/1340
Parsing feeds: 726/1340
Parsing feeds: 727/1340
Parsing feeds: 728/1340
Parsing feeds: 729/1340
Parsing feeds: 730/1340
Parsing feeds: 731/1340
Parsing feeds: 732/1340
Parsing feeds: 733/1340
Parsing feeds: 734/1340
Parsing feeds: 735/1340
Parsing feeds: 736/1340
Parsing feeds: 737/1340
Parsing feeds: 738/1340
Parsing feeds: 739/1340
Parsing feeds: 740/1340
Parsing feeds: 741/1340
Parsing feeds: 742/1340
Parsing feeds: 743/1340
Parsing feeds: 744/1340
Parsing feeds: 745/1340
Parsing feeds: 746/1340
Parsing feeds: 747/1340
Parsing feeds: 748/1340
Parsing feeds: 749/1340
Parsing feeds: 750/1340
Parsing feeds: 751/1340
Parsing feeds: 752/1340
Parsing feeds: 753/1340
Parsing feeds: 754/1340
Parsing feeds: 755/1340
Parsing feeds: 756/1340
Parsing feeds: 757/1340
Parsing feeds: 758/1340
Parsing feeds: 759/1340
Parsing feeds: 760/1340
Parsing feeds: 761/1340
Parsing feeds: 762/1340
Parsing feeds: 763/1340
Parsing feeds: 764/1340
Parsing feeds: 765/1340
Parsing feeds: 766/1340
Parsing feeds: 767/1340
Parsing feeds: 768/1340
Parsing feeds: 769/1340
Parsing feeds: 770/1340
Parsing feeds: 771/1340
Parsing feeds: 772/1340
Parsing feeds: 773/1340
Parsing feeds: 774/1340
Parsing feeds: 775/1340
Parsing feeds: 776/1340
Parsing feeds: 777/1340
Parsing feeds: 778/1340
Parsing feeds: 779/1340
Parsing feeds: 780/1340
Parsing feeds: 781/1340
Parsing feeds: 782/1340
Parsing feeds: 783/1340
Parsing feeds: 784/1340
Parsing feeds: 785/1340
Parsing feeds: 786/1340
Parsing feeds: 787/1340
Parsing feeds: 788/1340
Parsing feeds: 789/1340
Parsing feeds: 790/1340
Parsing feeds: 791/1340
Parsing feeds: 792/1340
Parsing feeds: 793/1340
Parsing feeds: 794/1340
Parsing feeds: 795/1340
Parsing feeds: 796/1340
Parsing feeds: 797/1340
Parsing feeds: 798/1340
Parsing feeds: 799/1340
Parsing feeds: 800/1340
Parsing feeds: 801/1340
Parsing feeds: 802/1340
Parsing feeds: 803/1340
Parsing feeds: 804/1340
Parsing feeds: 805/1340
Parsing feeds: 806/1340
Parsing feeds: 807/1340
Parsing feeds: 808/1340
Parsing feeds: 809/1340
Parsing feeds: 810/1340
Parsing feeds: 811/1340
Parsing feeds: 812/1340
Parsing feeds: 813/1340
Parsing feeds: 814/1340
Parsing feeds: 815/1340
Parsing feeds: 816/1340
Parsing feeds: 817/1340
Parsing feeds: 818/1340
Parsing feeds: 819/1340
Parsing feeds: 820/1340
Parsing feeds: 821/1340
Parsing feeds: 822/1340
Parsing feeds: 823/1340
Parsing feeds: 824/1340
Parsing feeds: 825/1340
Parsing feeds: 826/1340
Parsing feeds: 827/1340
Parsing feeds: 828/1340
Parsing feeds: 829/1340
Parsing feeds: 830/1340
Parsing feeds: 831/1340
Parsing feeds: 832/1340
Parsing feeds: 833/1340
Parsing feeds: 834/1340
Parsing feeds: 835/1340
Parsing feeds: 836/1340
Parsing feeds: 837/1340
Parsing feeds: 838/1340
Parsing feeds: 839/1340
Parsing feeds: 840/1340
Parsing feeds: 841/1340
Parsing feeds: 842/1340
Parsing feeds: 843/1340
Parsing feeds: 844/1340
Parsing feeds: 845/1340
Parsing feeds: 846/1340
Parsing feeds: 847/1340
Parsing feeds: 848/1340
Parsing feeds: 849/1340
Parsing feeds: 850/1340
Parsing feeds: 851/1340
Parsing feeds: 852/1340
Parsing feeds: 853/1340
Parsing feeds: 854/1340
Parsing feeds: 855/1340
Parsing feeds: 856/1340
Parsing feeds: 857/1340
Parsing feeds: 858/1340
Parsing feeds: 859/1340
Parsing feeds: 860/1340
Parsing feeds: 861/1340
Parsing feeds: 862/1340
Parsing feeds: 863/1340
Parsing feeds: 864/1340
Parsing feeds: 865/1340
Parsing feeds: 866/1340
Parsing feeds: 867/1340
Parsing feeds: 868/1340
Parsing feeds: 869/1340
Parsing feeds: 870/1340
Parsing feeds: 871/1340
Parsing feeds: 872/1340
Parsing feeds: 873/1340
Parsing feeds: 874/1340
Parsing feeds: 875/1340
Parsing feeds: 876/1340
Parsing feeds: 877/1340
Parsing feeds: 878/1340
Parsing feeds: 879/1340
Parsing feeds: 880/1340
Parsing feeds: 881/1340
Parsing feeds: 882/1340
Parsing feeds: 883/1340
Parsing feeds: 884/1340
Parsing feeds: 885/1340
Parsing feeds: 886/1340
Parsing feeds: 887/1340
Parsing feeds: 888/1340
Parsing feeds: 889/1340
Parsing feeds: 890/1340
Parsing feeds: 891/1340
Parsing feeds: 892/1340
Parsing feeds: 893/1340
Parsing feeds: 894/1340
Parsing feeds: 895/1340
Parsing feeds: 896/1340
Parsing feeds: 897/1340
Parsing feeds: 898/1340
Parsing feeds: 899/1340
Parsing feeds: 900/1340
Parsing feeds: 901/1340
Parsing feeds: 902/1340
Parsing feeds: 903/1340
Parsing feeds: 904/1340
Parsing feeds: 905/1340
Parsing feeds: 906/1340
Parsing feeds: 907/1340
Parsing feeds: 908/1340
Parsing feeds: 909/1340
Parsing feeds: 910/1340
Parsing feeds: 911/1340
Parsing feeds: 912/1340
Parsing feeds: 913/1340
Parsing feeds: 914/1340
Parsing feeds: 915/1340
Parsing feeds: 916/1340
Parsing feeds: 917/1340
Parsing feeds: 918/1340
Parsing feeds: 919/1340
Parsing feeds: 920/1340
Parsing feeds: 921/1340
Parsing feeds: 922/1340
Parsing feeds: 923/1340
Parsing feeds: 924/1340
Parsing feeds: 925/1340
Parsing feeds: 926/1340
Parsing feeds: 927/1340
Parsing feeds: 928/1340
Parsing feeds: 929/1340
Parsing feeds: 930/1340
Parsing feeds: 931/1340
Parsing feeds: 932/1340
Parsing feeds: 933/1340
Parsing feeds: 934/1340
Parsing feeds: 935/1340
Parsing feeds: 936/1340
Parsing feeds: 937/1340
Parsing feeds: 938/1340
Parsing feeds: 939/1340
Parsing feeds: 940/1340
Parsing feeds: 941/1340
Parsing feeds: 942/1340
Parsing feeds: 943/1340
Parsing feeds: 944/1340
Parsing feeds: 945/1340
Parsing feeds: 946/1340
Parsing feeds: 947/1340
Parsing feeds: 948/1340
Parsing feeds: 949/1340
Parsing feeds: 950/1340
Parsing feeds: 951/1340
Parsing feeds: 952/1340
Parsing feeds: 953/1340
Parsing feeds: 954/1340
Parsing feeds: 955/1340
Parsing feeds: 956/1340
Parsing feeds: 957/1340
Parsing feeds: 958/1340
Parsing feeds: 959/1340
Parsing feeds: 960/1340
Parsing feeds: 961/1340
Parsing feeds: 962/1340
Parsing feeds: 963/1340
Parsing feeds: 964/1340
Parsing feeds: 965/1340
Parsing feeds: 966/1340
Parsing feeds: 967/1340
Parsing feeds: 968/1340
Parsing feeds: 969/1340
Parsing feeds: 970/1340
Parsing feeds: 971/1340
Parsing feeds: 972/1340
Parsing feeds: 973/1340
Parsing feeds: 974/1340
Parsing feeds: 975/1340
Parsing feeds: 976/1340
Parsing feeds: 977/1340
Parsing feeds: 978/1340
Parsing feeds: 979/1340
Parsing feeds: 980/1340
Parsing feeds: 981/1340
Parsing feeds: 982/1340
Parsing feeds: 983/1340
Parsing feeds: 984/1340
Parsing feeds: 985/1340
Parsing feeds: 986/1340
Parsing feeds: 987/1340
Parsing feeds: 988/1340
Parsing feeds: 989/1340
Parsing feeds: 990/1340
Parsing feeds: 991/1340
Parsing feeds: 992/1340
Parsing feeds: 993/1340
Parsing feeds: 994/1340
Parsing feeds: 995/1340
Parsing feeds: 996/1340
Parsing feeds: 997/1340
Parsing feeds: 998/1340
Parsing feeds: 999/1340
Parsing feeds: 1000/1340
Parsing feeds: 1001/1340
Parsing feeds: 1002/1340
Parsing feeds: 1003/1340
Parsing feeds: 1004/1340
Parsing feeds: 1005/1340
Parsing feeds: 1006/1340
Parsing feeds: 1007/1340
Parsing feeds: 1008/1340
Parsing feeds: 1009/1340
Parsing feeds: 1010/1340
Parsing feeds: 1011/1340
Parsing feeds: 1012/1340
Parsing feeds: 1013/1340
Parsing feeds: 1014/1340
Parsing feeds: 1015/1340
Parsing feeds: 1016/1340
Parsing feeds: 1017/1340
Parsing feeds: 1018/1340
Parsing feeds: 1019/1340
Parsing feeds: 1020/1340
Parsing feeds: 1021/1340
Parsing feeds: 1022/1340
Parsing feeds: 1023/1340
Parsing feeds: 1024/1340
Parsing feeds: 1025/1340
Parsing feeds: 1026/1340
Parsing feeds: 1027/1340
Parsing feeds: 1028/1340
Parsing feeds: 1029/1340
Parsing feeds: 1030/1340
Parsing feeds: 1031/1340
Parsing feeds: 1032/1340
Parsing feeds: 1033/1340
Parsing feeds: 1034/1340
Parsing feeds: 1035/1340
Parsing feeds: 1036/1340
Parsing feeds: 1037/1340
Parsing feeds: 1038/1340
Parsing feeds: 1039/1340
Parsing feeds: 1040/1340
Parsing feeds: 1041/1340
Parsing feeds: 1042/1340
Parsing feeds: 1043/1340
Parsing feeds: 1044/1340
Parsing feeds: 1045/1340
Parsing feeds: 1046/1340
Parsing feeds: 1047/1340
Parsing feeds: 1048/1340
Parsing feeds: 1049/1340
Parsing feeds: 1050/1340
Parsing feeds: 1051/1340
Parsing feeds: 1052/1340
Parsing feeds: 1053/1340
Parsing feeds: 1054/1340
Parsing feeds: 1055/1340
Parsing feeds: 1056/1340
Parsing feeds: 1057/1340
Parsing feeds: 1058/1340
Parsing feeds: 1059/1340
Parsing feeds: 1060/1340
Parsing feeds: 1061/1340
Parsing feeds: 1062/1340
Parsing feeds: 1063/1340
Parsing feeds: 1064/1340
Parsing feeds: 1065/1340
Parsing feeds: 1066/1340
Parsing feeds: 1067/1340
Parsing feeds: 1068/1340
Parsing feeds: 1069/1340
Parsing feeds: 1070/1340
Parsing feeds: 1071/1340
Parsing feeds: 1072/1340
Parsing feeds: 1073/1340
Parsing feeds: 1074/1340
Parsing feeds: 1075/1340
Parsing feeds: 1076/1340
Parsing feeds: 1077/1340
Parsing feeds: 1078/1340
Parsing feeds: 1079/1340
Parsing feeds: 1080/1340
Parsing feeds: 1081/1340
Parsing feeds: 1082/1340
Parsing feeds: 1083/1340
Parsing feeds: 1084/1340
Parsing feeds: 1085/1340
Parsing feeds: 1086/1340
Parsing feeds: 1087/1340
Parsing feeds: 1088/1340
Parsing feeds: 1089/1340
Parsing feeds: 1090/1340
Parsing feeds: 1091/1340
Parsing feeds: 1092/1340
Parsing feeds: 1093/1340
Parsing feeds: 1094/1340
Parsing feeds: 1095/1340
Parsing feeds: 1096/1340
Parsing feeds: 1097/1340
Parsing feeds: 1098/1340
Parsing feeds: 1099/1340
Parsing feeds: 1100/1340
Parsing feeds: 1101/1340
Parsing feeds: 1102/1340
Parsing feeds: 1103/1340
Parsing feeds: 1104/1340
Parsing feeds: 1105/1340
Parsing feeds: 1106/1340
Parsing feeds: 1107/1340
Parsing feeds: 1108/1340
Parsing feeds: 1109/1340
Parsing feeds: 1110/1340
Parsing feeds: 1111/1340
Parsing feeds: 1112/1340
Parsing feeds: 1113/1340
Parsing feeds: 1114/1340
Parsing feeds: 1115/1340
Parsing feeds: 1116/1340
Parsing feeds: 1117/1340
Parsing feeds: 1118/1340
Parsing feeds: 1119/1340
Parsing feeds: 1120/1340
Parsing feeds: 1121/1340
Parsing feeds: 1122/1340
Parsing feeds: 1123/1340
Parsing feeds: 1124/1340
Parsing feeds: 1125/1340
Parsing feeds: 1126/1340
Parsing feeds: 1127/1340
Parsing feeds: 1128/1340
Parsing feeds: 1129/1340
Parsing feeds: 1130/1340
Parsing feeds: 1131/1340
Parsing feeds: 1132/1340
Parsing feeds: 1133/1340
Parsing feeds: 1134/1340
Parsing feeds: 1135/1340
Parsing feeds: 1136/1340
Parsing feeds: 1137/1340
Parsing feeds: 1138/1340
Parsing feeds: 1139/1340
Parsing feeds: 1140/1340
Parsing feeds: 1141/1340
Parsing feeds: 1142/1340
Parsing feeds: 1143/1340
Parsing feeds: 1144/1340
Parsing feeds: 1145/1340
Parsing feeds: 1146/1340
Parsing feeds: 1147/1340
Parsing feeds: 1148/1340
Parsing feeds: 1149/1340
Parsing feeds: 1150/1340
Parsing feeds: 1151/1340
Parsing feeds: 1152/1340
Parsing feeds: 1153/1340
Parsing feeds: 1154/1340
Parsing feeds: 1155/1340
Parsing feeds: 1156/1340
Parsing feeds: 1157/1340
Parsing feeds: 1158/1340
Parsing feeds: 1159/1340
Parsing feeds: 1160/1340
Parsing feeds: 1161/1340
Parsing feeds: 1162/1340
Parsing feeds: 1163/1340
Parsing feeds: 1164/1340
Parsing feeds: 1165/1340
Parsing feeds: 1166/1340
Parsing feeds: 1167/1340
Parsing feeds: 1168/1340
Parsing feeds: 1169/1340
Parsing feeds: 1170/1340
Parsing feeds: 1171/1340
Parsing feeds: 1172/1340
Parsing feeds: 1173/1340
Parsing feeds: 1174/1340
Parsing feeds: 1175/1340
Parsing feeds: 1176/1340
Parsing feeds: 1177/1340
Parsing feeds: 1178/1340
Parsing feeds: 1179/1340
Parsing feeds: 1180/1340
Parsing feeds: 1181/1340
Parsing feeds: 1182/1340
Parsing feeds: 1183/1340
Parsing feeds: 1184/1340
Parsing feeds: 1185/1340
Parsing feeds: 1186/1340
Parsing feeds: 1187/1340
Parsing feeds: 1188/1340
Parsing feeds: 1189/1340
Parsing feeds: 1190/1340
Parsing feeds: 1191/1340
Parsing feeds: 1192/1340
Parsing feeds: 1193/1340
Parsing feeds: 1194/1340
Parsing feeds: 1195/1340
Parsing feeds: 1196/1340
Parsing feeds: 1197/1340
Parsing feeds: 1198/1340
Parsing feeds: 1199/1340
Parsing feeds: 1200/1340
Parsing feeds: 1201/1340
Parsing feeds: 1202/1340
Parsing feeds: 1203/1340
Parsing feeds: 1204/1340
Parsing feeds: 1205/1340
Parsing feeds: 1206/1340
Parsing feeds: 1207/1340
Parsing feeds: 1208/1340
Parsing feeds: 1209/1340
Parsing feeds: 1210/1340
Parsing feeds: 1211/1340
Parsing feeds: 1212/1340
Parsing feeds: 1213/1340
Parsing feeds: 1214/1340
Parsing feeds: 1215/1340
Parsing feeds: 1216/1340
Parsing feeds: 1217/1340
Parsing feeds: 1218/1340
Parsing feeds: 1219/1340
Parsing feeds: 1220/1340
Parsing feeds: 1221/1340
Parsing feeds: 1222/1340
Parsing feeds: 1223/1340
Parsing feeds: 1224/1340
Parsing feeds: 1225/1340
Parsing feeds: 1226/1340
Parsing feeds: 1227/1340
Parsing feeds: 1228/1340
Parsing feeds: 1229/1340
Parsing feeds: 1230/1340
Parsing feeds: 1231/1340
Parsing feeds: 1232/1340
Parsing feeds: 1233/1340
Parsing feeds: 1234/1340
Parsing feeds: 1235/1340
Parsing feeds: 1236/1340
Parsing feeds: 1237/1340
Parsing feeds: 1238/1340
Parsing feeds: 1239/1340
Parsing feeds: 1240/1340
Parsing feeds: 1241/1340
Parsing feeds: 1242/1340
Parsing feeds: 1243/1340
Parsing feeds: 1244/1340
Parsing feeds: 1245/1340
Parsing feeds: 1246/1340
Parsing feeds: 1247/1340
Parsing feeds: 1248/1340
Parsing feeds: 1249/1340
Parsing feeds: 1250/1340
Parsing feeds: 1251/1340
Parsing feeds: 1252/1340
Parsing feeds: 1253/1340
Parsing feeds: 1254/1340
Parsing feeds: 1255/1340
Parsing feeds: 1256/1340
Parsing feeds: 1257/1340
Parsing feeds: 1258/1340
Parsing feeds: 1259/1340
Parsing feeds: 1260/1340
Parsing feeds: 1261/1340
Parsing feeds: 1262/1340
Parsing feeds: 1263/1340
Parsing feeds: 1264/1340
Parsing feeds: 1265/1340
Parsing feeds: 1266/1340
Parsing feeds: 1267/1340
Parsing feeds: 1268/1340
Parsing feeds: 1269/1340
Parsing feeds: 1270/1340
Parsing feeds: 1271/1340
Parsing feeds: 1272/1340
Parsing feeds: 1273/1340
Parsing feeds: 1274/1340
Parsing feeds: 1275/1340
Parsing feeds: 1276/1340
Parsing feeds: 1277/1340
Parsing feeds: 1278/1340
Parsing feeds: 1279/1340
Parsing feeds: 1280/1340
Parsing feeds: 1281/1340
Parsing feeds: 1282/1340
Parsing feeds: 1283/1340
Parsing feeds: 1284/1340
Parsing feeds: 1285/1340
Parsing feeds: 1286/1340
Parsing feeds: 1287/1340
Parsing feeds: 1288/1340
Parsing feeds: 1289/1340
Parsing feeds: 1290/1340
Parsing feeds: 1291/1340
Parsing feeds: 1292/1340
Parsing feeds: 1293/1340
Parsing feeds: 1294/1340
Parsing feeds: 1295/1340
Parsing feeds: 1296/1340
Parsing feeds: 1297/1340
Parsing feeds: 1298/1340
Parsing feeds: 1299/1340
Parsing feeds: 1300/1340
Parsing feeds: 1301/1340
Parsing feeds: 1302/1340
Parsing feeds: 1303/1340
Parsing feeds: 1304/1340
Parsing feeds: 1305/1340
Parsing feeds: 1306/1340
Parsing feeds: 1307/1340
Parsing feeds: 1308/1340
Parsing feeds: 1309/1340
Parsing feeds: 1310/1340
Parsing feeds: 1311/1340
Parsing feeds: 1312/1340
Parsing feeds: 1313/1340
Parsing feeds: 1314/1340
Parsing feeds: 1315/1340
Parsing feeds: 1316/1340
Parsing feeds: 1317/1340
Parsing feeds: 1318/1340
Parsing feeds: 1319/1340
Parsing feeds: 1320/1340
Parsing feeds: 1321/1340
Parsing feeds: 1322/1340
Parsing feeds: 1323/1340
Parsing feeds: 1324/1340
Parsing feeds: 1325/1340
Parsing feeds: 1326/1340
Parsing feeds: 1327/1340
Parsing feeds: 1328/1340
Parsing feeds: 1329/1340
Parsing feeds: 1330/1340
Parsing feeds: 1331/1340
Parsing feeds: 1332/1340
Parsing feeds: 1333/1340
Parsing feeds: 1334/1340
Parsing feeds: 1335/1340
Parsing feeds: 1336/1340
Parsing feeds: 1337/1340
Parsing feeds: 1338/1340
Parsing feeds: 1339/1340
Parsing feeds: 1340/1340
Finished parsing feeds: 1340/1340
INFO:root:Saved season data to data/20252026.csv
INFO:root:Finished _season: feeds=1340, records=149197
/home/spoon/new_puck/analysis/teams.json already exists. Use --force to overwrite.
Season data updated. Total games: 546
Updating teams list...

[2/4] Pre-Computing Intervals...
DEBUG: get_game_intervals_cached HIT 2025010073 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025010073 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025010073 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010074 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025010074 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010074 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025010075 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025010075 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025010075 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025010076 key=5v5 len=17
DEBUG: get_game_intervals_cached HIT 2025010076 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010076 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025010077 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025010077 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025010077 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025010078 key=5v5 len=14
DEBUG: get_game_intervals_cached HIT 2025010078 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025010078 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010079 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025010079 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010079 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025010080 key=5v5 len=18
DEBUG: get_game_intervals_cached HIT 2025010080 key=5v4 len=9
DEBUG: get_game_intervals_cached HIT 2025010080 key=4v5 len=8
DEBUG: get_game_intervals_cached HIT 2025010081 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025010081 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025010081 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010082 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025010082 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025010082 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025010083 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025010083 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025010083 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010084 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025010084 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025010084 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025010085 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025010085 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010085 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010086 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025010086 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010086 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025010087 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025010087 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010087 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010088 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025010088 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025010088 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010089 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025010089 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025010089 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010090 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025010090 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010090 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025010091 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025010091 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025010091 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025010092 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025010092 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025010092 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025010093 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025010093 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025010093 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025010094 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025010094 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010094 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025010095 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025010095 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010095 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025010096 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025010096 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010096 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025010097 key=5v5 len=13
DEBUG: get_game_intervals_cached HIT 2025010097 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010097 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025010098 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025010098 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010098 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010099 key=5v5 len=12
DEBUG: get_game_intervals_cached HIT 2025010099 key=5v4 len=13
DEBUG: get_game_intervals_cached HIT 2025010099 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010100 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025010100 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025010100 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020001 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020001 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020001 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020002 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020002 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020002 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020003 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020003 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020003 key=4v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020004 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020004 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020004 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020005 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020005 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020005 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020006 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020006 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020006 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020007 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020007 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020007 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020008 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020008 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020008 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020009 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020009 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020009 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020010 key=5v5 len=15
DEBUG: get_game_intervals_cached HIT 2025020010 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020010 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020011 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020011 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020011 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020012 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020012 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020012 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020013 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020013 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020013 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020014 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020014 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020014 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020015 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020015 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020015 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020016 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020016 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020016 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020017 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020017 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020017 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020018 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020018 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020018 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020019 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020019 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020019 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020020 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020020 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020020 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020021 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020021 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020021 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020022 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020022 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020022 key=4v5 len=4
Processed intervals for 50/546 games...
DEBUG: get_game_intervals_cached HIT 2025020023 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020023 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020023 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020024 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020024 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020024 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020025 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020025 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020025 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020026 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020026 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020026 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020027 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020027 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020027 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020028 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020028 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020028 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020029 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020029 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020029 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020030 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020030 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020030 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020031 key=5v5 len=13
DEBUG: get_game_intervals_cached HIT 2025020031 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020031 key=4v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020032 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020032 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020032 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020033 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020033 key=5v4 len=7
DEBUG: get_game_intervals_cached HIT 2025020033 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020034 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020034 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020034 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020035 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020035 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020035 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020036 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020036 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020036 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020037 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020037 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020037 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020038 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020038 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020038 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020039 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020039 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020039 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020040 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020040 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020040 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020041 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020041 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020041 key=4v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020042 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020042 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020042 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020043 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020043 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020043 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020044 key=5v5 len=12
DEBUG: get_game_intervals_cached HIT 2025020044 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020044 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020045 key=5v5 len=12
DEBUG: get_game_intervals_cached HIT 2025020045 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020045 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020046 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020046 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020046 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020047 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020047 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020047 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020048 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020048 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020048 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020049 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020049 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020049 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020050 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020050 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020050 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020051 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020051 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020051 key=4v5 len=0
DEBUG: get_game_intervals_cached HIT 2025020052 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020052 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020052 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020053 key=5v5 len=15
DEBUG: get_game_intervals_cached HIT 2025020053 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020053 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020054 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020054 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020054 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020055 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020055 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020055 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020056 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020056 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020056 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020057 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020057 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020057 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020058 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020058 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020058 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020059 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020059 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020059 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020060 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020060 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020060 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020061 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020061 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020061 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020062 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020062 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020062 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020063 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020063 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020063 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020064 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020064 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020064 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020065 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020065 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020065 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020066 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020066 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020066 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020067 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020067 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020067 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020068 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020068 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020068 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020069 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020069 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020069 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020070 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020070 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020070 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020071 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020071 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020071 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020072 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020072 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020072 key=4v5 len=3
Processed intervals for 100/546 games...
DEBUG: get_game_intervals_cached HIT 2025020073 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020073 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020073 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020074 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020074 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020074 key=4v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020075 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020075 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020075 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020076 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020076 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020076 key=4v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020077 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020077 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020077 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020078 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020078 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020078 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020079 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020079 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020079 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020080 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020080 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020080 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020081 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020081 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020081 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020082 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020082 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020082 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020083 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020083 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020083 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020084 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020084 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020084 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020085 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020085 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020085 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020086 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020086 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020086 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020087 key=5v5 len=16
DEBUG: get_game_intervals_cached HIT 2025020087 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020087 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020088 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020088 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020088 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020089 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020089 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020089 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020090 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020090 key=5v4 len=0
DEBUG: get_game_intervals_cached HIT 2025020090 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020091 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020091 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020091 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020092 key=5v5 len=12
DEBUG: get_game_intervals_cached HIT 2025020092 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020092 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020093 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020093 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020093 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020094 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020094 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020094 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020095 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020095 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020095 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020096 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020096 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020096 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020097 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020097 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020097 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020098 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020098 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020098 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020099 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020099 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020099 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020100 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020100 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020100 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020101 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020101 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020101 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020102 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020102 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020102 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020103 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020103 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020103 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020104 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020104 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020104 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020105 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020105 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020105 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020106 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020106 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020106 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020107 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020107 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020107 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020108 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020108 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020108 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020109 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020109 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020109 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020110 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020110 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020110 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020111 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020111 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020111 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020112 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020112 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020112 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020113 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020113 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020113 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020114 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020114 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020114 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020115 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020115 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020115 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020116 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020116 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020116 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020117 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020117 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020117 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020118 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020118 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020118 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020119 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020119 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020119 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020120 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020120 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020120 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020121 key=5v5 len=15
DEBUG: get_game_intervals_cached HIT 2025020121 key=5v4 len=7
DEBUG: get_game_intervals_cached HIT 2025020121 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020122 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020122 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020122 key=4v5 len=1
Processed intervals for 150/546 games...
DEBUG: get_game_intervals_cached HIT 2025020123 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020123 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020123 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020124 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020124 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020124 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020125 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020125 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020125 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020126 key=5v5 len=14
DEBUG: get_game_intervals_cached HIT 2025020126 key=5v4 len=8
DEBUG: get_game_intervals_cached HIT 2025020126 key=4v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020127 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020127 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020127 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020128 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020128 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020128 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020129 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020129 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020129 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020130 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020130 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020130 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020131 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020131 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020131 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020132 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020132 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020132 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020133 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020133 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020133 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020134 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020134 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020134 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020135 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020135 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020135 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020136 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020136 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020136 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020137 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020137 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020137 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020138 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020138 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020138 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020139 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020139 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020139 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020140 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020140 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020140 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020141 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020141 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020141 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020142 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020142 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020142 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020143 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020143 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020143 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020144 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020144 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020144 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020145 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020145 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020145 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020146 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020146 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020146 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020147 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020147 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020147 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020148 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020148 key=5v4 len=0
DEBUG: get_game_intervals_cached HIT 2025020148 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020149 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020149 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020149 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020150 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020150 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020150 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020151 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020151 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020151 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020152 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020152 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020152 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020153 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020153 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020153 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020154 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020154 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020154 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020155 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020155 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020155 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020156 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020156 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020156 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020157 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020157 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020157 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020158 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020158 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020158 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020159 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020159 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020159 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020160 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020160 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020160 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020161 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020161 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020161 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020162 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020162 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020162 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020163 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020163 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020163 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020164 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020164 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020164 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020165 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020165 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020165 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020166 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020166 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020166 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020167 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020167 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020167 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020168 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020168 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020168 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020169 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020169 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020169 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020170 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020170 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020170 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020171 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020171 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020171 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020172 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020172 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020172 key=4v5 len=3
Processed intervals for 200/546 games...
DEBUG: get_game_intervals_cached HIT 2025020173 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020173 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020173 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020174 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020174 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020174 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020175 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020175 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020175 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020176 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020176 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020176 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020177 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020177 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020177 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020178 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020178 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020178 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020179 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020179 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020179 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020180 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020180 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020180 key=4v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020181 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020181 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020181 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020182 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020182 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020182 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020183 key=5v5 len=15
DEBUG: get_game_intervals_cached HIT 2025020183 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020183 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020184 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020184 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020184 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020185 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020185 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020185 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020186 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020186 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020186 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020187 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020187 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020187 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020188 key=5v5 len=12
DEBUG: get_game_intervals_cached HIT 2025020188 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020188 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020189 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020189 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020189 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020190 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020190 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020190 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020191 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020191 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020191 key=4v5 len=0
DEBUG: get_game_intervals_cached HIT 2025020192 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020192 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020192 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020193 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020193 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020193 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020194 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020194 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020194 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020195 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020195 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020195 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020196 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020196 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020196 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020197 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020197 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020197 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020198 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020198 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020198 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020199 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020199 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020199 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020200 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020200 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020200 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020201 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020201 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020201 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020202 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020202 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020202 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020203 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020203 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020203 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020204 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020204 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020204 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020205 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020205 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020205 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020206 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020206 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020206 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020207 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020207 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020207 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020208 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020208 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020208 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020209 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020209 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020209 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020210 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020210 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020210 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020211 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020211 key=5v4 len=7
DEBUG: get_game_intervals_cached HIT 2025020211 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020212 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020212 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020212 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020213 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020213 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020213 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020214 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020214 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020214 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020215 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020215 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020215 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020216 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020216 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020216 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020217 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020217 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020217 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020218 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020218 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020218 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020219 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020219 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020219 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020220 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020220 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020220 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020221 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020221 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020221 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020222 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020222 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020222 key=4v5 len=2
Processed intervals for 250/546 games...
DEBUG: get_game_intervals_cached HIT 2025020223 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020223 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020223 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020224 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020224 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020224 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020225 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020225 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020225 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020226 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020226 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020226 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020227 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020227 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020227 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020228 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020228 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020228 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020229 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020229 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020229 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020230 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020230 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020230 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020231 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020231 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020231 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020232 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020232 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020232 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020233 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020233 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020233 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020234 key=5v5 len=14
DEBUG: get_game_intervals_cached HIT 2025020234 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020234 key=4v5 len=0
DEBUG: get_game_intervals_cached HIT 2025020235 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020235 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020235 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020236 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020236 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020236 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020237 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020237 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020237 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020238 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020238 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020238 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020239 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020239 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020239 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020240 key=5v5 len=14
DEBUG: get_game_intervals_cached HIT 2025020240 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020240 key=4v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020241 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020241 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020241 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020242 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020242 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020242 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020243 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020243 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020243 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020244 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020244 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020244 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020245 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020245 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020245 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020246 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020246 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020246 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020247 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020247 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020247 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020248 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020248 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020248 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020249 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020249 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020249 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020250 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020250 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020250 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020251 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020251 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020251 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020252 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020252 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020252 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020253 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020253 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020253 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020254 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020254 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020254 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020255 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020255 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020255 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020256 key=5v5 len=17
DEBUG: get_game_intervals_cached HIT 2025020256 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020256 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020257 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020257 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020257 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020258 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020258 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020258 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020259 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020259 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020259 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020260 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020260 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020260 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020261 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020261 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020261 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020262 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020262 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020262 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020263 key=5v5 len=14
DEBUG: get_game_intervals_cached HIT 2025020263 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020263 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020264 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020264 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020264 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020265 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020265 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020265 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020266 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020266 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020266 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020267 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020267 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020267 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020268 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020268 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020268 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020269 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020269 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020269 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020270 key=5v5 len=13
DEBUG: get_game_intervals_cached HIT 2025020270 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020270 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020271 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020271 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020271 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020272 key=5v5 len=16
DEBUG: get_game_intervals_cached HIT 2025020272 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020272 key=4v5 len=4
Processed intervals for 300/546 games...
DEBUG: get_game_intervals_cached HIT 2025020273 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020273 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020273 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020274 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020274 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020274 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020275 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020275 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020275 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020276 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020276 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020276 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020277 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020277 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020277 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020278 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020278 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020278 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020279 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020279 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020279 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020280 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020280 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020280 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020281 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020281 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020281 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020282 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020282 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020282 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020283 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020283 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020283 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020284 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020284 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020284 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020285 key=5v5 len=13
DEBUG: get_game_intervals_cached HIT 2025020285 key=5v4 len=7
DEBUG: get_game_intervals_cached HIT 2025020285 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020286 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020286 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020286 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020287 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020287 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020287 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020288 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020288 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020288 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020289 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020289 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020289 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020290 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020290 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020290 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020291 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020291 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020291 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020292 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020292 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020292 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020293 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020293 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020293 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020294 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020294 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020294 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020295 key=5v5 len=13
DEBUG: get_game_intervals_cached HIT 2025020295 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020295 key=4v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020296 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020296 key=5v4 len=0
DEBUG: get_game_intervals_cached HIT 2025020296 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020297 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020297 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020297 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020298 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020298 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020298 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020299 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020299 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020299 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020300 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020300 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020300 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020301 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020301 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020301 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020302 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020302 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020302 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020303 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020303 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020303 key=4v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020304 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020304 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020304 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020305 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020305 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020305 key=4v5 len=0
DEBUG: get_game_intervals_cached HIT 2025020306 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020306 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020306 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020307 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020307 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020307 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020308 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020308 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020308 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020309 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020309 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020309 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020310 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020310 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020310 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020311 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020311 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020311 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020312 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020312 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020312 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020313 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020313 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020313 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020314 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020314 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020314 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020315 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020315 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020315 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020316 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020316 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020316 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020317 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020317 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020317 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020318 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020318 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020318 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020319 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020319 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020319 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020320 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020320 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020320 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020321 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020321 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020321 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020322 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020322 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020322 key=4v5 len=2
Processed intervals for 350/546 games...
DEBUG: get_game_intervals_cached HIT 2025020323 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020323 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020323 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020324 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020324 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020324 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020325 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020325 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020325 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020326 key=5v5 len=12
DEBUG: get_game_intervals_cached HIT 2025020326 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020326 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020327 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020327 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020327 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020328 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020328 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020328 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020329 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020329 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020329 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020330 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020330 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020330 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020331 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020331 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020331 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020332 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020332 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020332 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020333 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020333 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020333 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020334 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020334 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020334 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020335 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020335 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020335 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020336 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020336 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020336 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020337 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020337 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020337 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020338 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020338 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020338 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020339 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020339 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020339 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020340 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020340 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020340 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020341 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020341 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020341 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020342 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020342 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020342 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020343 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020343 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020343 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020344 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020344 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020344 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020345 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020345 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020345 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020346 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020346 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020346 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020347 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020347 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020347 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020348 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020348 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020348 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020349 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020349 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020349 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020350 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020350 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020350 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020351 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020351 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020351 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020352 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020352 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020352 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020353 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020353 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020353 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020354 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020354 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020354 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020355 key=5v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020355 key=5v4 len=0
DEBUG: get_game_intervals_cached HIT 2025020355 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020356 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020356 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020356 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020357 key=5v5 len=13
DEBUG: get_game_intervals_cached HIT 2025020357 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020357 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020358 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020358 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020358 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020359 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020359 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020359 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020360 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020360 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020360 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020361 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020361 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020361 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020362 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020362 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020362 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020363 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020363 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020363 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020364 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020364 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020364 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020365 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020365 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020365 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020366 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020366 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020366 key=4v5 len=0
DEBUG: get_game_intervals_cached HIT 2025020367 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020367 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020367 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020368 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020368 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020368 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020369 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020369 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020369 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020370 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020370 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020370 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020371 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020371 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020371 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020372 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020372 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020372 key=4v5 len=3
Processed intervals for 400/546 games...
DEBUG: get_game_intervals_cached HIT 2025020373 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020373 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020373 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020374 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020374 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020374 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020375 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020375 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020375 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020376 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020376 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020376 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020377 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020377 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020377 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020378 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020378 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020378 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020379 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020379 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020379 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020380 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020380 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020380 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020381 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020381 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020381 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020382 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020382 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020382 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020383 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020383 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020383 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020384 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020384 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020384 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020385 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020385 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020385 key=4v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020386 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020386 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020386 key=4v5 len=0
DEBUG: get_game_intervals_cached HIT 2025020387 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020387 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020387 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020388 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020388 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020388 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020389 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020389 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020389 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020390 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020390 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020390 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020391 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020391 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020391 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020392 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020392 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020392 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020393 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020393 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020393 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020394 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020394 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020394 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020395 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020395 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020395 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020396 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020396 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020396 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020397 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020397 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020397 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020398 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020398 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020398 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020399 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020399 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020399 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020400 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020400 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020400 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020401 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020401 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020401 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020402 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020402 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020402 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020403 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020403 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020403 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020404 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020404 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020404 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020405 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020405 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020405 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020406 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020406 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020406 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020407 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020407 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020407 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020408 key=5v5 len=12
DEBUG: get_game_intervals_cached HIT 2025020408 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020408 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020409 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020409 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020409 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020410 key=5v5 len=13
DEBUG: get_game_intervals_cached HIT 2025020410 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020410 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020411 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020411 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020411 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020412 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020412 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020412 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020413 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020413 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020413 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020414 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020414 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020414 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020415 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020415 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020415 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020416 key=5v5 len=12
DEBUG: get_game_intervals_cached HIT 2025020416 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020416 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020417 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020417 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020417 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020418 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020418 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020418 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020419 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020419 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020419 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020420 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020420 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020420 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020421 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020421 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020421 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020422 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020422 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020422 key=4v5 len=1
Processed intervals for 450/546 games...
DEBUG: get_game_intervals_cached HIT 2025020423 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020423 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020423 key=4v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020424 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020424 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020424 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020425 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020425 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020425 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020426 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020426 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020426 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020427 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020427 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020427 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020428 key=5v5 len=12
DEBUG: get_game_intervals_cached HIT 2025020428 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020428 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020429 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020429 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020429 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020430 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020430 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020430 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020431 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020431 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020431 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020432 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020432 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020432 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020433 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020433 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020433 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020434 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020434 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020434 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020435 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020435 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020435 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020436 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020436 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020436 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020437 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020437 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020437 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020438 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020438 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020438 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020439 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020439 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020439 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020440 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020440 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020440 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020441 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020441 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020441 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020442 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020442 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020442 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020443 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020443 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020443 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020444 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020444 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020444 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020445 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020445 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020445 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020446 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020446 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020446 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020447 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020447 key=5v4 len=7
DEBUG: get_game_intervals_cached HIT 2025020447 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020448 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020448 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020448 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020449 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020449 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020449 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020450 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020450 key=5v4 len=0
DEBUG: get_game_intervals_cached HIT 2025020450 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020451 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020451 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020451 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020452 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020452 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020452 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020453 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020453 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020453 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020454 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020454 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020454 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020455 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020455 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020455 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020456 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020456 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020456 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020457 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020457 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020457 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020458 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020458 key=5v4 len=0
DEBUG: get_game_intervals_cached HIT 2025020458 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020459 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020459 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020459 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020460 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020460 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020460 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020461 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020461 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020461 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020462 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020462 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020462 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020463 key=5v5 len=13
DEBUG: get_game_intervals_cached HIT 2025020463 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020463 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020464 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020464 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020464 key=4v5 len=0
DEBUG: get_game_intervals_cached HIT 2025020465 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020465 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020465 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020466 key=5v5 len=15
DEBUG: get_game_intervals_cached HIT 2025020466 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020466 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020467 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020467 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020467 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020468 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020468 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020468 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020469 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020469 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020469 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020470 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020470 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020470 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020471 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020471 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020471 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020472 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020472 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020472 key=4v5 len=2
Processed intervals for 500/546 games...
DEBUG: get_game_intervals_cached HIT 2025020473 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020473 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020473 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020474 key=5v5 len=15
DEBUG: get_game_intervals_cached HIT 2025020474 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020474 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020475 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020475 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020475 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020476 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020476 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020476 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020477 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020477 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020477 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020478 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020478 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020478 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020479 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020479 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020479 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020480 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020480 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020480 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020481 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020481 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020481 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020482 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020482 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020482 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020483 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020483 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020483 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020484 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020484 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020484 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020485 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020485 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020485 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020486 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020486 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020486 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020487 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020487 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020487 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020488 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020488 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020488 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020489 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020489 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020489 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020490 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020490 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020490 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020491 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020491 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020491 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020492 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020492 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020492 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020493 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020493 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020493 key=4v5 len=0
DEBUG: get_game_intervals_cached HIT 2025020494 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020494 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020494 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020495 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020495 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020495 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020496 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020496 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020496 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020497 key=5v5 len=11
DEBUG: get_game_intervals_cached HIT 2025020497 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020497 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020498 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020498 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020498 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020499 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020499 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020499 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020500 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020500 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020500 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020501 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020501 key=5v4 len=0
DEBUG: get_game_intervals_cached HIT 2025020501 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020502 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020502 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020502 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020503 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020503 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020503 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020504 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020504 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020504 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020505 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020505 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020505 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020506 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020506 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020506 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020507 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020507 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020507 key=4v5 len=4
DEBUG: get_game_intervals_cached MISS 2025020508 key=5v5 -> Computing
INFO:root:get_shifts: removed 3 zero-length shifts for game 2025020508
INFO:root:Saved shifts cache for game 2025020508 to data/20252026/shifts/shifts_2025020508.pkl
DEBUG: _get_shifts_df game=2025020508 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025020508 inter_sec=2988.0 conditions=['game_state', 'is_net_empty'] pooled=[3116.0, 3472.0]
DEBUG: get_game_intervals_cached MISS 2025020508 key=5v4 -> Computing
DEBUG: _get_shifts_df game=2025020508 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025020508 inter_sec=204.0 conditions=['game_state', 'is_net_empty'] pooled=[204.0, 3472.0]
DEBUG: get_game_intervals_cached MISS 2025020508 key=4v5 -> Computing
DEBUG: _get_shifts_df game=2025020508 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025020508 inter_sec=202.0 conditions=['game_state', 'is_net_empty'] pooled=[202.0, 3472.0]
DEBUG: get_game_intervals_cached MISS 2025020509 key=5v5 -> Computing
INFO:root:get_shifts: removed 9 zero-length shifts for game 2025020509
INFO:root:Saved shifts cache for game 2025020509 to data/20252026/shifts/shifts_2025020509.pkl
DEBUG: _get_shifts_df game=2025020509 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020509 inter_sec=2727.0 conditions=['game_state', 'is_net_empty'] pooled=[2789.0, 3580.0]
DEBUG: get_game_intervals_cached MISS 2025020509 key=5v4 -> Computing
DEBUG: _get_shifts_df game=2025020509 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020509 inter_sec=240.0 conditions=['game_state', 'is_net_empty'] pooled=[240.0, 3580.0]
DEBUG: get_game_intervals_cached MISS 2025020509 key=4v5 -> Computing
DEBUG: _get_shifts_df game=2025020509 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020509 inter_sec=571.0 conditions=['game_state', 'is_net_empty'] pooled=[571.0, 3580.0]
DEBUG: get_game_intervals_cached MISS 2025020510 key=5v5 -> Computing
INFO:root:get_shifts: removed 5 zero-length shifts for game 2025020510
INFO:root:Saved shifts cache for game 2025020510 to data/20252026/shifts/shifts_2025020510.pkl
DEBUG: _get_shifts_df game=2025020510 season=20252026
DEBUG: gs_timeline len=25
DEBUG: timing_result game=2025020510 inter_sec=2494.0 conditions=['game_state', 'is_net_empty'] pooled=[2569.0, 3825.0]
DEBUG: get_game_intervals_cached MISS 2025020510 key=5v4 -> Computing
DEBUG: _get_shifts_df game=2025020510 season=20252026
DEBUG: gs_timeline len=25
DEBUG: timing_result game=2025020510 inter_sec=431.0 conditions=['game_state', 'is_net_empty'] pooled=[431.0, 3825.0]
DEBUG: get_game_intervals_cached MISS 2025020510 key=4v5 -> Computing
DEBUG: _get_shifts_df game=2025020510 season=20252026
DEBUG: gs_timeline len=25
DEBUG: timing_result game=2025020510 inter_sec=378.0 conditions=['game_state', 'is_net_empty'] pooled=[378.0, 3825.0]
DEBUG: get_game_intervals_cached MISS 2025020511 key=5v5 -> Computing
INFO:root:get_shifts: removed 8 zero-length shifts for game 2025020511
INFO:root:Saved shifts cache for game 2025020511 to data/20252026/shifts/shifts_2025020511.pkl
DEBUG: _get_shifts_df game=2025020511 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025020511 inter_sec=3017.0 conditions=['game_state', 'is_net_empty'] pooled=[3023.0, 3594.0]
DEBUG: get_game_intervals_cached MISS 2025020511 key=5v4 -> Computing
DEBUG: _get_shifts_df game=2025020511 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025020511 inter_sec=337.0 conditions=['game_state', 'is_net_empty'] pooled=[337.0, 3594.0]
DEBUG: get_game_intervals_cached MISS 2025020511 key=4v5 -> Computing
DEBUG: _get_shifts_df game=2025020511 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025020511 inter_sec=240.0 conditions=['game_state', 'is_net_empty'] pooled=[240.0, 3594.0]
DEBUG: get_game_intervals_cached MISS 2025020512 key=5v5 -> Computing
INFO:root:get_shifts: removed 5 zero-length shifts for game 2025020512
INFO:root:Saved shifts cache for game 2025020512 to data/20252026/shifts/shifts_2025020512.pkl
DEBUG: _get_shifts_df game=2025020512 season=20252026
DEBUG: gs_timeline len=23
DEBUG: timing_result game=2025020512 inter_sec=2583.0 conditions=['game_state', 'is_net_empty'] pooled=[2873.0, 3310.0]
DEBUG: get_game_intervals_cached MISS 2025020512 key=5v4 -> Computing
DEBUG: _get_shifts_df game=2025020512 season=20252026
DEBUG: gs_timeline len=23
DEBUG: timing_result game=2025020512 inter_sec=318.0 conditions=['game_state', 'is_net_empty'] pooled=[318.0, 3310.0]
DEBUG: get_game_intervals_cached MISS 2025020512 key=4v5 -> Computing
DEBUG: _get_shifts_df game=2025020512 season=20252026
DEBUG: gs_timeline len=23
DEBUG: timing_result game=2025020512 inter_sec=289.0 conditions=['game_state', 'is_net_empty'] pooled=[289.0, 3310.0]
DEBUG: get_game_intervals_cached MISS 2025020513 key=5v5 -> Computing
INFO:root:get_shifts: removed 4 zero-length shifts for game 2025020513
INFO:root:Saved shifts cache for game 2025020513 to data/20252026/shifts/shifts_2025020513.pkl
DEBUG: _get_shifts_df game=2025020513 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025020513 inter_sec=3086.0 conditions=['game_state', 'is_net_empty'] pooled=[3114.0, 3572.0]
DEBUG: get_game_intervals_cached MISS 2025020513 key=5v4 -> Computing
DEBUG: _get_shifts_df game=2025020513 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025020513 inter_sec=246.0 conditions=['game_state', 'is_net_empty'] pooled=[246.0, 3572.0]
DEBUG: get_game_intervals_cached MISS 2025020513 key=4v5 -> Computing
DEBUG: _get_shifts_df game=2025020513 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025020513 inter_sec=240.0 conditions=['game_state', 'is_net_empty'] pooled=[240.0, 3572.0]
DEBUG: get_game_intervals_cached MISS 2025020514 key=5v5 -> Computing
INFO:root:get_shifts: removed 7 zero-length shifts for game 2025020514
INFO:root:Saved shifts cache for game 2025020514 to data/20252026/shifts/shifts_2025020514.pkl
DEBUG: _get_shifts_df game=2025020514 season=20252026
DEBUG: gs_timeline len=18
DEBUG: timing_result game=2025020514 inter_sec=2608.0 conditions=['game_state', 'is_net_empty'] pooled=[2612.0, 3596.0]
DEBUG: get_game_intervals_cached MISS 2025020514 key=5v4 -> Computing
DEBUG: _get_shifts_df game=2025020514 season=20252026
DEBUG: gs_timeline len=18
DEBUG: timing_result game=2025020514 inter_sec=600.0 conditions=['game_state', 'is_net_empty'] pooled=[600.0, 3596.0]
DEBUG: get_game_intervals_cached MISS 2025020514 key=4v5 -> Computing
DEBUG: _get_shifts_df game=2025020514 season=20252026
DEBUG: gs_timeline len=18
DEBUG: timing_result game=2025020514 inter_sec=388.0 conditions=['game_state', 'is_net_empty'] pooled=[388.0, 3596.0]
DEBUG: get_game_intervals_cached MISS 2025020515 key=5v5 -> Computing
INFO:root:get_shifts: removed 5 zero-length shifts for game 2025020515
INFO:root:Saved shifts cache for game 2025020515 to data/20252026/shifts/shifts_2025020515.pkl
DEBUG: _get_shifts_df game=2025020515 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020515 inter_sec=2734.0 conditions=['game_state', 'is_net_empty'] pooled=[2793.0, 3541.0]
DEBUG: get_game_intervals_cached MISS 2025020515 key=5v4 -> Computing
DEBUG: _get_shifts_df game=2025020515 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020515 inter_sec=426.0 conditions=['game_state', 'is_net_empty'] pooled=[426.0, 3541.0]
DEBUG: get_game_intervals_cached MISS 2025020515 key=4v5 -> Computing
DEBUG: _get_shifts_df game=2025020515 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020515 inter_sec=349.0 conditions=['game_state', 'is_net_empty'] pooled=[349.0, 3541.0]
DEBUG: get_game_intervals_cached MISS 2025020516 key=5v5 -> Computing
INFO:root:get_shifts: removed 5 zero-length shifts for game 2025020516
INFO:root:Saved shifts cache for game 2025020516 to data/20252026/shifts/shifts_2025020516.pkl
DEBUG: _get_shifts_df game=2025020516 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020516 inter_sec=2957.0 conditions=['game_state', 'is_net_empty'] pooled=[3000.0, 3688.0]
DEBUG: get_game_intervals_cached MISS 2025020516 key=5v4 -> Computing
DEBUG: _get_shifts_df game=2025020516 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020516 inter_sec=240.0 conditions=['game_state', 'is_net_empty'] pooled=[240.0, 3688.0]
DEBUG: get_game_intervals_cached MISS 2025020516 key=4v5 -> Computing
DEBUG: _get_shifts_df game=2025020516 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020516 inter_sec=360.0 conditions=['game_state', 'is_net_empty'] pooled=[360.0, 3688.0]
DEBUG: get_game_intervals_cached MISS 2025020517 key=5v5 -> Computing
INFO:root:get_shifts: removed 7 zero-length shifts for game 2025020517
INFO:root:Saved shifts cache for game 2025020517 to data/20252026/shifts/shifts_2025020517.pkl
DEBUG: _get_shifts_df game=2025020517 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025020517 inter_sec=2852.0 conditions=['game_state', 'is_net_empty'] pooled=[2873.0, 3579.0]
DEBUG: get_game_intervals_cached MISS 2025020517 key=5v4 -> Computing
DEBUG: _get_shifts_df game=2025020517 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025020517 inter_sec=285.0 conditions=['game_state', 'is_net_empty'] pooled=[285.0, 3579.0]
DEBUG: get_game_intervals_cached MISS 2025020517 key=4v5 -> Computing
DEBUG: _get_shifts_df game=2025020517 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025020517 inter_sec=442.0 conditions=['game_state', 'is_net_empty'] pooled=[442.0, 3579.0]
DEBUG: get_game_intervals_cached MISS 2025020518 key=5v5 -> Computing
INFO:root:get_shifts: removed 5 zero-length shifts for game 2025020518
INFO:root:Saved shifts cache for game 2025020518 to data/20252026/shifts/shifts_2025020518.pkl
DEBUG: _get_shifts_df game=2025020518 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025020518 inter_sec=2431.0 conditions=['game_state', 'is_net_empty'] pooled=[3027.0, 2986.0]
DEBUG: get_game_intervals_cached MISS 2025020518 key=5v4 -> Computing
DEBUG: _get_shifts_df game=2025020518 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025020518 inter_sec=237.0 conditions=['game_state', 'is_net_empty'] pooled=[237.0, 2986.0]
DEBUG: get_game_intervals_cached MISS 2025020518 key=4v5 -> Computing
DEBUG: _get_shifts_df game=2025020518 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025020518 inter_sec=312.0 conditions=['game_state', 'is_net_empty'] pooled=[330.0, 2986.0]
Config: Mode=aggressive, Workers=1, Platform=Pi
--- Processing Cache for 20252026 [5v5] ---
Using Partial Cache Dir: /ssd/new_puck/data/cache/20252026/partials
Loaded season dataframe from data/20252026/20252026_df.csv -> shape=(9449, 25)
INFO:root:Loaded cached shifts for game 2025010008 from data/20252026/shifts/shifts_2025010008.pkl
Found 37 games to process out of 37 total.
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010008 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025010008 key=5v5 len=10
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=10 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 156 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(2)} team=np.int64(2)
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=10 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 156 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=461.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 710.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=9 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 39 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485378), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=513.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 673.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 38 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=1757.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 2001.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=4 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 120 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479496), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=884.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1257.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=19 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476429), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=730.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1178.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=16 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475151), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=878.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1210.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=1035.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1529.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=606.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1005.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=11 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481569), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=494.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 965.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485409), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=916.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1421.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=577.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 813.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482727), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=479.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 834.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=10 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 36 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=521.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1088.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=745.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 963.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=15 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475314), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=342.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1446.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 25 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484147), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=579.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1141.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=13 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477494), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=576.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1361.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=13 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477500), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=732.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1083.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=16 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484287), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=465.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 899.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=10 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 36 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478146), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=722.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1090.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484804), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=566.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1008.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=14 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485702), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=559.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1109.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=450.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 796.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 32 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=507.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 565.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=10 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 38 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485462), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=618.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1182.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 35 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=1026.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1462.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=1911.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 2396.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 131 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482783), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=550.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1899.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=9 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480481), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=736.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1089.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=17 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485352), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=746.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1189.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=536.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 549.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=10 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481003), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=435.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 789.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=9 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 36 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482154), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=809.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1340.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=16 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478445), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=458.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 686.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=10 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 36 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483697), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=536.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 970.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=192.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 192.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 16 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478967), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=977.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1479.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=20 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485366), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=471.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 483.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=10 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 35 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485370), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=869.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1389.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=720.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2939.0, 3017.0, 1521.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025010026 from data/20252026/shifts/shifts_2025010026.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=17 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477950), 'team': 2} team=2
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010026 key=5v5 len=14
DEBUG: get_game_intervals_cached HIT 2025010026 key=5v5 len=14
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=14 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 185 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(8)} team=np.int64(8)
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 185 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=921.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1286.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=21 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483457), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=767.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1039.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=17 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478851), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=698.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 904.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=16 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481540), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=474.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1200.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=10 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 33 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=638.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1139.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=504.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 671.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=10 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485392), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=725.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1220.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=630.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 853.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=16 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480018), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=644.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 929.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483731), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=759.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1103.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=16 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482964), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=674.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 868.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=16 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478104), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=770.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1153.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=15 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484220), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=689.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1198.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=1113.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1215.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 98 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478502), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=840.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1312.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=20 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482087), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=596.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 940.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=662.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1216.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=578.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 802.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=759.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1087.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=16 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480813), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=540.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 884.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 38 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483760), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=505.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 788.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=12 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482737), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=580.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 904.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=15 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483507), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=535.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 829.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=11 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 42 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484403), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=744.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 966.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=15 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484533), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=969.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1857.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=12 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482487), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=525.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 704.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 39 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481848), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=491.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 720.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=13 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483515), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=477.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 757.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=13 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482749), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=527.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 697.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 42 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484928), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=650.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 791.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478409), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=531.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 919.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482890), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=502.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 928.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=14 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481618), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=721.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1099.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=790.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1226.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=18 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481110), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=1448.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1743.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=5 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 116 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478039), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=643.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 862.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=13 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482134), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=1943.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 2349.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 153 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482783), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=498.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 737.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=804.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1220.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482169), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=1140.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3143.0, 2874.0, 1550.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025010036 from data/20252026/shifts/shifts_2025010036.pkl
INFO:root:Loaded cached shifts for game 2025010047 from data/20252026/shifts/shifts_2025010047.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 92 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025010036 season=20252026
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010047 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025010047 key=5v5 len=7
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 193 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=7 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 193 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(6)} team=np.int64(6)
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=581.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 838.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=12 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482177), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=848.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 955.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=15 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479362), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=883.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1154.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=2781.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 3400.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=9 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 193 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=672.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1042.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=590.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 678.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483731), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=708.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 805.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=14 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481556), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=686.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 730.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=2781.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=9 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 193 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480022), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=961.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1303.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=19 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480035), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=789.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1206.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=738.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1020.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=692.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 829.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=14 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482213), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=664.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 801.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=737.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 999.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=641.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 657.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=825.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1281.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=15 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476854), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=607.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 676.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481848), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=677.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 902.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=13 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477887), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=770.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1049.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=14 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478401), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=931.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1209.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=16 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481219), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=941.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1056.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=19 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483017), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=739.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 839.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=1015.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1179.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=15 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482511), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=972.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1168.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=761.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1030.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=16 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476374), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=591.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 642.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=14 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479705), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=934.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1348.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=709.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 931.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=14 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480355), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=700.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1132.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=724.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 893.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=15 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479591), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=938.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1116.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=670.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 837.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=13 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483567), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=893.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1072.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=17 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480887), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=608.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 771.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=13 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485496), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=941.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482169), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=896.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1227.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=778.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2884.0, 3400.0, 1168.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025010063 from data/20252026/shifts/shifts_2025010063.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010063 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025010063 key=5v5 len=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=6 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 187 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(6)} team=np.int64(6)
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 187 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=933.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1175.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=18 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477956), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=945.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1244.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=20 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479369), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=910.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1185.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=808.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1061.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=2995.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=8 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 187 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480280), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=1079.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1478.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=697.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 818.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=13 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483489), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=1083.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1220.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478502), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=784.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1155.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=687.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 776.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=13 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479661), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=649.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 775.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=614.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 913.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=670.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 794.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=15 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 38 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481712), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=677.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 793.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=12 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 42 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483505), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=884.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 913.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483760), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=857.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1227.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=19 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476854), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=847.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1074.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=17 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477496), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=733.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 775.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481848), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=683.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1029.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=12 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 36 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478401), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=1212.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1544.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=21 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477507), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=734.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 910.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478409), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=650.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 730.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=12 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482634), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=836.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 854.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=19 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483017), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=789.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1122.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=727.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 833.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=682.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 930.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=14 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476374), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=727.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 894.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=15 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478042), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=842.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1220.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=1168.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1537.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=22 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479325), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=975.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 987.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=19 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482399), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=649.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 684.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=2995.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 3895.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 187 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=1185.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1378.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=848.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1259.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=652.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 764.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483697), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=941.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1113.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=17 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479987), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=1005.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1137.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=788.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3895.0, 1021.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025010083 from data/20252026/shifts/shifts_2025010083.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=14 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479999), 'team': 6} team=6
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010083 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025010083 key=5v5 len=5
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 184 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=5 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 184 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(2)} team=np.int64(2)
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=831.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 903.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=17 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476419), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=1143.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1410.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=3104.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 3502.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 184 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=1123.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=22 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476429), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=818.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 883.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=782.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 884.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=847.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 847.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=943.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 977.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=467.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 584.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=10 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 32 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484221), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=870.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 954.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=729.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 829.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=684.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 879.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=15 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482476), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=823.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1028.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=910.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1136.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=18 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475314), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=3104.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=7 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 184 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478009), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=856.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1044.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=18 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481601), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=935.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1024.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=24 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477506), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=877.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1001.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=18 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485702), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=543.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 624.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=956.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1088.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=682.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 728.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=14 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481237), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=693.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 845.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=1176.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1276.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=709.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 891.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=15 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477407), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=735.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 812.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=15 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475231), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=664.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 734.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=14 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483553), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=905.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1051.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=17 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484958), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=599.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 599.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=882.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1124.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=1057.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1169.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=24 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480871), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=890.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1047.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=977.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1218.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=19 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478445), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=759.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 953.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=866.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 982.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=23 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476917), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=1243.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1310.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=26 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 89 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481014), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=999.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1212.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=21 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485366), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=1124.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1343.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=943.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3202.0, 3502.0, 1077.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025010094 from data/20252026/shifts/shifts_2025010094.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010094 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025010094 key=5v5 len=6
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 223 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=6 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 223 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(1)} team=np.int64(1)
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=747.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 757.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=17 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483841), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=969.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1312.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=19 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481032), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=812.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 812.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=18 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484616), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=1197.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1528.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 101 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=1018.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1127.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=21 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 92 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483085), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=956.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1097.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=741.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 896.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=1058.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1230.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=23 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482194), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=812.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 812.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=860.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 974.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=19 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476822), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=1115.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1312.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=25 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479395), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=848.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1126.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=888.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1081.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=744.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 754.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=797.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1105.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=590.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 590.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=842.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1071.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=18 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481721), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=804.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 848.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=17 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481594), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=751.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 950.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=19 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479291), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=1033.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1145.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=22 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 93 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482873), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=787.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 797.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=17 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481731), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=655.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 655.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=15 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480836), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=630.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 640.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=16 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482635), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=681.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 716.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=846.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1086.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=20 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484177), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=1134.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1229.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=23 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480467), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=1166.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1218.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=750.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 849.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=1221.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1478.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=3226.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 3873.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 223 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=3226.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 3890.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=7 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 223 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474596), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=917.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1159.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=881.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 881.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=1126.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1408.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=24 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480884), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=943.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1329.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=20 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482941), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=777.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 777.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=1225.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1528.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 98 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=939.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3863.0, 1165.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020012 from data/20252026/shifts/shifts_2025020012.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020012 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020012 key=5v5 len=6
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=6 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 217 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(13)} team=np.int64(13)
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 217 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=706.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 746.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=20 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480003), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=1284.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1423.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=28 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 112 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478859), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=673.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 862.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=836.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 959.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=768.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 935.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=18 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482713), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=890.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 892.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=2832.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 3564.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=8 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 217 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475683), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=804.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1026.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=18 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8473507), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=902.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 980.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=805.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 894.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=362.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 467.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=10 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 36 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475179), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=856.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=425.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 485.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=10 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=959.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1329.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=21 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477495), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=852.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 986.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=21 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480185), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=780.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1046.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=21 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482113), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=768.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1174.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=20 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8473419), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=786.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 958.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=20 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478542), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=452.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 587.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=955.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1281.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=483.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 483.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=10 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478421), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=487.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 487.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=11 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479316), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=783.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1001.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=1114.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1374.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 104 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=741.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 958.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=19 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477409), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=448.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 451.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=2832.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 3526.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 217 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=1230.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1404.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=28 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 94 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478055), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=670.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 992.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=844.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1041.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=1029.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1400.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=24 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477932), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=857.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1321.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=20 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477933), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=487.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 487.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=10 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479981), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=777.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1166.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=18 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477935), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=852.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1035.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=755.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 866.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=1113.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 1635.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=787.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2916.0, 3490.0, 957.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020030 from data/20252026/shifts/shifts_2025020030.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020030 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020030 key=5v5 len=8
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=8 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 253 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(12)} team=np.int64(12)
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 253 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=2869.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 3883.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=10 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 253 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=771.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1099.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=20 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482702), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=565.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 808.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=14 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475791), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=885.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1089.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=805.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1064.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=516.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 516.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=1006.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1006.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 88 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=910.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1008.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=21 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 94 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476958), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=429.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 476.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=11 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480762), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=675.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 807.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=843.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1121.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=682.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 682.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=18 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477478), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=460.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 460.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=9 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=826.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1205.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 95 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=825.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1250.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=17 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482093), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=1129.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1556.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=25 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 108 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480817), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=918.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1008.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=22 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 92 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482100), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=770.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 890.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=19 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8473533), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=560.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 626.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=12 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480829), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=709.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1016.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=17 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480830), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=465.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 632.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=956.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1380.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=23 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 98 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480336), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=1108.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1376.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=28 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 117 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=797.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1235.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=16 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478427), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=708.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 980.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=853.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1167.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=20 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 90 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482809), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=1112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1388.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 96 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=689.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1009.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=816.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1225.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=19 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476906), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=2869.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 3881.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=10 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 253 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475883), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=670.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 861.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=768.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1057.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 85 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=826.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1199.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=17 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477940), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=646.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 862.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=724.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 822.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=19 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476921), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=1105.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1155.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=26 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 114 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478970), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=1202.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1774.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=31 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 135 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=961.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2871.0, 3881.0, 1162.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020044 from data/20252026/shifts/shifts_2025020044.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020044 key=5v5 len=12
DEBUG: get_game_intervals_cached HIT 2025020044 key=5v5 len=12
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 174 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=12 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 174 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(13)} team=np.int64(13)
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=556.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 558.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=15 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480003), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=929.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1251.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=22 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478859), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=528.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 892.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=690.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 983.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=629.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 637.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=637.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 795.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=15 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482713), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=686.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 966.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=20 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8473507), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=538.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 896.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=704.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1045.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=529.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 529.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=674.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1001.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=831.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1438.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=18 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477495), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=525.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 968.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=13 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480185), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=2378.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 3478.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=13 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 174 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480193), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=560.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 927.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=16 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482113), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=597.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1075.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=14 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8473419), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=813.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 993.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=17 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478542), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=541.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 634.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=622.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 622.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=588.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 591.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=16 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484304), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=857.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1359.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=476.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 486.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=10 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 32 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478421), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=436.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 854.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=12 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 39 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479316), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=524.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1013.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 42 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=964.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1359.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=786.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1049.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=18 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477409), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=2378.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 174 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=952.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1399.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=22 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478055), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=627.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1142.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=1003.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1233.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=767.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1415.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=19 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477932), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=657.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1227.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=14 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477933), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=411.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 413.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=9 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 32 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479981), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=683.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1117.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=18 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477935), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=606.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1016.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=469.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 633.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=856.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 1496.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=529.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2500.0, 3478.0, 955.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020066 from data/20252026/shifts/shifts_2025020066.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
Processed 10/37 (0.04 games/s)
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020066 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020066 key=5v5 len=7
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 174 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=7 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 174 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(52)} team=np.int64(52)
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=889.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 945.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=21 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8473604), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=1241.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1352.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=30 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=3154.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 3538.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=9 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 174 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=982.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1006.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=20 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480014), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=727.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 980.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=884.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1058.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=1171.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1346.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=26 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480145), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=3154.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=9 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 174 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476945), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=553.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 687.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=16 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481043), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=697.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 697.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=1143.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1143.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=24 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479378), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=890.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 890.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=20 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475799), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=601.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 678.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=15 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480289), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=898.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1128.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=772.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 796.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=595.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 655.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=14 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484135), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=640.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 640.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=1208.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1397.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=28 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476331), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=935.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1191.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=1006.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1124.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=20 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476460), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=783.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 783.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=19 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474679), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=1001.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1127.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=19 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478398), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=702.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 860.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=18 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476480), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=1269.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1461.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=23 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477504), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=727.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 845.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=19 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476871), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=859.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 951.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=22 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474568), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=640.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 640.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=1205.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1205.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=28 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=737.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 918.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=1276.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1448.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=869.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1092.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=736.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 740.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=775.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 969.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=714.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 843.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=20 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480113), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=677.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 899.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=20 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477938), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=654.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 660.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=1203.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1475.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=29 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=881.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3216.0, 3538.0, 1049.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020081 from data/20252026/shifts/shifts_2025020081.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020081 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020081 key=5v5 len=6
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 213 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=6 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 213 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(30)} team=np.int64(30)
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=748.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 805.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=14 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483460), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=1303.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1570.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=875.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 935.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=16 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477451), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=860.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 981.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=16 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475149), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=924.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1119.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=994.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1385.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=16 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478864), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=980.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1078.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=953.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1405.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=16 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481557), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=674.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 674.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=798.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1314.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=12 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478493), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=814.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1081.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=16 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482079), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=586.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 727.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=853.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 916.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=653.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 653.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=11 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478508), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=890.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1239.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=413.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 413.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=10 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 35 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=1212.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1329.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=25 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 92 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476463), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=945.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1070.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=21 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 86 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478136), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=886.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1204.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=15 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484798), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=616.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 641.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=12 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476994), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=627.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 627.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=12 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483525), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=1180.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1421.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=24 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 89 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482122), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=511.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 570.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 36 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=938.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1086.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=613.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 714.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=13 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475220), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=902.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1160.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=1042.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1219.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=20 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474716), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=1070.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1295.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=294.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 294.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 28 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=3000.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 3757.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 213 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=3000.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 3757.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=6 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 213 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482661), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=871.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1228.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=449.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 449.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=10 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 31 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475752), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=933.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1214.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=735.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 998.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=13 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475765), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=558.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 728.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=1483.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1798.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=28 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 93 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=817.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3000.0, 3757.0, 1002.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020094 from data/20252026/shifts/shifts_2025020094.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020094 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020094 key=5v5 len=10
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=10 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 172 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=10 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 172 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(55)} team=np.int64(55)
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=506.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 892.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=13 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480009), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=588.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1309.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=506.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 998.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=14 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479372), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=593.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1001.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=604.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 827.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=238.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 458.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 27 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=633.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 963.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=542.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 975.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=445.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 785.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=943.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1233.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=18 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476457), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=404.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 911.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=12 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 38 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483497), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=377.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 523.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=9 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=603.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1136.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=562.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1103.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=14 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476467), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=271.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1200.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=4 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 13 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475831), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=418.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 715.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=12 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 34 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482751), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=665.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 829.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=14 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484800), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=1779.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 2370.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=7 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 159 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478916), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=468.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 890.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=13 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483524), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=993.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1523.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=19 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478407), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=318.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 568.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=9 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 39 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=354.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 676.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=11 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 28 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481789), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=719.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1264.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=371.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 703.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=11 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 31 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477401), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=714.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1153.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=16 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474586), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=564.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1004.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=593.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 930.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=13 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479324), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=670.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1051.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=2050.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 3539.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 172 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=668.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1067.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=468.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1077.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=12 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476905), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=745.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1205.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=16 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482665), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=656.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1056.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=505.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1032.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=15 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479985), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=648.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1023.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=543.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 817.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=15 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475768), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=857.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 1447.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 85 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=527.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 951.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=492.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 2729.0, 971.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020112 from data/20252026/shifts/shifts_2025020112.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=14 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478975), 'team': 55} team=55
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020112 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020112 key=5v5 len=8
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=8 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 178 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(9)} team=np.int64(9)
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 178 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=1037.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1615.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=25 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478469), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=943.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1546.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=848.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1063.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=715.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 848.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=432.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 432.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=10 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=646.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 679.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=602.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 890.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=583.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 965.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=707.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1131.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=19 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8473512), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=661.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1074.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=18 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482092), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=814.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1273.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=366.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 366.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 36 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=676.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 733.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=15 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482095), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=798.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1363.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=23 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482105), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=409.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 553.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=8 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 22 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480188), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=1003.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1244.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=24 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475324), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=803.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1372.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=22 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481596), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=768.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 863.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=20 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478020), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=687.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1126.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=18 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482116), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=830.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1034.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=22 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482245), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=2500.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=9 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 178 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476999), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=386.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 704.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=7 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 24 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474189), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=305.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 506.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 30 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=632.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 897.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=17 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480208), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=881.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1069.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=644.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 985.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=1102.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1433.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=653.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 655.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=17 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484321), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=2500.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 3492.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=9 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 178 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=862.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1283.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=637.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 637.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=16 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476393), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=674.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1027.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=456.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 457.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=7 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 26 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480245), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=680.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1009.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=18 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474102), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=517.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 711.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 39 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=677.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1053.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=18 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481528), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=920.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 1451.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 90 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=646.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2595.0, 3492.0, 861.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020127 from data/20252026/shifts/shifts_2025020127.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020127 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020127 key=5v5 len=6
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 240 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=6 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 240 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(2)} team=np.int64(2)
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=558.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 820.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=18 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476419), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=1239.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1642.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 100 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=3047.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 240 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=1040.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1178.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=24 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476429), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=872.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1079.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=923.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1222.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=20 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475151), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=874.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1120.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=455.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 455.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=680.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 680.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=17 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481569), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=787.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 929.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=914.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 959.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 99 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=1013.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1169.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=22 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482476), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=901.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1156.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=407.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 407.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=668.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 761.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=17 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475314), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=1000.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1209.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=21 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477494), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=3047.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=8 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 240 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478009), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=1060.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1441.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=23 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477500), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=623.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 924.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=18 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481601), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=1175.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1410.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=28 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 107 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477506), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=395.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 413.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=935.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1066.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=471.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 475.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=13 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481237), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=736.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1154.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=1120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1355.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=501.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 506.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=15 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484958), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=891.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 977.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=21 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477407), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=437.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 495.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=14 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475231), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=986.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1259.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=692.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 727.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=973.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1292.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=20 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478445), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=912.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1364.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=1112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1339.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=28 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 101 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476917), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=716.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 825.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=1180.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1660.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=25 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 95 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485366), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=1406.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1627.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=30 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 122 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=888.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1123.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=930.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3047.0, 3900.0, 1029.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020150 from data/20252026/shifts/shifts_2025020150.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=22 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 90 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477950), 'team': 2} team=2
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020150 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020150 key=5v5 len=7
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 212 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=7 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 212 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(5)} team=np.int64(5)
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=2968.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=8 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 212 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481668), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=861.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1061.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=17 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478854), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=1224.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1698.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=31 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 92 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=2968.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 3884.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 212 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=789.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 927.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=868.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1071.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=818.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 902.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=18 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479638), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=714.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 714.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=900.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1413.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=21 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475810), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=755.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 889.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=748.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 889.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=685.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 767.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=15 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485414), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=1060.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1270.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=21 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8471724), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=825.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1142.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=533.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 533.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=787.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 792.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=20 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483503), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=794.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1222.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=18 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8471215), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=869.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 873.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=20 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476856), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=622.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 698.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=15 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482758), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=842.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1130.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=17 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477511), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=626.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 848.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=15 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481481), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=919.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 946.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=20 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480842), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=528.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 579.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=1248.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1902.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=19 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474578), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=1086.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1233.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=539.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 681.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=13 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480980), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=822.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1294.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=1118.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1293.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 92 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=562.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 562.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=10 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 42 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=601.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 668.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=14 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478438), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=809.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1048.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=605.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 790.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=14 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478569), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=827.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1220.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=1140.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1415.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=18 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478450), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=568.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 774.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=924.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1395.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=21 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8471675), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=1245.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1689.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=28 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 97 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=819.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2968.0, 3884.0, 1132.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020170 from data/20252026/shifts/shifts_2025020170.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020170 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020170 key=5v5 len=5
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 228 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=5 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 228 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(18)} team=np.int64(18)
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=715.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 726.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=16 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477446), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=1212.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1432.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=767.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 787.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=17 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482062), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=891.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 990.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=1000.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1049.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=717.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 761.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=17 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484241), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=755.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1031.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=16 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475158), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=872.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 931.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=20 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475287), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=1008.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1031.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=19 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481056), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=872.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 872.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=825.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 965.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=226.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 317.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 17 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=861.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 869.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=864.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 881.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=17 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482103), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=1034.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1057.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=19 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 82 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482111), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=829.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1080.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=17 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474564), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=1127.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1298.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=22 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476869), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=906.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 906.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=588.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 648.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=838.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 914.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=17 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482768), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=1023.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1260.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=716.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1000.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=15 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476887), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=903.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1003.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=1108.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1236.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 86 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=813.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 937.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=18 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478047), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=944.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1048.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=19 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482146), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=457.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 465.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=9 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 29 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3179.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 3592.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 228 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=885.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1065.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=1089.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1138.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=22 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479980), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=1023.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1252.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=22 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483565), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=899.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1025.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3179.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 3511.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=6 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 228 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477424), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=855.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 936.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=1074.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1142.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=21 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480246), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=710.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 952.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=17 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476539), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=1281.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1483.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 101 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=1103.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3237.0, 3503.0, 1127.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020188 from data/20252026/shifts/shifts_2025020188.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020188 key=5v5 len=12
DEBUG: get_game_intervals_cached HIT 2025020188 key=5v5 len=12
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 180 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=12 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 180 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(10)} team=np.int64(10)
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=679.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1105.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=20 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476931), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=2205.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=14 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 180 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476932), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=906.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1439.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=607.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1028.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=655.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 965.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=539.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 644.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=474.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 609.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=12 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478104), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=458.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 743.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=671.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1021.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=15 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475166), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=616.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1204.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=14 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482720), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=763.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1008.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=19 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475171), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=528.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 952.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=678.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1239.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=555.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 890.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=18 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475690), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=435.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 668.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=648.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 920.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=15 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481582), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=540.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 765.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=11 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481711), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=798.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1197.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=19 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476853), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=411.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 669.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481848), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=499.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 759.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=12 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484158), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=473.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 734.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=12 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477503), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=406.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 668.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=12 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475714), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=381.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 681.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 39 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=517.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 703.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=14 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482259), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=792.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1018.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=606.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1219.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=17 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479318), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=546.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 987.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=720.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1088.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=204.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 15 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482783), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=765.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1262.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=19 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481122), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=1953.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 2433.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 162 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=601.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1120.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=607.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 868.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=15 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478057), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=867.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1440.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=24 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478443), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=594.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1097.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=443.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 856.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=1090.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1447.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=29 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=689.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1225.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=541.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2623.0, 2882.0, 1011.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020196 from data/20252026/shifts/shifts_2025020196.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=13 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 42 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478462), 'team': 10} team=10
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020196 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020196 key=5v5 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 216 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=3 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 216 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(20)} team=np.int64(20)
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=1222.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1418.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 102 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=808.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=615.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 689.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=18 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481167), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=739.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 825.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=687.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 726.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=465.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 465.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=11 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 36 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483609), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=770.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 770.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=985.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1037.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=21 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482074), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=825.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1033.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=19 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480028), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=990.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1122.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=21 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480797), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=3115.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 3560.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=4 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 216 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481692), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=641.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 779.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=20 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484768), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=1257.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1559.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=31 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 90 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477346), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=695.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 821.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=875.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1080.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=19 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475172), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=882.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1075.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=880.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1051.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=22 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474150), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=856.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1107.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=20 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476456), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=531.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 637.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=13 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481068), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=888.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1171.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=632.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 645.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=526.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 526.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481848), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=1240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1313.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=32 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 102 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478397), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=518.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 549.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=1130.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1276.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=818.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 884.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=21 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484180), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=457.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 457.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=11 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 29 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479066), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=832.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1032.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=1325.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1395.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=30 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 98 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480860), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=1233.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1314.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 88 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=3115.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 3492.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 216 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482783), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=1055.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1300.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=903.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1050.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=19 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476399), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=1176.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1321.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=30 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477810), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=620.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 735.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=736.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=18 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482679), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=1267.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1500.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 103 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=1071.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3263.0, 3452.0, 1244.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020204 from data/20252026/shifts/shifts_2025020204.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020204 key=5v5 len=10
DEBUG: get_game_intervals_cached HIT 2025020204 key=5v5 len=10
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=10 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 223 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(8)} team=np.int64(8)
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=10 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 223 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=978.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1403.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=21 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483457), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=806.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1135.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=20 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478851), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=872.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1226.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=19 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481540), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=2782.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=12 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 223 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478470), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=973.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1547.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 103 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=865.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1284.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=610.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 925.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=859.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1287.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=19 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480018), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=578.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 638.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=14 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482964), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=581.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 581.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=648.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 928.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=960.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1436.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=742.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1188.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=670.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 675.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=16 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480813), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=640.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 771.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=15 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482737), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=653.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 899.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=17 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476981), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=642.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 986.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=16 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478133), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=383.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 383.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481848), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=900.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 903.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=19 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481593), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=870.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1109.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=18 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483515), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=628.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 711.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=15 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475848), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=1179.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1671.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=29 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 117 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476875), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=613.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 643.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=565.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 638.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=639.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 979.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=13 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481618), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=1064.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1141.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=28 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=620.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 796.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=12 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482775), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=782.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1124.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=1155.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1544.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=28 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=1124.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1438.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=28 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 116 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480865), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=384.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 384.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=2782.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 3895.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 223 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=886.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1286.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=669.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 809.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=16 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481523), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=585.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 649.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 39 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=583.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 921.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=12 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 39 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484984), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=1190.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1506.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 114 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=924.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2787.0, 3895.0, 1404.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020223 from data/20252026/shifts/shifts_2025020223.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
Processed 20/37 (0.04 games/s)
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020223 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020223 key=5v5 len=6
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=6 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 246 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(18)} team=np.int64(18)
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 246 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=694.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 762.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=14 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477446), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=677.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 738.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=15 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479370), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=1177.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1495.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 115 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=925.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1043.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=647.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 835.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=15 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484241), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=854.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 954.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 82 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=506.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 506.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=832.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1134.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=18 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475158), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=752.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1054.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=16 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475287), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=785.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 851.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=19 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481056), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=718.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 772.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=860.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1120.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=977.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=566.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 587.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=658.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 685.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=14 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482103), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=936.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 936.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=20 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482111), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=883.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1123.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=14 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474564), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=1035.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1265.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=26 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 97 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476869), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=675.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 675.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=599.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 673.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=657.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 657.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=14 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482768), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=1079.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1313.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=834.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1163.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=19 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476887), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=655.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=1148.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=679.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 854.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=14 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478047), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=889.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1163.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=17 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482146), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=602.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 602.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=3006.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 246 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=819.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1123.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=1170.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1300.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=20 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 106 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479980), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=1079.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1390.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=21 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 97 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483565), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=3006.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 3486.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=7 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 246 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477424), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=1016.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1086.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=24 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 90 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480246), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=768.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 806.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=807.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 998.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=14 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476539), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=1193.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1587.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 101 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=909.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 975.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020232 from data/20252026/shifts/shifts_2025020232.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020232 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020232 key=5v5 len=7
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 214 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=7 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 214 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(9)} team=np.int64(9)
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=973.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1382.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=23 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478469), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=1090.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1418.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 98 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=2880.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 3799.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=9 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 214 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=765.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1071.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=820.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 997.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=502.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 507.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=672.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 850.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=851.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1011.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=768.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1100.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=23 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8473512), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=735.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 944.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=23 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482092), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=727.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 999.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=511.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 518.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=969.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1098.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=21 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482095), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=971.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1440.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=25 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482105), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=983.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1136.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=23 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475324), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=748.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1151.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=23 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481596), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=808.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 895.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=21 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480188), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=704.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1106.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=19 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482116), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=954.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1103.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=24 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482245), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=937.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1039.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=20 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 82 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481606), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=790.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 839.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=20 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478020), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=2880.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 3799.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=9 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 214 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476999), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=497.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 641.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=13 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474189), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=782.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 790.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=473.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 555.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=787.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1061.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=23 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480208), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=940.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1142.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=756.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1134.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=1087.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1475.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=936.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1222.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=600.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 617.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479336), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=617.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 625.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=17 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476393), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=581.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 581.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=13 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480245), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=770.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 866.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=652.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 774.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=17 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474102), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=926.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1202.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=21 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 88 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481528), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=1110.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1560.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 97 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=1008.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2880.0, 3799.0, 1385.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020266 from data/20252026/shifts/shifts_2025020266.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020266 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020266 key=5v5 len=6
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 213 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=6 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 213 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(22)} team=np.int64(22)
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=459.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 600.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=11 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479365), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=1132.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1484.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=29 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 96 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=809.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 936.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=833.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1024.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=833.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1045.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=18 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474641), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=765.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 765.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=19 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478233), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=825.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 965.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=1011.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1425.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=23 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 85 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480803), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=822.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 928.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=935.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 935.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=20 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476967), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=858.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1191.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=381.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 381.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 30 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=786.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 965.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=20 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483512), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=1093.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1254.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=24 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477498), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=1150.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1359.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=24 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 88 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478013), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=990.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 990.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=20 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480834), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=1047.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1294.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=21 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478402), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=632.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 670.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=15 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477508), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=676.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 682.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=444.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 470.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 30 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=913.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1020.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=18 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481617), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=954.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1131.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=23 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475218), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=438.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 547.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=10 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 42 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481491), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=1212.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1257.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=30 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=928.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1147.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=1313.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1477.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=28 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=862.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 893.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=18 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477406), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=419.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 419.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 34 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=3060.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 3679.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 213 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=3060.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 3679.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=8 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 213 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479973), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=968.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1219.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=1031.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1327.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=22 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477934), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=931.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1166.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=586.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 650.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=1034.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1259.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=19 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478458), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=1211.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1449.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=29 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 98 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=952.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 1152.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=367.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3060.0, 3679.0, 458.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020280 from data/20252026/shifts/shifts_2025020280.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=10 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 34 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483455), 'team': 22} team=22
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020280 key=5v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020280 key=5v5 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=3 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 202 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(19)} team=np.int64(19)
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 202 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=669.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 712.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=17 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477573), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=734.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 760.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=17 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478472), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1227.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1360.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=28 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 88 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=3360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 202 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=850.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 957.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1071.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1163.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=973.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1216.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=21 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480023), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1010.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1131.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=21 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479385), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=632.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 673.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=17 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480281), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1035.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1226.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=20 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482077), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1028.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1140.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=21 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475170), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=769.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 847.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=3360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=5 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 202 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476412), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=897.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 974.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=922.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1070.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=707.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 707.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=645.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 645.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=16 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481715), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=894.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1047.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=19 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483516), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1450.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1617.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=28 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 93 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481598), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=594.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 659.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=13 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484164), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=837.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 915.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=19 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480459), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1042.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1080.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=531.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 581.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 36 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1200.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1246.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=729.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 766.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=16 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482516), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=946.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1120.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=21 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477402), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1445.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1512.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=28 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476892), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=866.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1029.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1096.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1321.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=710.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 770.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=19 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476897), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=574.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 574.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1030.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1283.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1292.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1468.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=28 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475753), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=855.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 994.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1177.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1403.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=27 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 93 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475764), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=919.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 967.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1254.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1425.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=28 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 94 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=990.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3360.0, 3900.0, 1202.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020293 from data/20252026/shifts/shifts_2025020293.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020293 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020293 key=5v5 len=5
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=5 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 238 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(25)} team=np.int64(25)
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 238 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=1116.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 1286.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 82 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=904.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 942.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=21 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478476), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=793.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 858.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=897.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 963.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=850.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 916.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=19 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475794), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=740.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 744.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=832.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 1004.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=17 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480027), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=812.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 875.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=1195.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 1416.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=22 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 90 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480036), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=888.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 1035.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=846.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 994.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=674.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 674.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=929.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 1068.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=18 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482740), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=767.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 767.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=18 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479414), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=941.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 978.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=22 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480950), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=794.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 852.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=18 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480840), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=1272.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 1272.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=28 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 106 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=722.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 781.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=880.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 944.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=833.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 1006.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=18 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478420), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=714.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 747.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=18 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476889), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=846.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 909.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=902.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 963.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=19 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484829), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=921.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 991.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=833.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 874.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=20 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482145), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=1206.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 1247.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=27 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 107 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483425), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=3300.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 3596.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 238 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=1274.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 1363.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=23 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 90 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476902), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=873.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 955.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=1092.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 1096.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=24 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 98 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475755), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=3300.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=7 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 238 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479979), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=905.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 968.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=759.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 875.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=19 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478449), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=793.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 797.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=19 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476278), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=882.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 969.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=18 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479351), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=1236.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 1295.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 98 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=1185.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 1302.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=899.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3304.0, 3596.0, 987.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020324 from data/20252026/shifts/shifts_2025020324.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020324 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020324 key=5v5 len=5
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 235 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=5 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 235 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(19)} team=np.int64(19)
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=539.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 641.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=18 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477573), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=1234.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1499.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=28 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 100 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=894.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1049.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=743.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 897.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=857.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1115.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=21 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480023), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=598.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 675.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=16 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480281), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=886.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1078.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=19 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479385), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=793.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 933.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=18 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482077), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=937.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1086.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=20 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475170), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=707.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 896.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=1042.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1137.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=785.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 853.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=18 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482089), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=694.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 917.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=620.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 620.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=788.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 944.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=17 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483516), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=1345.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1567.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=29 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 110 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481598), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=904.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1080.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=19 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484164), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=830.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 882.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=19 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480459), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=1170.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1170.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 98 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=563.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 563.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=849.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 945.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=3169.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 3831.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=6 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 235 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480981), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=569.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 616.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=16 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482516), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=912.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1144.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=19 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477402), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=847.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1097.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=1380.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1526.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=30 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 114 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476892), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=1099.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1263.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 85 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=656.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 740.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=18 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476897), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=616.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 616.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=3169.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 3826.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 235 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=932.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1219.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=1266.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1499.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=24 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 103 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475753), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=646.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 679.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=15 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481006), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=844.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1083.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=1154.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1395.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=25 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475764), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=646.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 743.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=1342.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1573.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=29 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 99 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=1003.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3174.0, 3826.0, 1225.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020339 from data/20252026/shifts/shifts_2025020339.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 82 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020339 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020339 key=5v5 len=7
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 227 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=7 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 227 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(1)} team=np.int64(1)
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=906.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1211.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=22 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480002), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=549.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 618.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=14 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476292), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=648.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 693.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=16 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481032), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=1043.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1402.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 90 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=740.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 934.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=661.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 824.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=516.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 734.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=16 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476822), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=804.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 858.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=745.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 949.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=908.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 908.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=19 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479395), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=816.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 956.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=582.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 583.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=13 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474149), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=1078.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1205.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=25 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 101 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483495), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=563.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 567.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=14 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477996), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=672.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 916.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=732.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 761.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=988.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1346.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=25 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 98 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476462), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=950.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1250.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=21 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 85 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479407), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=789.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 791.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=17 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481721), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=570.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 687.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=16 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476474), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=884.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1225.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=18 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482110), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=857.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1155.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=16 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475455), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=899.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1087.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=22 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478399), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=951.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1095.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=683.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 734.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=948.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1183.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=21 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 82 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478414), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=841.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 982.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=750.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 956.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=18 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477015), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=686.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 988.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=1063.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1185.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=698.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 709.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=2891.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 3598.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 227 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=2891.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 3572.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=8 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 227 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474596), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=766.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1107.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=1070.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1349.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=24 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 103 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482684), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=731.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1040.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=1094.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1362.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=729.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2921.0, 3570.0, 1001.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020353 from data/20252026/shifts/shifts_2025020353.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020353 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020353 key=5v5 len=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=4 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 203 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(14)} team=np.int64(14)
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 203 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=1309.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1570.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 93 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=3237.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 3512.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 203 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=843.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 911.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=918.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 918.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=765.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 765.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=17 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477463), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=726.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 726.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=15 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482201), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=844.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 927.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=22 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476826), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=887.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 887.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=823.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 892.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=1109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1309.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=23 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 88 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476453), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=962.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1085.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=931.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 972.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=18 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483752), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=1222.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1284.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=24 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480426), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=456.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 456.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=13 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 39 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482090), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=885.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 986.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=455.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 455.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=1051.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1176.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=22 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 82 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479542), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=913.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1050.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=21 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478519), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=754.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 789.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=19 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483398), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=924.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 995.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=22 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476878), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=520.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 537.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 45 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=994.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1078.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=3237.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=6 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 203 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476883), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=864.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 907.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=929.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1096.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=20 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477404), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=938.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1013.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=1146.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1267.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=1247.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1418.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=27 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482655), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=1298.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1448.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=26 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 90 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478178), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=377.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 377.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=9 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 31 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=1002.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1204.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=586.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 681.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=12 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477416), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=327.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 327.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=9 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 33 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480876), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=981.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1109.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=1200.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1395.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=25 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482929), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=903.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1066.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=22 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477426), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=1297.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1479.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 96 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=984.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3325.0, 3512.0, 1173.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020363 from data/20252026/shifts/shifts_2025020363.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020363 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020363 key=5v5 len=5
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 246 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(13)} team=np.int64(13)
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 246 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=807.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1028.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=20 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480003), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=1109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1383.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 97 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=1187.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1258.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=25 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 93 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478859), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=861.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 942.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=703.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 771.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=657.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 659.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=831.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 962.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=20 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482713), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=557.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 557.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=13 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479393), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=786.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 786.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=18 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8473507), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=3120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=7 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 246 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475683), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=813.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 948.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=676.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 733.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=676.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 810.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=662.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 716.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=1079.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1315.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=24 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 98 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477495), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=789.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1015.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=19 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482113), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=848.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1045.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=18 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8473419), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=920.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1078.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=21 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 85 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478542), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=586.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 728.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=850.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 855.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=20 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 86 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484304), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=1064.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1117.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 88 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=517.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 517.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=14 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479316), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=857.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 884.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=18 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478421), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=852.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1000.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=927.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1066.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=1349.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1353.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 112 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=931.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1160.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=19 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477409), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=3120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 246 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=1230.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1300.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=26 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 88 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478055), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=937.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1080.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=548.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 548.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=13 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483433), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=1084.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1303.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=25 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477932), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=872.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1178.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=18 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477933), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=907.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1091.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=21 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477935), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=841.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 960.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=651.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 800.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=1240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1511.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=29 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 113 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=996.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3600.0, 1063.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020381 from data/20252026/shifts/shifts_2025020381.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020381 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020381 key=5v5 len=6
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=6 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 194 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(2)} team=np.int64(2)
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 194 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=2801.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=7 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 194 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479496), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=989.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1486.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=2801.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 194 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=919.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1003.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=20 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476429), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=343.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 565.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=7 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 23 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475151), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=704.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 905.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=623.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 737.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=585.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 585.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=759.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 956.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=721.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 996.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=545.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 545.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=11 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 42 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484262), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=833.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1104.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=18 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482476), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=694.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1056.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=580.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 616.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=727.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1068.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=17 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475314), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=776.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1060.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=14 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477494), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=832.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1481.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=19 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477500), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=724.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1002.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=17 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481601), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=1060.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1245.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=25 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477506), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=831.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1339.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=18 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485702), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=882.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1159.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=1032.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1201.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=580.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 753.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=828.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1019.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=572.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 596.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=13 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481237), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=745.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1057.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=1078.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1180.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=584.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 653.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=14 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475231), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=637.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 637.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=17 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477407), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=801.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1077.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=815.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1397.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=18 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478445), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=732.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1073.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=1180.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1408.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=25 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 91 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476917), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=1017.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1733.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=24 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485366), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=693.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 862.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=979.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1594.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=719.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 785.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=15 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484221), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=891.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2801.0, 3900.0, 1040.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020395 from data/20252026/shifts/shifts_2025020395.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=20 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477950), 'team': 2} team=2
Processed 30/37 (0.04 games/s)
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020395 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020395 key=5v5 len=7
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=7 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 233 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(1)} team=np.int64(1)
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 233 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=961.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1432.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=22 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 97 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480002), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=690.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 800.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=17 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476292), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=706.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 726.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=18 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481032), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=1026.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1390.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 90 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=846.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 934.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=652.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 792.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=684.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 724.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=19 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479996), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=565.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 565.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=522.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 620.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=11 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476822), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=785.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 862.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=719.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 777.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=842.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1140.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 82 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=992.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1216.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=25 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 100 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483495), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=487.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 487.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=11 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477996), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=758.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1049.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=1134.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1535.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=27 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 108 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476462), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=857.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1252.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=22 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 90 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479407), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=645.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 645.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=721.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 816.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=17 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481721), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=537.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 614.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=12 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476474), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=743.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1129.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=16 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482110), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=1103.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1237.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=26 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 111 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478399), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=799.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 864.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=16 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475455), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=969.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1331.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=22 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 95 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478414), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=608.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 608.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=925.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 989.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=1111.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1492.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 97 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=938.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1152.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 85 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=811.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 918.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=18 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477015), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=711.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1017.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=1040.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1190.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 88 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=2898.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 3587.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=8 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 233 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474593), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=2898.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 233 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=828.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1047.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=746.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 975.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=751.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 751.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=15 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478841), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=1023.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 1321.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=25 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 101 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482684), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=745.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2911.0, 3587.0, 906.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020407 from data/20252026/shifts/shifts_2025020407.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020407 key=5v5 len=8
DEBUG: get_game_intervals_cached HIT 2025020407 key=5v5 len=8
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 216 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=8 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 216 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(5)} team=np.int64(5)
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=957.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1173.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=19 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478854), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=815.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1094.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=901.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1093.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=20 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8471675), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=885.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1209.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=683.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 922.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=747.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 760.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=2757.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=9 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 216 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477465), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=681.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 751.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=15 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483487), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=795.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1145.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=19 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475810), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=692.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1016.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=688.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 820.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=712.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1027.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=13 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8485414), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=959.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1204.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=19 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 82 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8471724), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=632.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 915.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=765.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 799.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=731.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 969.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=16 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8471215), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=1013.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1075.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=19 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477365), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=579.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 579.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=11 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478147), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=775.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 839.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=16 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482758), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=674.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 792.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=15 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477511), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=484.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 745.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=11 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481481), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=1032.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1163.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 94 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=634.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 654.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=816.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1273.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=18 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8474578), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=953.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1078.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=480.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 792.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=11 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480980), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=639.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 960.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=1004.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1157.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=2757.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=9 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 216 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=628.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 746.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=14 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478438), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=682.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1160.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=342.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 530.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 25 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=830.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1247.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=16 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478450), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=814.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 816.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=18 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 61 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475763), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=888.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 979.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=956.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1008.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=20 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 89 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477435), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=851.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1328.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=853.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2757.0, 3600.0, 1177.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020423 from data/20252026/shifts/shifts_2025020423.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020423 key=5v5 len=9
DEBUG: get_game_intervals_cached HIT 2025020423 key=5v5 len=9
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=9 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 202 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=9 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 202 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(7)} team=np.int64(7)
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=443.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 637.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=2386.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 3597.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=9 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 202 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=638.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 994.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=2386.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=9 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 202 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481551), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=592.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 832.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=722.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 722.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=809.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1052.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=744.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1213.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=17 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480802), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=578.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 937.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=578.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 796.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=839.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1257.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=19 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 86 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480807), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=597.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 634.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=14 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483500), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=654.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1227.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=651.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 748.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=792.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 926.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=18 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482097), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=617.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 837.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=15 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484145), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=567.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1054.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=14 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479420), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=427.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 452.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=10 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 38 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482623), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=586.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1055.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=14 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480064), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=666.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 666.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=14 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480196), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=681.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 994.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=14 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480839), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=498.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 846.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=621.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1092.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=15 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475722), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=867.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1127.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=601.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 737.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=910.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1263.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=546.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1063.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=1032.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1385.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 100 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=572.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 572.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=526.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 992.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=14 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482659), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=517.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 995.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=700.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1016.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=18 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479982), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=905.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1294.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=19 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482671), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=513.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 571.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=11 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481522), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=979.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1429.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=20 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 99 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481524), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=722.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1422.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=697.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 1171.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=16 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477949), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=473.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[2386.0, 3597.0, 669.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020453 from data/20252026/shifts/shifts_2025020453.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=12 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 38 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479359), 'team': 7} team=7
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020453 key=5v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020453 key=5v5 len=5
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 236 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=5 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 236 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(21)} team=np.int64(21)
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=285.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 285.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=8 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 28 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482947), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=3146.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 3489.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 236 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=755.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 930.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=911.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 969.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=893.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 893.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=925.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1003.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=23 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476312), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=765.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 843.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=601.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 621.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=14 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478109), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1004.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1004.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=18 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484258), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=702.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 865.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1028.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1208.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=20 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477476), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1023.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1099.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 94 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1003.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1003.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=20 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 83 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479398), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=861.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1112.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=19 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476455), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=906.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=19 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479525), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1093.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1296.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=19 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 92 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480039), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=847.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1060.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=430.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 507.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 43 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1104.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1373.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=20 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 89 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477492), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=807.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 922.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=19 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477501), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=483.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 618.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=14 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480448), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=806.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 904.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=18 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480835), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1210.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1551.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=23 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 94 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480069), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=3146.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=6 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 236 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478406), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1261.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1319.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=30 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 112 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=496.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 560.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 41 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1183.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1330.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 94 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1047.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1168.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=21 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8470613), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1106.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1253.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=27 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 99 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478038), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=893.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1065.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=22 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1303.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1396.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=30 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 101 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=478.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 478.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=12 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 42 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=987.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1240.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 94 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=460.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 460.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=12 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 42 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481641), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1001.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1158.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=22 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 79 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475754), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=571.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 611.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=1235.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1553.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=28 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 99 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=997.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3257.0, 3489.0, 1170.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020469 from data/20252026/shifts/shifts_2025020469.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 96 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020469 key=5v5 len=7
DEBUG: get_game_intervals_cached HIT 2025020469 key=5v5 len=7
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 204 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=7 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 204 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(28)} team=np.int64(28)
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=1040.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1339.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=20 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475906), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=858.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 995.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=19 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484227), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=525.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 525.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=10 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8471817), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=666.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 823.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 46 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=3006.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 3486.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=8 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 204 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477968), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=757.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 917.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=646.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 646.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=13 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=873.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 926.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=19 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478874), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=896.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1017.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=18 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480798), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=682.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 767.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 54 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=922.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1141.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=996.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1110.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=22 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480043), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=519.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 528.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=11 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 34 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482859), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=1016.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1106.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=19 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475181), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=761.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1056.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=675.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 760.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=758.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 964.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=17 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484911), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=839.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 955.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=20 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475200), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=814.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1132.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=16 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477505), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=873.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1185.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=18 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484801), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=972.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1032.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=18 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484806), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=691.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 959.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=14 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475726), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=691.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 772.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=551.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 644.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=11 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 36 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476624), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=838.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 989.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=16 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480848), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=1215.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1339.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 85 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=984.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=715.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 925.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=1265.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1395.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 89 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=3006.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 204 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=873.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1046.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=658.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 697.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479336), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=845.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1162.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=17 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482667), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=1126.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1306.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=21 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 69 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479983), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=836.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 896.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482804), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=748.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 833.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 57 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=970.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1382.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=966.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3120.0, 3486.0, 1131.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020483 from data/20252026/shifts/shifts_2025020483.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020483 key=5v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020483 key=5v5 len=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 205 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=6 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 205 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(54)} team=np.int64(54)
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=1043.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1367.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=23 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477447), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=815.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1137.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=18 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475913), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=3069.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 3767.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=7 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 205 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481033), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=903.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 993.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=19 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 70 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477964), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=630.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 845.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=901.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1082.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=840.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1117.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=19 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478483), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=739.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 740.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=653.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 827.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 40 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=912.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1053.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=759.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 970.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=552.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 570.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=14 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=701.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 705.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=16 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483890), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=1036.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1243.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=23 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475188), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=704.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 854.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=16 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475191), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=1081.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1302.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=22 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478396), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=795.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1163.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=17 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 63 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478403), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=878.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1033.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=20 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 60 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481604), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=1047.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1385.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=1013.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1169.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=477.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 555.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=11 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 37 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=855.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1045.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=19 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 58 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476881), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=1210.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1356.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=1007.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1163.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=20 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480727), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=903.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 903.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=19 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477018), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=855.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1181.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=17 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=1060.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1346.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=23 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 84 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=566.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 566.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=14 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 35 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478434), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=3069.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 3764.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 205 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=904.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1243.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=761.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 761.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479336), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=664.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 664.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=14 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 42 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481133), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=800.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 821.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=24 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 55 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482804), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=788.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 847.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 48 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=1074.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1074.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=19 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481527), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=846.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 993.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=19 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479353), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=1284.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 1585.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=27 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 94 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=634.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3072.0, 3764.0, 819.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020501 from data/20252026/shifts/shifts_2025020501.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=15 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 44 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476925), 'team': 54} team=54
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020501 key=5v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020501 key=5v5 len=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 223 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 223 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'team': np.int64(12)} team=np.int64(12)
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=3355.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 223 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=1043.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1096.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=22 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 77 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482702), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=656.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 708.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=17 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 52 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8475791), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=893.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 995.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 80 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=835.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 835.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 51 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=809.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 809.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=618.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 618.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=14 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 42 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480762), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=826.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 899.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 78 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=932.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1065.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 64 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=954.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 954.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=22 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 66 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477478), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=950.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1090.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 81 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=739.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 790.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 56 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=732.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1044.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=19 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 62 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482093), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=1250.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1373.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=25 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 88 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480817), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=718.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 806.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=18 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 53 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482100), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=985.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1086.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=21 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 73 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8473533), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=814.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1031.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=20 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 68 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480830), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=534.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 534.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=14 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 39 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476873), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=3355.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 3897.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=6 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 223 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481611), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=1279.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1378.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=26 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 94 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=698.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 721.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=15 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 50 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=1302.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1425.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=25 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 88 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480336), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=1229.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1377.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=30 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 87 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=791.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1131.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=19 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478427), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=740.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 922.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=16 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 49 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=986.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1285.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=22 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 72 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482809), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=1198.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1322.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=25 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 94 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=827.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 829.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=19 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 47 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482911), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=929.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1045.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 67 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=729.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 876.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=18 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 59 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8479336), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=1272.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1558.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=24 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 106 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476906), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=965.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1094.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=21 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 75 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477940), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=889.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 984.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=20 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 71 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8482804), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=804.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=19 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 65 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=996.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 999.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=22 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 76 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8476921), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=1332.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1332.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=24 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 106 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8478970), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=1319.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1548.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=30 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 93 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=977.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3358.0, 3897.0, 1104.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=21 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 74 events by condition {'game_state': ['5v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
Cache processing complete.
Config: Mode=aggressive, Workers=1, Platform=Pi
--- Processing Cache for 20252026 [5v4] ---
Using Partial Cache Dir: /ssd/new_puck/data/cache/20252026/partials
Loaded season dataframe from data/20252026/20252026_df.csv -> shape=(9449, 25)
INFO:root:Loaded cached shifts for game 2025010008 from data/20252026/shifts/shifts_2025010008.pkl
Found 37 games to process out of 37 total.
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010008 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010008 key=4v5 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(2)} team=np.int64(2)
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=20.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 710.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010008 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485378), 'team': 2} (team=2) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 673.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 2001.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479496), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1257.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476429), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1178.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475151), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=125.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1210.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1529.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=107.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 965.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485409), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1421.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 813.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482727), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 834.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=106.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1088.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=100.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 963.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475314), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=101.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1141.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477494), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=99.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1361.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477500), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=6.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1083.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010008 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484287), 'team': 2} (team=2) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 899.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010008 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478146), 'team': 2} (team=2) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1090.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484804), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1008.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485702), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=127.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1109.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1182.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=105.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1462.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=245.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 2396.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482783), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1899.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480481), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1089.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010008 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485352), 'team': 2} (team=2) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1189.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=6.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 789.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010008 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482154), 'team': 2} (team=2) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=145.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1340.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478445), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=129.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 686.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483697), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 970.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010008 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=83.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1479.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485366), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=126.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1389.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=156.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1521.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025010026 from data/20252026/shifts/shifts_2025010026.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477950), 'team': 2} team=2
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010026 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025010026 key=4v5 len=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(8)} team=np.int64(8)
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=77.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 1286.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483457), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=79.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 904.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481540), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=203.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1139.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=7.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 671.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485392), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=186.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1220.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=90.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 853.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480018), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=64.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 929.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483731), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=43.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 1153.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484220), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=226.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1198.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=7.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1215.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478502), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=100.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 940.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=223.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1216.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=31.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 802.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=91.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 788.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482737), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=30.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 904.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483507), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=16.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 966.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484533), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=33.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 704.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481848), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=93.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 720.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483515), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=41.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 757.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482749), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=7.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 697.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484928), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=18.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 919.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482890), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=27.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 928.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481618), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=7.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1099.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 1226.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481110), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 1743.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478039), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=208.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 2349.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482783), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=234.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1550.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025010036 from data/20252026/shifts/shifts_2025010036.pkl
INFO:root:Loaded cached shifts for game 2025010047 from data/20252026/shifts/shifts_2025010047.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025010036 season=20252026
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010047 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025010047 key=4v5 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(6)} team=np.int64(6)
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=106.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 838.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482177), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=107.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 955.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479362), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=74.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1154.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=321.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 3400.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=226.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1042.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=72.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 678.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483731), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=298.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480022), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=254.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1206.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=73.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1020.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=22.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 829.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482213), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 999.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=155.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1281.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476854), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=26.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 902.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477887), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=171.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1049.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478401), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=125.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1209.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481219), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=27.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1056.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483017), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=164.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1179.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482511), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 642.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479705), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=248.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1348.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 931.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480355), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=249.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1132.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=106.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 893.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479591), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=167.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 837.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483567), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=18.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1072.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480887), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=163.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 771.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485496), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=71.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1227.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=250.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1168.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025010063 from data/20252026/shifts/shifts_2025010063.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010063 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025010063 key=4v5 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(6)} team=np.int64(6)
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=119.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1175.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477956), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1244.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010063 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479369), 'team': 6} (team=6) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=202.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1185.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=146.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1061.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480280), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=205.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1478.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=42.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1220.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478502), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=145.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1155.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=209.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 913.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=119.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 794.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481712), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=116.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 793.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483505), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=117.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1227.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476854), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=121.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1074.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477496), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=22.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 775.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010063 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481848), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=123.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1029.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478401), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=11.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1544.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010063 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477507), 'team': 6} (team=6) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=126.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 910.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478409), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=161.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1122.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=10.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 833.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010063 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=117.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 894.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478042), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=185.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1220.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=114.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1537.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479325), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 684.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010063 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 3895.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=17.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1378.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010063 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=206.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1259.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=107.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 764.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483697), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=124.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1113.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479987), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1137.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010063 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=111.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1021.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025010083 from data/20252026/shifts/shifts_2025010083.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479999), 'team': 6} team=6
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010083 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025010083 key=4v5 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(2)} team=np.int64(2)
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 1410.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 3502.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=16.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010083 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (210, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476429), 'team': 2} (team=2) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 883.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 884.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=117.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 584.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484221), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 954.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=195.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 879.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482476), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 1028.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=179.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1136.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475314), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=310.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478009), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=114.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1044.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481601), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=106.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1001.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485702), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=16.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 728.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010083 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (210, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481237), 'team': 2} (team=2) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 845.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 1276.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=182.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 891.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477407), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 812.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010083 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (210, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475231), 'team': 2} (team=2) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=14.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 734.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010083 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (210, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483553), 'team': 2} (team=2) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=90.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1051.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484958), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 1124.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1169.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480871), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=188.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1218.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478445), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 953.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 982.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010083 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (210, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476917), 'team': 2} (team=2) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=16.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1310.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010083 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (210, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481014), 'team': 2} (team=2) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=183.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1212.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485366), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 1077.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025010094 from data/20252026/shifts/shifts_2025010094.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010094 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025010094 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(1)} team=np.int64(1)
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 1312.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481032), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=93.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1528.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=77.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1097.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 896.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=86.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1126.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=73.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1081.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 754.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010094 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=67.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1105.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 1071.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481721), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 1086.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484177), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=14.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1218.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010094 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=67.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 849.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=87.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1478.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=170.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 3873.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 3890.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474596), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1159.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 1408.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480884), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 1329.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482941), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=15.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1528.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010094 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1165.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020012 from data/20252026/shifts/shifts_2025020012.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020012 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020012 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 32 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(13)} team=np.int64(13)
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1423.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478859), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=58.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 862.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=75.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 959.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=167.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 935.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=4 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482713), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=418.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 3564.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 32 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475683), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=143.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1026.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=4 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8473507), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=63.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 894.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=12.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 467.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475179), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 485.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=223.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1329.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=4 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477495), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=50.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 986.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480185), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=156.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1046.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482113), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=248.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1174.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=4 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8473419), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=135.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 958.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=4 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478542), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 587.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=17.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1281.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=70.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1001.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=74.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1374.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=125.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 958.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=4 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477409), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 451.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=136.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 3526.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=52.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1404.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478055), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=58.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 992.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1041.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020012 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (275, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=249.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1400.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477932), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=283.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1321.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 20 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477933), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=245.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1166.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477935), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=75.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1035.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=62.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1635.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=58.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 957.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025020030 from data/20252026/shifts/shifts_2025020030.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020030 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020030 key=4v5 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 35 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(12)} team=np.int64(12)
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=249.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 3883.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=241.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1099.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 20 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482702), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=243.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 808.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 20 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475791), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=130.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1089.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=123.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1064.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=6.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1008.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=1 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020030 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (315, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476958), 'team': 12} (team=12) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=132.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 807.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=116.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1205.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=236.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1250.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482093), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=217.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1556.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 20 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480817), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 890.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=1 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020030 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (315, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8473533), 'team': 12} (team=12) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=21.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 626.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=1 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480829), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=231.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1016.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480830), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=184.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1380.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480336), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=233.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1235.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478427), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 980.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=224.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1167.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 20 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482809), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=151.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1388.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=134.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1009.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=296.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1225.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 24 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476906), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=480.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 3881.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 35 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475883), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=113.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1057.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=263.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1199.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477940), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1774.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=128.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1162.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020044 from data/20252026/shifts/shifts_2025020044.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020044 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020044 key=4v5 len=5
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 39 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 24 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(13)} team=np.int64(13)
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1251.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020044 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478859), 'team': 13} (team=13) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=291.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 892.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 22 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=210.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 983.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 637.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020044 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=130.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 795.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482713), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=135.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 966.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8473507), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=358.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 896.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 25 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=10.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1045.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020044 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=131.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1001.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=354.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1438.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477495), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=500.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 3478.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 24 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480193), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=147.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 927.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482113), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=341.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1075.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8473419), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=148.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 993.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478542), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 634.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020044 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=16.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1359.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=10.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 486.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020044 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478421), 'team': 13} (team=13) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 854.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020044 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479316), 'team': 13} (team=13) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=196.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1013.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=376.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1359.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 24 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=158.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1049.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477409), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=545.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 39 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=21.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1399.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478055), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=325.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1142.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 24 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=353.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1415.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477932), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=348.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1227.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477933), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 413.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020044 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479981), 'team': 13} (team=13) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=340.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1117.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477935), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1016.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=180.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1496.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=379.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 955.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020066 from data/20252026/shifts/shifts_2025020066.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 24 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
Processed 10/37 (0.06 games/s)
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020066 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020066 key=4v5 len=1
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(52)} team=np.int64(52)
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=31.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1352.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 3538.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[24.0, 3538.0, 1006.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480014), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=191.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 980.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=174.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1058.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[24.0, 3538.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476945), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=168.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1128.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=170.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1191.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[24.0, 3538.0, 1124.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476460), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[24.0, 3538.0, 1127.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478398), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[24.0, 3538.0, 1461.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477504), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=181.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 918.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=172.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1448.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=161.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1092.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=194.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 969.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[24.0, 3538.0, 843.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480113), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=192.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1475.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=166.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1049.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020081 from data/20252026/shifts/shifts_2025020081.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020081 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020081 key=4v5 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 25 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(30)} team=np.int64(30)
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=39.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1570.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=60.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 935.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477451), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=58.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 981.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475149), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=135.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1119.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=302.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1385.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 22 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478864), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1078.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=305.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1405.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 22 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481557), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=296.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1314.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 22 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478493), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=92.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1081.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482079), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=141.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 727.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=131.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1239.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1329.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=1 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476463), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=20.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1070.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=1 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478136), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=318.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1204.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 23 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484798), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=25.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 641.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=1 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020081 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (256, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476994), 'team': 30} (team=30) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=14.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1421.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=1 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482122), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 714.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=1 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475220), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=105.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1160.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=37.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1219.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474716), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=155.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1295.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 3757.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 3757.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 25 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482661), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=135.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1228.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=104.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1214.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=263.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 998.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 22 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475765), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1798.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=104.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1002.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020094 from data/20252026/shifts/shifts_2025020094.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020094 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020094 key=4v5 len=5
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=5 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 22 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(55)} team=np.int64(55)
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=62.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 892.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480009), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 1309.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=65.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 998.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=2 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479372), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=65.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 1001.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=87.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 827.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=64.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 975.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1233.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020094 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (280, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476457), 'team': 55} (team=55) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=270.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 911.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=5 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483497), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=63.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 1136.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=86.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1200.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=2 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475831), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=21.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 829.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020094 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (280, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484800), 'team': 55} (team=55) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=278.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 2370.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=4 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478916), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=62.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 890.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483524), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=302.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1523.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=6 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 21 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478407), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=302.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1153.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=6 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 21 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474586), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=91.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 1004.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=68.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 1051.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=156.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 3539.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=69.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 1067.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=278.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1077.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=5 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 21 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476905), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=302.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1205.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=6 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 21 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482665), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=93.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 1056.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=27.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1032.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=2 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479985), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=62.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 817.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475768), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=92.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 951.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=62.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 971.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020112 from data/20252026/shifts/shifts_2025020112.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478975), 'team': 55} team=55
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020112 key=5v4 len=5
DEBUG: get_game_intervals_cached HIT 2025020112 key=4v5 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=5 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 30 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(9)} team=np.int64(9)
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=294.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1615.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=5 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 17 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478469), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=151.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1546.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=128.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1063.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=133.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 848.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=131.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 890.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=289.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1131.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=5 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 17 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8473512), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=241.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1074.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482092), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=155.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1273.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=301.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1363.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=6 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482105), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=144.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 553.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480188), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=12.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1244.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475324), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=188.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1372.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481596), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=293.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1126.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=6 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482116), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1034.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020112 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (240, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482245), 'team': 9} (team=9) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=587.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=5 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 30 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476999), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=315.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 704.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=5 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474189), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=265.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 897.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=6 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480208), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=11.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1069.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020112 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (240, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=121.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 985.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=141.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1433.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=285.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 3492.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=144.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1283.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=148.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1027.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=308.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1009.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=5 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 17 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474102), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=272.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1053.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=6 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481528), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1451.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020112 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (240, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=154.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 861.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020127 from data/20252026/shifts/shifts_2025020127.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020127 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020127 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 21 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(2)} team=np.int64(2)
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=181.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1642.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=313.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 21 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=119.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1079.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=145.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1222.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475151), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=177.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1120.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=96.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 929.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=89.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1169.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482476), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=118.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1156.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=93.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 761.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475314), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=141.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1209.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477494), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478009), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=146.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1441.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477500), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=85.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 924.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481601), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 475.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481237), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=193.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1154.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=132.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1355.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 506.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484958), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=86.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 977.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477407), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 495.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475231), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1259.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=144.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1292.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478445), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=194.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1364.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1339.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476917), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=141.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1660.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485366), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=40.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1627.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=195.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1123.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=99.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1029.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025020150 from data/20252026/shifts/shifts_2025020150.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477950), 'team': 2} team=2
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020150 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020150 key=4v5 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 22 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(5)} team=np.int64(5)
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 22 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481668), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=20.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1061.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=1 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478854), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=203.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1698.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=272.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 3884.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=68.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 927.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=203.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1071.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=84.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 902.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=2 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479638), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=276.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1413.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 17 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475810), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=65.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 889.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 767.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485414), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1270.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=2 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8471724), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=69.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1142.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 792.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=1 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020150 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (290, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483503), 'team': 5} (team=5) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=300.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1222.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 20 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8471215), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 698.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=2 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482758), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=259.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1130.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477511), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=283.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1902.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 20 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474578), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=203.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1294.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=69.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1293.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=67.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 668.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=2 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478438), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=69.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1048.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=203.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1220.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=276.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1395.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 17 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8471675), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1689.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020150 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (290, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=204.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1132.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020170 from data/20252026/shifts/shifts_2025020170.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020170 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020170 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(18)} team=np.int64(18)
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3.0, 3503.0, 1432.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3.0, 3503.0, 1049.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=44.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 761.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484241), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=188.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1031.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475158), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=49.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 931.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475287), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=187.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1080.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474564), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=104.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1298.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476869), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=187.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1000.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476887), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3.0, 3503.0, 1003.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=49.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 937.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478047), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=51.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1048.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482146), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3.0, 3503.0, 3592.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=133.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1252.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483565), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3.0, 3503.0, 1025.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=237.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 3511.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477424), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=6.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1142.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020170 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (262, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480246), 'team': 18} (team=18) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=187.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 952.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476539), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3.0, 3503.0, 1127.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020188 from data/20252026/shifts/shifts_2025020188.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020188 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020188 key=4v5 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(10)} team=np.int64(10)
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1105.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476931), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=317.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476932), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1439.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=181.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1028.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=105.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 965.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 644.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=12.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 609.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478104), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=215.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1021.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475166), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=220.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1204.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=4 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482720), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=91.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1008.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475171), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=229.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 952.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=182.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1239.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=11.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 890.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475690), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 668.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020188 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (284, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 920.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481582), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=83.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 765.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481711), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=202.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1197.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476853), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 669.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020188 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (284, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481848), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=121.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 759.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484158), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=175.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 734.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477503), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 668.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475714), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=29.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 703.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482259), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1018.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=224.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1219.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=4 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479318), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=168.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 987.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=140.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1088.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=20.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482783), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 2433.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=247.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1120.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 868.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478057), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=11.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1440.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478443), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=176.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1097.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=129.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1447.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=233.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1225.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=55.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1011.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025020196 from data/20252026/shifts/shifts_2025020196.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478462), 'team': 10} team=10
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020196 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020196 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 21 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(20)} team=np.int64(20)
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=55.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1418.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=41.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=42.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 825.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=52.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1037.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482074), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=168.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1033.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480028), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=67.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1122.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480797), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=217.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 3560.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 21 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481692), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 779.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484768), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=119.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1559.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477346), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=48.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 821.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=165.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1080.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475172), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=55.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1075.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=150.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1107.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476456), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=52.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 637.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481068), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=55.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1171.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=49.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1313.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478397), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=42.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1032.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=42.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1314.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=97.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 3492.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482783), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=55.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1300.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=165.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482679), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1500.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020196 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (260, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=42.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1244.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020204 from data/20252026/shifts/shifts_2025020204.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020204 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020204 key=4v5 len=5
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=4 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 20 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(8)} team=np.int64(8)
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 30 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=250.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1403.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483457), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1226.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481540), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=322.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=4 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 20 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478470), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=155.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1547.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=267.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1284.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 21 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=268.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 925.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 21 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1287.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480018), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=159.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 928.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=173.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1436.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=134.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1188.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=131.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 771.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=2 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482737), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=192.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1109.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=4 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483515), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=83.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 711.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=2 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475848), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 638.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 979.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=2 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481618), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1141.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=258.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1124.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 20 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=273.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1544.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 21 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=72.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1438.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=2 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480865), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=431.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 3895.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 30 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=164.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1286.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=81.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 809.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=2 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481523), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=239.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 921.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484984), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1506.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=294.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1404.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020223 from data/20252026/shifts/shifts_2025020223.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 21 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
Processed 20/37 (0.06 games/s)
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020223 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020223 key=4v5 len=1
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=3 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 22 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(18)} team=np.int64(18)
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 1495.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 1043.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=154.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 835.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484241), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 954.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=197.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1134.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=4 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475158), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=176.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1054.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475287), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 772.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 1120.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=160.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1123.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474564), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=219.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1265.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=3 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476869), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=215.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1163.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=4 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476887), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=163.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 854.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478047), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=205.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1163.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=3 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482146), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 1123.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=6.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1300.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479980), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=143.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1390.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=3 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483565), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 3486.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=3 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 22 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477424), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=16.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1086.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020223 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (284, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480246), 'team': 18} (team=18) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=146.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 998.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476539), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 975.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020232 from data/20252026/shifts/shifts_2025020232.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020232 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020232 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(9)} team=np.int64(9)
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=144.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1382.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478469), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=57.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1418.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 3799.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=170.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1071.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=177.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 997.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 507.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 850.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=125.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1100.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8473512), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=115.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 944.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482092), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=56.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 999.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=7.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 518.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1098.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482095), 'team': 9} (team=9) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1440.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482105), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=117.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1151.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481596), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=116.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1106.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482116), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1103.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482245), 'team': 9} (team=9) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=11.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1039.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481606), 'team': 9} (team=9) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 3799.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476999), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=124.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 641.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474189), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 790.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 555.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=113.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1061.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480208), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=172.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1134.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=182.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1475.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=58.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1222.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 866.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=122.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 774.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474102), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=114.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1202.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=3 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481528), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=63.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1560.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=182.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1385.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020266 from data/20252026/shifts/shifts_2025020266.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020266 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020266 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(22)} team=np.int64(22)
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=141.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 600.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479365), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=136.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1484.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=100.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 936.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=191.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1024.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1045.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474641), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=114.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 965.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=228.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1425.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480803), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=138.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1191.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=38.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 965.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=1 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483512), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=15.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1359.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478013), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=146.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1294.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478402), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 670.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=1 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020266 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477508), 'team': 22} (team=22) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=39.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1131.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=1 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475218), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 547.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=1 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020266 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481491), 'team': 22} (team=22) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=186.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1147.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=164.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1477.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=300.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 3679.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 3679.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479973), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1219.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=198.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1327.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477934), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=190.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1166.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=202.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1259.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478458), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=10.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1449.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=162.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1152.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=91.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 458.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020280 from data/20252026/shifts/shifts_2025020280.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483455), 'team': 22} team=22
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020280 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020280 key=4v5 len=1
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(19)} team=np.int64(19)
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 712.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477573), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1360.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 957.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1163.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1216.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480023), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=46.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1131.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479385), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 673.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480281), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=46.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1226.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482077), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=46.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1140.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475170), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 847.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476412), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1070.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1047.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483516), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=15.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1617.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481598), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=65.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 659.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484164), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=46.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 915.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480459), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1120.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477402), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1512.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020280 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (235, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476892), 'team': 19} (team=19) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1029.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1321.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 770.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476897), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=60.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1283.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=46.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1468.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475753), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 994.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=71.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1403.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475764), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1425.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020280 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (235, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1202.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020293 from data/20252026/shifts/shifts_2025020293.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020293 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020293 key=4v5 len=1
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=2 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(25)} team=np.int64(25)
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 1286.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=38.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 942.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478476), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 858.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 963.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=62.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 916.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475794), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=172.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 1004.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=2 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480027), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=63.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 875.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=138.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 1416.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=2 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480036), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=36.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 994.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=113.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 1068.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=2 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482740), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 852.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020293 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (255, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480840), 'team': 25} (team=25) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=173.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 1006.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=2 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478420), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=57.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 909.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 963.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020293 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (255, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484829), 'team': 25} (team=25) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 991.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 874.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020293 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (255, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482145), 'team': 25} (team=25) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 3596.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=6.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 1363.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020293 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (255, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476902), 'team': 25} (team=25) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 955.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=176.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=2 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479979), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 968.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 875.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=2 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478449), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=58.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 969.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479351), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=84.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 987.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020324 from data/20252026/shifts/shifts_2025020324.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020324 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020324 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(19)} team=np.int64(19)
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=122.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1499.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=122.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1049.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=118.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 897.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=92.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1115.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480023), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1078.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479385), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=95.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 933.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482077), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=97.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1086.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475170), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=122.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 896.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=68.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 853.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482089), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=122.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 917.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=117.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 944.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483516), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1567.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020324 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (263, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481598), 'team': 19} (team=19) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=74.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1080.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484164), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=186.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 3831.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480981), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=89.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1144.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477402), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=118.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1097.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=14.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1526.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020324 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (263, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476892), 'team': 19} (team=19) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=118.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1263.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 3826.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=122.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1219.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=68.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1499.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475753), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=118.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1083.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1395.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475764), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=118.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1225.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020339 from data/20252026/shifts/shifts_2025020339.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020339 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020339 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 37 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(1)} team=np.int64(1)
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=189.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 1211.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480002), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=45.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 693.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481032), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=269.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1402.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 28 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=192.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 934.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=163.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 824.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 858.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020339 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (289, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=202.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 949.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=12.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 956.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=26.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 1205.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483495), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=111.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 916.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 761.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020339 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (289, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=156.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 1346.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476462), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=199.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 1250.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479407), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=43.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 687.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476474), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=130.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 1225.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482110), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=142.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1095.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 734.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020339 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (289, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=154.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 1183.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 17 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478414), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=10.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 956.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477015), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=254.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 988.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 25 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1185.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=480.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 3598.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 37 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=199.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 3572.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474596), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=300.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1107.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 28 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=43.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 1349.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482684), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=267.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1040.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 28 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=91.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1362.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=270.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1001.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020353 from data/20252026/shifts/shifts_2025020353.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 28 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020353 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020353 key=4v5 len=1
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(14)} team=np.int64(14)
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 1570.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 3512.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 927.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476826), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=149.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1309.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476453), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=41.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 972.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483752), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=62.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1284.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=3 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480426), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=33.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1176.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479542), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=39.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1050.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478519), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 995.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476878), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=155.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476883), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=118.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1096.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477404), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 1013.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1418.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482655), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1448.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478178), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 1204.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=95.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 681.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477416), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 1109.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=22.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1395.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482929), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=95.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1066.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=3 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477426), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 1173.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020363 from data/20252026/shifts/shifts_2025020363.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020363 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020363 key=4v5 len=1
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(13)} team=np.int64(13)
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=197.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1028.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480003), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1383.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=63.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 942.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=68.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 771.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 659.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020363 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (265, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=131.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 962.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482713), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475683), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=57.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 733.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=6.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 716.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=174.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1315.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477495), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=226.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1015.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482113), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=163.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1045.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8473419), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1078.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478542), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1117.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1066.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1353.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020363 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (265, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=229.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1160.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477409), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=16.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1300.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020363 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (265, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478055), 'team': 13} (team=13) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=46.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1080.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=170.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1303.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477932), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=247.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1178.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477933), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=135.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1091.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477935), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=55.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 960.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1511.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=67.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1063.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025020381 from data/20252026/shifts/shifts_2025020381.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020381 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020381 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=4 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 27 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(2)} team=np.int64(2)
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=560.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=4 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 27 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479496), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=80.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1486.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=211.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=153.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 565.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475151), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=114.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 905.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=114.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 737.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=131.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 956.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=143.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1104.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482476), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=58.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1056.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=337.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1068.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=5 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475314), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=226.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1060.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477494), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=427.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1481.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=5 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 20 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477500), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=119.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1002.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481601), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=10.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1245.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477506), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=304.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1339.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=5 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485702), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=110.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1159.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=63.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1201.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=84.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1057.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1077.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=441.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1397.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=5 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 20 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478445), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1073.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1408.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476917), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=401.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1733.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=5 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485366), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=127.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1594.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 785.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484221), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=149.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1040.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020395 from data/20252026/shifts/shifts_2025020395.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477950), 'team': 2} team=2
Processed 30/37 (0.06 games/s)
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020395 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020395 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=4 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 30 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(1)} team=np.int64(1)
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=352.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1432.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=5 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 26 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480002), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=84.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 800.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476292), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=20.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 726.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481032), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=136.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1390.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=60.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 934.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=52.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 792.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=12.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 724.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479996), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 777.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1140.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=175.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1216.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=4 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483495), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=263.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1535.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=4 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476462), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=376.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1252.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=5 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 27 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479407), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 816.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481721), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=75.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 614.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476474), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=264.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1129.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=4 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482110), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=345.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1331.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=5 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 26 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478414), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 989.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=71.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1492.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1152.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 918.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020395 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (282, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477015), 'team': 1} (team=1) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=154.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1017.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1190.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=449.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 3587.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=5 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 30 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474593), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=209.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=156.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1047.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=148.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 975.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 7 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=189.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1321.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=4 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482684), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=156.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 906.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020407 from data/20252026/shifts/shifts_2025020407.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020407 key=5v4 len=6
DEBUG: get_game_intervals_cached HIT 2025020407 key=4v5 len=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 28 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=4 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 17 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(5)} team=np.int64(5)
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=179.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1094.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=174.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1093.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8471675), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=256.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1209.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=230.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 922.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 760.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=237.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 17 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477465), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=162.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1145.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475810), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=206.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1016.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=156.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1027.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8485414), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=71.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1204.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=2 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8471724), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=187.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 915.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=15.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 799.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=237.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 969.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 17 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8471215), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=64.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 839.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=1 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482758), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 792.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=2 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477511), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=131.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1163.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=166.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1273.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8474578), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=262.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 960.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=63.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1157.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=444.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 28 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 746.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=2 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478438), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=204.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1160.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=70.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 530.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1247.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=1 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020407 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (279, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478450), 'team': 5} (team=5) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=205.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1328.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=199.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1177.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020423 from data/20252026/shifts/shifts_2025020423.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020423 key=5v4 len=4
DEBUG: get_game_intervals_cached HIT 2025020423 key=4v5 len=6
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 38 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 28 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(7)} team=np.int64(7)
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 637.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=522.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 3597.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 38 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=312.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 994.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 25 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=577.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 28 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481551), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=202.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 832.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=119.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1213.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=4 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480802), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=315.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 937.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 26 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1257.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=1 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020423 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (287, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480807), 'team': 7} (team=7) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=218.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1227.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=108.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 926.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=3 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482097), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=70.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 837.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=1 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484145), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=469.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1054.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 26 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479420), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=459.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1055.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 26 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480064), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=310.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 994.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=4 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 17 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480839), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=304.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 846.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 24 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=468.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1092.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 26 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475722), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=177.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1127.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 14 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=199.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1063.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 15 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=233.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1385.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 19 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=466.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 992.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 26 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482659), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=297.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 995.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 24 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=104.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1294.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=3 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482671), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=198.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1429.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=3 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481524), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=345.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1422.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 26 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=111.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1171.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020453 from data/20252026/shifts/shifts_2025020453.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=4 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477949), 'team': 7} team=7
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020453 key=5v4 len=1
DEBUG: get_game_intervals_cached HIT 2025020453 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 17 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(21)} team=np.int64(21)
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 3489.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 930.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=46.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 969.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020453 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (267, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=20.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 621.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478109), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 865.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=165.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1208.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477476), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=184.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1112.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476455), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479525), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=203.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1296.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480039), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=43.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 1060.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020453 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (267, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=182.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1373.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477492), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=39.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 922.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477501), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=205.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1551.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480069), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=223.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 17 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478406), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=46.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 1319.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020453 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (267, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=18.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1253.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478038), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=44.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 1065.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020453 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (267, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=44.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 1396.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020453 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (267, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=77.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 1240.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=64.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1158.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 6 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475754), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=74.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 1553.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=74.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 1170.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025020469 from data/20252026/shifts/shifts_2025020469.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020469 key=5v4 len=2
DEBUG: get_game_intervals_cached HIT 2025020469 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(28)} team=np.int64(28)
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=195.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1339.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475906), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=42.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 995.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484227), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=125.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 823.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 3486.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477968), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=102.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 917.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=43.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 926.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478874), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=102.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1017.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480798), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 767.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=91.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1141.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=15.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1110.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=1 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480043), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=97.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1056.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=60.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 964.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=1 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 1 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484911), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=45.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 955.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475200), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=139.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1132.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477505), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=197.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1185.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484801), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=164.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 959.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475726), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=104.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1339.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=96.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 925.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1395.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=143.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1046.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=198.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1162.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482667), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=136.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1382.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=141.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1131.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020483 from data/20252026/shifts/shifts_2025020483.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020483 key=5v4 len=3
DEBUG: get_game_intervals_cached HIT 2025020483 key=4v5 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(54)} team=np.int64(54)
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 1367.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=1 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020483 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477447), 'team': 54} (team=54) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=148.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 1137.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475913), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=168.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 3767.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481033), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 993.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=1 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020483 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477964), 'team': 54} (team=54) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=167.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 845.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=181.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1082.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 9 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=165.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 1117.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478483), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 740.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020483 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483733), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=171.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 827.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1053.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020483 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 970.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 2 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 705.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=1 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020483 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8483890), 'team': 54} (team=54) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=12.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 1302.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=1 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020483 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478396), 'team': 54} (team=54) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=167.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 1163.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478403), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=155.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 1033.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481604), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=279.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1385.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=107.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1169.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=156.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 1045.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 10 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476881), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1356.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020483 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=186.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1181.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=206.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1346.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 3764.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 18 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=270.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1243.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=20.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 993.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=1 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020483 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8479353), 'team': 54} (team=54) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=145.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1585.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020501 from data/20252026/shifts/shifts_2025020501.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 4 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020501 key=5v4 len=0
DEBUG: get_game_intervals_cached HIT 2025020501 key=4v5 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=3 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'team': np.int64(12)} team=np.int64(12)
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1096.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482702), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=52.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 708.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=1 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8475791), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=191.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1044.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482093), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 806.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482100), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=21.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1086.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8473533), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=188.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1031.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480830), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=242.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 3897.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=3 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 16 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8481611), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1425.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=1 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020501 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (260, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8480336), 'team': 12} (team=12) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=189.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1131.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 13 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8478427), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=221.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1285.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=3 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 11 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482809), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 829.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=1 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020501 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (260, 26) columns_count= 26
Warning: condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8482911), 'team': 12} (team=12) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=152.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1558.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 12 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8476906), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=51.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1094.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=12
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['5v4'], 'is_net_empty': [0], 'player_id': np.int64(8477940), 'team': 12} team=12
Cache processing complete.
Config: Mode=aggressive, Workers=1, Platform=Pi
--- Processing Cache for 20252026 [4v5] ---
Using Partial Cache Dir: /ssd/new_puck/data/cache/20252026/partials
Loaded season dataframe from data/20252026/20252026_df.csv -> shape=(9449, 25)
INFO:root:Loaded cached shifts for game 2025010008 from data/20252026/shifts/shifts_2025010008.pkl
Found 37 games to process out of 37 total.
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010008 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010008 key=5v4 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(2)} team=np.int64(2)
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 2001.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479496), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=117.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1257.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476429), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=72.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1178.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475151), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=128.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1529.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=48.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1005.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481569), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=31.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 965.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010008 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8485409), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=49.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 834.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010008 intervals_parsed= 1
skipped_games (sample): [('2025010008', 'no_matches')]
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=87.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1088.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=56.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1446.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484147), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=28.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1141.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477494), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=141.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1361.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=4 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477500), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=65.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1083.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484287), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=107.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 899.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478146), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1090.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010008 intervals_parsed= 3
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484804), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=45.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 796.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=38.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 565.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8485462), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=100.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1182.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=125.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 2396.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482783), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=125.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1899.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480481), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=78.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1089.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8485352), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 1189.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=90.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 789.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482154), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1340.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478445), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=49.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 686.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010008 intervals_parsed= 1
skipped_games (sample): [('2025010008', 'no_matches')]
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483697), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=72.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[181.0, 3017.0, 970.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=70.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1479.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8485366), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=113.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[301.0, 3017.0, 1521.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010008)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025010026 from data/20252026/shifts/shifts_2025010026.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010008 rows_in_game=272 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025010008 df_game_rows=272
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477950), 'team': 2} team=2
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010026 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025010026 key=5v4 len=1
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=4 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(8)} team=np.int64(8)
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1039.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=3 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478851), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=65.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 1139.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=21.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 1220.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=119.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1103.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=3 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482964), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=11.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 868.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=2 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478104), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1153.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=3 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484220), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=33.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 1198.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 1215.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478502), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=137.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1312.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=4 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482087), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=32.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 940.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=80.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 1216.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=99.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1087.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=3 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480813), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 904.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=3 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483507), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=89.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 829.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=2 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484403), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=84.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1857.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=2 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482487), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 757.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=2 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482749), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=160.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 928.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=5 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481618), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=22.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 1099.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=117.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1226.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=3 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481110), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=175.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[259.0, 2874.0, 1743.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=2 team_for_game=8
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478039), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 2349.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482783), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 737.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=55.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 1220.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482169), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 268
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 2874.0, 1550.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010026)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025010036 from data/20252026/shifts/shifts_2025010036.pkl
INFO:root:Loaded cached shifts for game 2025010047 from data/20252026/shifts/shifts_2025010047.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010026 rows_in_game=268 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010026 df_game_rows=268
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025010036 season=20252026
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010047 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010047 key=5v4 len=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=4 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(6)} team=np.int64(6)
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=34.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 838.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=1 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482177), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=151.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1154.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=298.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 3400.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=70.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1042.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=97.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 805.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481556), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=321.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=4 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480022), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=212.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1303.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=4 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480035), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=130.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1020.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=83.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 829.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=1 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482213), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=137.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 801.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=69.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 999.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=206.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1281.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=4 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476854), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=37.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 676.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481848), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=118.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 902.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477887), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=38.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1049.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=1 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478401), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=77.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1209.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481219), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=72.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1056.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483017), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=100.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 839.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=135.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1168.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=166.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1030.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=4 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476374), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=12.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1348.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010047 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (240, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=64.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 931.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480355), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=34.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1132.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=41.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 893.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=1 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479591), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=151.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1116.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[418.0, 3400.0, 1072.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480887), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=148.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1227.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=18.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[298.0, 3400.0, 1168.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010047)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025010063 from data/20252026/shifts/shifts_2025010063.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010047 rows_in_game=240 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010047 df_game_rows=240

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010047 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (240, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010063 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010063 key=5v4 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(6)} team=np.int64(6)
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=15.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1175.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010063 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477956), 'team': 6} (team=6) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=169.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1244.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=4 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479369), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480280), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1478.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=116.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 818.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483489), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=90.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1220.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478502), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=91.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1155.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=89.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 776.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479661), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=51.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 775.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 913.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483760), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=200.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1227.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=5 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476854), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=69.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1074.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477496), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=20.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 775.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010063 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481848), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=130.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1029.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478401), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=149.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1544.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=4 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477507), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=80.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 730.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482634), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 854.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010063 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483017), 'team': 6} (team=6) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=25.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1122.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=96.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 833.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=131.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 930.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=4 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476374), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=99.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1220.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=180.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1537.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=5 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479325), 'team': 6} team=6
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=12.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 987.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010063 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482399), 'team': 6} (team=6) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=22.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 684.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475235), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 3895.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=123.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1378.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=102.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1259.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=123.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3895.0, 1137.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=87.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3895.0, 1021.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010063)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025010083 from data/20252026/shifts/shifts_2025010083.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010063 rows_in_game=241 parsed_intervals=2 team_for_game=6
_apply_intervals: game 2025010063 df_game_rows=241
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479999), 'team': 6} team=6
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010083 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025010083 key=5v4 len=1
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(2)} team=np.int64(2)
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=57.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 903.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476419), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=154.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1410.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=310.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 3502.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=28.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476429), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=30.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 883.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010083 intervals_parsed= 1
skipped_games (sample): [('2025010083', 'no_matches')]
df_in shape: (210, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=100.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 829.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1028.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478009), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 1044.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481601), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=58.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 1024.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477506), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=81.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 624.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=132.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1088.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=83.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 845.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=31.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 812.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475231), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=29.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 734.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483553), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=131.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1124.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=157.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1047.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=80.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 953.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=60.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 982.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476917), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=30.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[88.0, 3502.0, 1212.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8485366), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=181.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1343.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 210
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=17.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[310.0, 3502.0, 1077.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025010083)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025010094 from data/20252026/shifts/shifts_2025010094.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010083 rows_in_game=210 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010083 df_game_rows=210

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010083 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (210, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: get_game_intervals_cached HIT 2025010094 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025010094 key=5v4 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(1)} team=np.int64(1)
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=52.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1312.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481032), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 1528.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1127.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483085), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=39.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1230.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482194), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=20.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 974.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476822), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=21.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1312.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010094 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479395), 'team': 1} (team=1) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=42.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 1081.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=47.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 1105.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1071.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010094 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481721), 'team': 1} (team=1) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=63.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 950.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479291), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1145.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482873), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 716.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=99.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1086.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484177), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=40.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1229.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480467), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 3873.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=170.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 3890.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474596), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=40.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 1159.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=20.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1408.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025010094 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (272, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480884), 'team': 1} (team=1) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=104.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[170.0, 3863.0, 1329.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482941), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 272
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[82.0, 3863.0, 1528.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025010094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020012 from data/20252026/shifts/shifts_2025020012.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025010094 rows_in_game=272 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025010094 df_game_rows=272
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020012 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020012 key=5v4 len=5
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(13)} team=np.int64(13)
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 32 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=40.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 746.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480003), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=51.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1423.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478859), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 862.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 892.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=136.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 3564.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475683), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=48.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1026.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8473507), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=74.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 980.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=49.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 467.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475179), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=222.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 17 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=57.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 485.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=49.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1329.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477495), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=63.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 986.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480185), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=34.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1046.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482113), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=41.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1174.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8473419), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=32.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 958.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478542), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=132.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 587.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=215.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1281.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1001.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=52.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1374.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 958.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477409), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=418.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 3526.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 32 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=38.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1404.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478055), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=132.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 992.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=149.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1041.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=38.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1400.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477932), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=52.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1321.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477933), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=6.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[136.0, 3490.0, 1166.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477935), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=45.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1035.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=111.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 866.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=306.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 1635.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 25 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 275
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3490.0, 957.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020012)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020030 from data/20252026/shifts/shifts_2025020030.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020012 rows_in_game=275 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020012 df_game_rows=275
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020030 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020030 key=5v4 len=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=3 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(12)} team=np.int64(12)
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 35 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=480.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 3883.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 35 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=33.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1089.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=92.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1008.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=3 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476958), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=47.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 476.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=1 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480762), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=217.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1121.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 24 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=193.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1205.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1250.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=2 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482093), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=75.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1556.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=2 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480817), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=90.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1008.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=2 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482100), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=100.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 890.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8473533), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=45.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 626.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=1 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480829), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=167.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 632.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=162.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1380.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480336), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=268.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1376.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 22 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=113.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1235.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=2 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478427), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=81.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 980.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=140.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1009.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=32.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1225.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=1 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476906), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=249.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 3881.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=3 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475883), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=189.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 861.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=128.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1057.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=214.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 862.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 17 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 822.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=4 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476921), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=48.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[249.0, 3881.0, 1155.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=1 team_for_game=12
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478970), 'team': 12} team=12
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=289.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1774.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315
Filtered season dataframe to 23 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 315
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3881.0, 1162.0, 3883.0]
DEBUG: intervals_input keys: [np.int64(2025020030)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025020044 from data/20252026/shifts/shifts_2025020044.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020030 rows_in_game=315 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020030 df_game_rows=315

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020030 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (315, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020044 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020044 key=5v4 len=5
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 24 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 39 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(13)} team=np.int64(13)
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 558.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020044 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480003), 'team': 13} (team=13) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=268.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1251.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=6 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 21 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478859), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=26.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 892.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=51.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 966.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8473507), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=221.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1045.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=149.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1001.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=123.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1438.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=4 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477495), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=396.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 968.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=8 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 32 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480185), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=545.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 3478.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=6 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 39 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480193), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=121.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 927.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482113), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=43.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1075.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8473419), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 993.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020044 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478542), 'team': 13} (team=13) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 634.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 591.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020044 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484304), 'team': 13} (team=13) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=332.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1359.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=406.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 854.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=8 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 30 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479316), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=245.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1013.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=22.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1049.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477409), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=500.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 24 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=393.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1399.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 29 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478055), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=143.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1142.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=160.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1233.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=248.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1415.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=5 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 20 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477932), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=100.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[545.0, 3478.0, 1227.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=4 team_for_game=13
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477933), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=123.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1016.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=164.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 633.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=349.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[500.0, 3478.0, 1496.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020044)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020066 from data/20252026/shifts/shifts_2025020066.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020044 rows_in_game=248 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020044 df_game_rows=248
Filtered season dataframe to 20 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
Processed 10/37 (0.07 games/s)
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020066 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020066 key=5v4 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(52)} team=np.int64(52)
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[24.0, 3538.0, 1352.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[24.0, 3538.0, 3538.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=169.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1346.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=4 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480145), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476945), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=128.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 687.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481043), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=71.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 678.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480289), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[24.0, 3538.0, 796.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 655.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=2 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484135), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=133.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1397.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=4 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476331), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[24.0, 3538.0, 1191.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1124.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476460), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=102.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1127.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478398), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=158.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 860.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476480), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 1461.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477504), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=62.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 845.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476871), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=92.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 951.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=3 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474568), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=49.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 843.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480113), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=216.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3538.0, 899.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=4 team_for_game=52
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477938), 'team': 52} team=52
xgs_map: using provided DataFrame (in-memory) -> rows= 203
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[24.0, 3538.0, 1475.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020066)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020081 from data/20252026/shifts/shifts_2025020081.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020066 rows_in_game=203 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020066 df_game_rows=203
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020081 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020081 key=5v4 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 25 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(30)} team=np.int64(30)
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=57.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 805.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=1 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483460), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=191.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1570.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 981.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=1 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475149), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1119.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=77.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1405.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481557), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=142.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1314.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=4 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478493), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=107.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1081.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482079), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=63.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 916.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=152.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1239.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=77.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1329.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476463), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=105.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1070.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478136), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=153.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1421.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=5 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482122), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 570.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=148.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1086.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=96.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 714.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475220), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=143.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1160.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=92.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 1219.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=2 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474716), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 3757.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 25 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3757.0, 3757.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=4 team_for_game=30
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482661), 'team': 30} team=30
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=150.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1228.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=147.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1214.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=170.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 728.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 256
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=212.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3757.0, 1798.0, 3757.0]
DEBUG: intervals_input keys: [np.int64(2025020081)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020094 from data/20252026/shifts/shifts_2025020094.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020081 rows_in_game=256 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020081 df_game_rows=256
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020094 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020094 key=5v4 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 22 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(55)} team=np.int64(55)
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=288.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1309.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 21 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 785.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=81.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 1233.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=2 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476457), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 523.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020094 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (280, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484779), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=97.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1136.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=86.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 1103.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476467), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=75.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 715.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=2 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482751), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=156.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 2370.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478916), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=50.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 1523.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478407), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=73.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 568.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=86.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 676.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=3 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481789), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=191.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1264.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=64.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 703.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477401), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=244.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1004.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 930.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=2 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479324), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=364.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 3539.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 22 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=41.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1067.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=68.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 1077.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=2 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476905), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=20.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[160.0, 2729.0, 1205.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=1 team_for_game=55
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482665), 'team': 55} team=55
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=195.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1056.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1023.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 280
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=197.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[441.0, 2729.0, 1447.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020094)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020112 from data/20252026/shifts/shifts_2025020112.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020094 rows_in_game=280 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020094 df_game_rows=280
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020112 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020112 key=5v4 len=5
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(9)} team=np.int64(9)
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 30 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=118.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1615.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478469), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=381.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1546.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 23 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=33.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 679.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=311.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 965.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 21 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=73.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1131.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8473512), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=172.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1074.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482092), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=147.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1273.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=57.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 733.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482095), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=189.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1363.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=5 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482105), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=80.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1244.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475324), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=211.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1372.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=6 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481596), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1126.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=3 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482116), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=125.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1034.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482245), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=285.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476999), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 704.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020112 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (240, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474189), 'team': 9} (team=9) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=188.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 506.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=177.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1069.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=220.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 985.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=14.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1433.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020112 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (240, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 655.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020112 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (240, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484321), 'team': 9} (team=9) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=587.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 3492.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 30 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=107.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1283.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=197.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1027.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 457.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020112 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (240, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480245), 'team': 9} (team=9) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=21.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[285.0, 3492.0, 1009.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474102), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=194.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 711.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=376.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 1451.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240
Filtered season dataframe to 22 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 240
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[587.0, 3492.0, 861.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020112)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025020127 from data/20252026/shifts/shifts_2025020127.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020112 rows_in_game=240 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020112 df_game_rows=240

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020112 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (240, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020127 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020127 key=5v4 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 21 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(2)} team=np.int64(2)
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=205.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 820.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=5 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476419), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=131.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1642.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=138.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1178.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476429), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=105.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1222.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475151), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=18.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 959.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=80.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1156.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=313.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 21 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478009), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=93.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1441.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477500), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=174.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 924.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=4 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481601), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=175.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1410.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=5 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477506), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=18.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 413.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=131.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1066.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=140.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1154.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=49.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 495.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475231), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=80.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1259.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 727.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020127 intervals_parsed= 1
skipped_games (sample): [('2025020127', 'no_matches')]
df_in shape: (293, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480874), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=143.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1364.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=146.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1339.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=5 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476917), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 825.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=167.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[313.0, 3900.0, 1660.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8485366), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 293
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=75.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3900.0, 1627.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020127)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020150 from data/20252026/shifts/shifts_2025020150.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020127 rows_in_game=293 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020127 df_game_rows=293
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020150 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020150 key=5v4 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 22 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(5)} team=np.int64(5)
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=272.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=4 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481668), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1061.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=2 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478854), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=153.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1698.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 3884.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 22 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=31.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 927.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020150 intervals_parsed= 1
skipped_games (sample): [('2025020150', 'no_matches')]
df_in shape: (290, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=67.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1413.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475810), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=141.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 889.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=90.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1270.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=2 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8471724), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=138.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1142.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 792.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=1 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020150 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (290, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483503), 'team': 5} (team=5) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 873.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=1 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020150 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (290, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476856), 'team': 5} (team=5) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=180.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 848.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481481), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=27.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 946.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=1 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480842), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=51.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 579.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=180.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1902.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=5 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474578), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=119.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1233.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=142.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 681.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=2 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480980), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=150.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1294.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=87.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1048.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=121.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 790.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=4 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478569), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=117.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1220.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=178.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1415.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=5 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478450), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=179.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 774.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=7.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[272.0, 3884.0, 1395.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=1 team_for_game=5
_apply_intervals: game 2025020150 df_game_rows=290

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020150 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (290, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8471675), 'team': 5} (team=5) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 290
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=274.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3884.0, 1689.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020150)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020170 from data/20252026/shifts/shifts_2025020170.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020150 rows_in_game=290 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020150 df_game_rows=290
Filtered season dataframe to 21 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020170 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020170 key=5v4 len=1
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(18)} team=np.int64(18)
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3.0, 3503.0, 726.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477446), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=155.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1432.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3.0, 3503.0, 787.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482062), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=38.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 990.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=63.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 965.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 317.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3.0, 3503.0, 1298.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476869), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=52.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 648.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=113.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1260.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1003.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=237.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 3592.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=80.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1065.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=75.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1025.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3.0, 3503.0, 3511.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477424), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=81.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 936.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[3.0, 3503.0, 1142.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480246), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=152.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1483.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3503.0, 1127.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020170)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025020188 from data/20252026/shifts/shifts_2025020188.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020170 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020170 df_game_rows=262

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020170 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (262, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020188 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020188 key=5v4 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(10)} team=np.int64(10)
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=179.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1105.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=5 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476931), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476932), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=232.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1439.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=55.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1028.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=15.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 965.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=192.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1204.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=4 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482720), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1008.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475171), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=103.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1239.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=143.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 890.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=4 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475690), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=23.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 668.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 920.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020188 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (284, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481582), 'team': 10} (team=10) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=32.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1197.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476853), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=84.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 669.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481848), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=124.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 668.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475714), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=86.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 681.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=91.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1018.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=183.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1219.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=4 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479318), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=119.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 987.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=77.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482783), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=184.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1262.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=4 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481122), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 2433.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=41.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 868.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478057), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=188.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1440.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=4 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478443), 'team': 10} team=10
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=133.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1097.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 856.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=228.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1447.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=11.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 2882.0, 1225.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=167.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[617.0, 2882.0, 1011.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020188)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020196 from data/20252026/shifts/shifts_2025020196.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020188 rows_in_game=284 parsed_intervals=4 team_for_game=10
_apply_intervals: game 2025020188 df_game_rows=284
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478462), 'team': 10} team=10
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020196 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020196 key=5v4 len=1
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 21 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(20)} team=np.int64(20)
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=101.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1418.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=42.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 689.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481167), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=42.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1122.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480797), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=97.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 3560.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481692), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=55.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1559.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477346), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=122.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1075.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=40.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1051.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474150), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=16.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1107.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020196 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (260, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476456), 'team': 20} (team=20) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=17.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 637.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020196 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (260, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481068), 'team': 20} (team=20) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=124.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1171.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=31.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 549.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=116.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1276.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=40.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 884.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484180), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=77.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1032.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=44.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1395.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480860), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=217.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 3492.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 21 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482783), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=79.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1300.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=39.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1050.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=1 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476399), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[97.0, 3452.0, 1321.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=20
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477810), 'team': 20} team=20
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=115.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 735.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=103.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[217.0, 3452.0, 1500.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020196)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020204 from data/20252026/shifts/shifts_2025020204.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020196 rows_in_game=260 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020196 df_game_rows=260
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020204 key=4v5 len=5
DEBUG: get_game_intervals_cached HIT 2025020204 key=5v4 len=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 30 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(8)} team=np.int64(8)
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 20 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1403.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483457), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=261.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1135.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 21 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478851), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=431.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 30 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478470), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=265.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1547.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=73.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1284.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1287.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480018), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=222.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1436.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=127.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1188.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=241.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 899.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=6 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476981), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=252.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 986.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=6 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478133), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 903.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481593), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1109.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=1 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483515), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=400.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1671.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=4 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 28 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476875), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=30.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 643.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020204 intervals_parsed= 1
skipped_games (sample): [('2025020204', 'no_matches')]
df_in shape: (299, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=70.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 638.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=181.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 979.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=4 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481618), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=74.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1141.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=176.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 796.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=4 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482775), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1124.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=195.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[431.0, 3895.0, 1438.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=4 team_for_game=8
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480865), 'team': 8} team=8
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=322.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 3895.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 20 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=74.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1286.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 649.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 299
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=218.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[322.0, 3895.0, 1506.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020204)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020223 from data/20252026/shifts/shifts_2025020223.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020204 rows_in_game=299 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020204 df_game_rows=299
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
Processed 20/37 (0.07 games/s)
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020223 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020223 key=5v4 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(18)} team=np.int64(18)
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 22 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 762.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477446), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 738.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479370), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=196.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1495.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=25.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 1134.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475158), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=92.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 1054.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475287), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 851.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481056), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=148.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1120.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=134.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=27.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 685.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482103), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 673.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=188.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1313.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=179.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 941.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 22 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=196.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1123.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 1300.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479980), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 1390.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=1 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483565), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 3486.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477424), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3486.0, 1086.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=18
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480246), 'team': 18} team=18
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=38.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 806.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020223 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (284, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 284
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=300.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3486.0, 1587.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020223)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020232 from data/20252026/shifts/shifts_2025020232.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020223 rows_in_game=284 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020223 df_game_rows=284
Filtered season dataframe to 22 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020232 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020232 key=5v4 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(9)} team=np.int64(9)
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1382.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478469), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=139.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1418.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 3799.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=51.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1071.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=85.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1011.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=139.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1100.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8473512), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 944.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=3 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482092), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=84.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 999.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=55.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1098.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482095), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=178.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1440.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=3 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482105), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1136.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475324), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1151.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=3 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481596), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=138.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1106.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482116), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=114.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1103.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482245), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1039.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481606), 'team': 9} (team=9) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 3799.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476999), 'team': 9} team=9
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 641.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474189), 'team': 9} (team=9) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=80.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 555.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 2
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=103.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1142.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=89.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1134.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1475.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=71.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1222.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=17.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 617.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479336), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 625.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=9
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476393), 'team': 9} (team=9) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 866.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=144.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1560.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 251
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3799.0, 1385.0, 3799.0]
DEBUG: intervals_input keys: [np.int64(2025020232)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025020266 from data/20252026/shifts/shifts_2025020266.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020232 rows_in_game=251 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020232 df_game_rows=251

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020232 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (251, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020266 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020266 key=5v4 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(22)} team=np.int64(22)
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=179.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1484.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=27.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 936.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=118.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1045.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=4 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474641), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=139.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1425.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=4 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480803), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=106.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 928.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=153.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1191.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=117.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 965.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=4 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483512), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=161.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1254.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477498), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=162.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1359.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478013), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=45.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1294.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=1 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478402), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 670.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477508), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=6.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 682.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020266 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (248, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=26.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 470.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=107.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1020.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481617), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=138.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1131.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=4 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475218), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=104.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 547.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481491), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=45.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1257.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=33.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1147.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=31.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 893.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=1 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477406), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 3679.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=300.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 3679.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479973), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=89.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1219.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=43.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[300.0, 3679.0, 1327.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=1 team_for_game=22
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477934), 'team': 22} team=22
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=45.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1166.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=64.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 650.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 248
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=187.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3679.0, 1449.0, 3679.0]
DEBUG: intervals_input keys: [np.int64(2025020266)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020280 from data/20252026/shifts/shifts_2025020280.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020266 rows_in_game=248 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020266 df_game_rows=248
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020280 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020280 key=5v4 len=1
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(19)} team=np.int64(19)
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=34.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 712.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477573), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=26.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 760.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478472), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=72.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1360.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=13.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 957.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=27.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1216.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480023), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=33.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 673.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480281), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476412), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=46.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1070.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1617.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481598), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=32.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 915.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480459), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=50.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 581.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=46.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1246.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=37.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 766.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482516), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1120.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477402), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1029.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 770.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476897), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=46.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1283.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1468.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475753), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 994.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=83.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1403.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475764), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=48.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 967.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 235
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=74.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3900.0, 1425.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020280)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020293 from data/20252026/shifts/shifts_2025020293.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020280 rows_in_game=235 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020280 df_game_rows=235
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020293 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020293 key=5v4 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(25)} team=np.int64(25)
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=116.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 1286.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=83.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 1416.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480036), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=143.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 1035.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 994.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=26.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 1068.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482740), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=37.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 978.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480950), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=57.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 852.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480840), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 781.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=60.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 944.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=33.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 747.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020293 intervals_parsed= 1
skipped_games (sample): [('2025020293', 'no_matches')]
df_in shape: (255, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476889), 'team': 25} (team=25) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=6.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 909.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020293 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (255, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=58.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 963.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484829), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=37.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 874.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482145), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=37.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 1247.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483425), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=176.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 3596.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=83.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 1363.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476902), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=28.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 955.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479979), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 968.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020293 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (255, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=29.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3596.0, 969.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=25
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479351), 'team': 25} team=25
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 1295.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 255
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=117.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[176.0, 3596.0, 1302.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020293)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020324 from data/20252026/shifts/shifts_2025020324.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020293 rows_in_game=255 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020293 df_game_rows=255
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020324 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020324 key=5v4 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(19)} team=np.int64(19)
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=97.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 641.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477573), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=89.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1499.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=89.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1115.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480023), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=72.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 675.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480281), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 933.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020324 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (263, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482077), 'team': 19} (team=19) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=58.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1137.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=85.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 917.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=134.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1567.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481598), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=52.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 882.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480459), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=96.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 945.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 3831.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480981), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=47.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 616.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482516), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=89.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1144.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477402), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1097.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1526.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476892), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=79.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 740.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476897), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=186.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 3826.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=28.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1219.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=106.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1499.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=2 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475753), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=33.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 679.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481006), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=92.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1083.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=73.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3826.0, 1395.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=1 team_for_game=19
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475764), 'team': 19} team=19
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=97.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 743.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 263
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=90.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[186.0, 3826.0, 1573.0, 3831.0]
DEBUG: intervals_input keys: [np.int64(2025020324)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020339 from data/20252026/shifts/shifts_2025020339.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020324 rows_in_game=263 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020324 df_game_rows=263
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020339 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020339 key=5v4 len=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=4 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 37 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(1)} team=np.int64(1)
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1211.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480002), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=69.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 618.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476292), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=73.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 1402.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 934.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=218.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 734.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=6 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 25 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476822), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=49.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 858.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=128.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 956.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 583.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020339 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (289, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474149), 'team': 1} (team=1) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=73.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1205.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483495), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 567.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020339 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (289, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477996), 'team': 1} (team=1) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=131.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 916.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 17 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=202.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1346.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=6 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476462), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=73.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1250.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479407), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=74.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 687.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476474), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=181.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1225.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=4 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482110), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=296.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1155.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=6 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 24 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475455), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=188.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1087.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=7 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 20 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478399), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=39.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 734.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=53.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1183.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478414), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=128.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 982.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=194.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 956.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=6 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 26 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477015), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=48.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 988.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=199.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 3598.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=480.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 3572.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=4 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 37 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474596), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 1107.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=206.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[480.0, 3570.0, 1349.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=5 team_for_game=1
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 23 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482684), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=25.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 1040.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020339 intervals_parsed= 1
skipped_games (sample): [('2025020339', 'no_matches')]
df_in shape: (289, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 289
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=149.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[199.0, 3570.0, 1362.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020339)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020353 from data/20252026/shifts/shifts_2025020353.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020339 rows_in_game=289 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020339 df_game_rows=289
Filtered season dataframe to 17 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020353 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020353 key=5v4 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(14)} team=np.int64(14)
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=110.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1570.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=155.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 3512.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=4.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 911.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=12.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 927.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476826), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=74.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1085.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=101.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 986.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 1176.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479542), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=23.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 1050.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478519), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=17.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 537.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020353 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (225, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=26.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1078.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020353 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (225, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476883), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=43.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 907.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=40.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1013.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=45.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1267.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=35.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 1418.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482655), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=3.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 1448.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478178), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1204.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=42.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1109.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=32.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[35.0, 3512.0, 1395.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=14
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482929), 'team': 14} team=14
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=86.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1479.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 225
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=8.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[155.0, 3512.0, 1173.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020353)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025020363 from data/20252026/shifts/shifts_2025020363.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020353 rows_in_game=225 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020353 df_game_rows=225

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020353 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (225, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020363 key=4v5 len=1
DEBUG: get_game_intervals_cached HIT 2025020363 key=5v4 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(13)} team=np.int64(13)
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1028.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480003), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=215.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1383.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=71.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1258.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478859), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=18.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 942.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020363 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (265, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475683), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=135.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 948.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=134.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 810.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=48.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 716.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=62.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1315.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477495), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=34.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1045.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020363 intervals_parsed= 1
skipped_games (sample): [('2025020363', 'no_matches')]
df_in shape: (265, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8473419), 'team': 13} (team=13) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=46.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1078.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478542), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=142.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 728.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 855.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020363 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (265, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484304), 'team': 13} (team=13) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=27.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 884.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478421), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=148.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1000.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=80.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1066.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=54.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1300.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478055), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=97.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1080.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=49.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1303.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477932), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1178.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=2 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477933), 'team': 13} team=13
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=49.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3600.0, 1091.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=1 team_for_game=13
_apply_intervals: game 2025020363 df_game_rows=265

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020363 intervals_parsed= 1
skipped_games (sample): [('2025020363', 'no_matches')]
df_in shape: (265, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477935), 'team': 13} (team=13) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=64.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 960.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=149.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 800.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 265
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=210.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3600.0, 1511.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020363)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020381 from data/20252026/shifts/shifts_2025020381.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020363 rows_in_game=265 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020363 df_game_rows=265
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020381 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020381 key=5v4 len=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(2)} team=np.int64(2)
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 27 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=211.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479496), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=353.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1486.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=560.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 27 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=84.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1003.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476429), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=69.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 565.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475151), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=180.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 996.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=73.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1104.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482476), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=238.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1056.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=36.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 616.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=70.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1481.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477500), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=115.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1002.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=3 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481601), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=125.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1245.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=4 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477506), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=14.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1201.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=173.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 753.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=191.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1019.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=24.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 596.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=1 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481237), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=191.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1057.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=12.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1180.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=69.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 653.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475231), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=140.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1077.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=163.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1073.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=127.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1408.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=4 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476917), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[211.0, 3900.0, 1733.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=2 team_for_game=2
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8485366), 'team': 2} team=2
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=169.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 862.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 262
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=380.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[560.0, 3900.0, 1594.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020381)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020395 from data/20252026/shifts/shifts_2025020395.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020381 rows_in_game=262 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020381 df_game_rows=262
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
Processed 30/37 (0.07 games/s)
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020395 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020395 key=5v4 len=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(1)} team=np.int64(1)
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 30 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=105.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1432.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480002), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=228.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1390.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=10.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 934.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020395 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (282, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 792.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 724.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479996), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 620.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476822), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=77.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 862.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=257.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1140.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 23 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=5.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1216.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020395 intervals_parsed= 1
skipped_games (sample): [('2025020395', 'no_matches')]
df_in shape: (282, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483495), 'team': 1} (team=1) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=291.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1049.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 21 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=138.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1535.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476462), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=1.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1252.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020395 intervals_parsed= 1
skipped_games (sample): [('2025020395', 'no_matches')]
df_in shape: (282, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479407), 'team': 1} (team=1) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 614.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476474), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1129.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482110), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=134.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1237.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478399), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=65.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 864.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475455), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=11.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 989.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020395 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (282, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=305.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1492.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 23 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=173.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1152.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=99.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 918.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477015), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=137.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1017.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=109.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1190.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=209.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 3587.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474593), 'team': 1} team=1
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=449.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 30 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=58.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 1047.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=81.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[449.0, 3587.0, 975.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482159), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 282
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=78.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[209.0, 3587.0, 1321.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020395)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020407 from data/20252026/shifts/shifts_2025020407.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020395 rows_in_game=282 parsed_intervals=3 team_for_game=1
_apply_intervals: game 2025020395 df_game_rows=282
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482684), 'team': 1} team=1
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020407 key=4v5 len=4
DEBUG: get_game_intervals_cached HIT 2025020407 key=5v4 len=6
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 17 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=6 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 28 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(5)} team=np.int64(5)
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=140.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1173.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=4 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478854), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1094.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=18.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1093.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8471675), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=66.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1209.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=7.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 922.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020407 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (279, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481553), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=444.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=6 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 28 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477465), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=70.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 751.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=2 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8483487), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=186.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1145.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=6 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475810), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=90.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 820.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=157.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1027.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8485414), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=139.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1204.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8471724), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 915.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=19.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 799.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=62.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1075.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=3 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477365), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=181.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 745.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=6 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481481), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=20.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 654.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=242.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1273.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=4 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8474578), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=92.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1078.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=274.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 792.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=8 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 20 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480980), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=48.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 960.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=48.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1157.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=237.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 17 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=123.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1160.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=290.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1247.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 17 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478450), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 816.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=1 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020407 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (279, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475763), 'team': 5} (team=5) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=91.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 979.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=15.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[444.0, 3600.0, 1008.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=2 team_for_game=5
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477435), 'team': 5} team=5
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=145.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1328.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 279
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=7.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[237.0, 3600.0, 1177.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020407)] types=[<class 'numpy.int64'>]
INFO:root:Loaded cached shifts for game 2025020423 from data/20252026/shifts/shifts_2025020423.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020407 rows_in_game=279 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020407 df_game_rows=279

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020407 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (279, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481533), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020423 key=4v5 len=6
DEBUG: get_game_intervals_cached HIT 2025020423 key=5v4 len=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 28 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=4 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 38 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(7)} team=np.int64(7)
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=159.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 637.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481546), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=577.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 3597.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 28 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=522.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 38 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481551), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1052.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=8 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=288.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1213.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=9 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 27 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480802), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=178.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 796.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=5 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=342.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1257.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=8 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 31 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480807), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=327.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1227.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 17 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=94.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 748.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=26.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 926.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=1 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482097), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=150.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 837.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=4 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484145), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=15.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1054.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=1 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479420), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=25.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 452.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=1 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482623), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=10.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1055.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=1 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480064), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=42.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1127.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=133.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 737.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=350.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1263.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=7 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=288.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1063.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=69.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1385.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=134.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 995.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=287.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1016.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=8 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 25 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479982), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=222.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1294.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=5 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 19 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482671), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=19.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 571.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=2 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481522), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=193.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1429.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=5 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481524), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=294.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[580.0, 3597.0, 1422.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=4
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=315.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 1171.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=8 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 30 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477949), 'team': 7} team=7
xgs_map: using provided DataFrame (in-memory) -> rows= 287
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=196.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[522.0, 3597.0, 669.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020423)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020453 from data/20252026/shifts/shifts_2025020453.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020423 rows_in_game=287 parsed_intervals=6 team_for_game=7
_apply_intervals: game 2025020423 df_game_rows=287
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479359), 'team': 7} team=7
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020453 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020453 key=5v4 len=1
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 17 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(21)} team=np.int64(21)
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=223.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 3489.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 17 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=55.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 1003.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476312), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=78.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 843.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481178), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=52.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1099.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=71.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1060.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=77.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 507.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=32.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 922.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020453 intervals_parsed= 1
skipped_games (sample): [('2025020453', 'no_matches')]
df_in shape: (267, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477501), 'team': 21} (team=21) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 618.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=3 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480448), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=89.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 904.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=3 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480835), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=48.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 1551.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020453 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (267, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480069), 'team': 21} (team=21) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=120.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478406), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=64.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 560.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=147.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1330.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=75.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 1168.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8470613), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=64.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 1253.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478038), 'team': 21} team=21
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=116.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1065.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=37.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1396.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=65.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1240.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478439), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=29.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[120.0, 3489.0, 1158.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=21
_apply_intervals: game 2025020453 df_game_rows=267

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020453 intervals_parsed= 1
skipped_games (sample): [('2025020453', 'no_matches')]
df_in shape: (267, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475754), 'team': 21} (team=21) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=40.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 611.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 267
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=145.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[223.0, 3489.0, 1553.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020453)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020469 from data/20252026/shifts/shifts_2025020469.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020453 rows_in_game=267 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020453 df_game_rows=267
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020469 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020469 key=5v4 len=2
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(28)} team=np.int64(28)
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 3486.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477968), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1141.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=89.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1110.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480043), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=9.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 528.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=1 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482859), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=90.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1106.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=3 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475181), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1056.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=85.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 760.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=136.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 964.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=4 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484911), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=61.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 955.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=1 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475200), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=75.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1132.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=3 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477505), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=11.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1185.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=1 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484801), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=60.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1032.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484806), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=81.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 772.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=83.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 644.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476624), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=151.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 989.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=3 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480848), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=156.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1234.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 8 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=62.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 925.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=240.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 3600.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=39.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 697.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479336), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=15.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1162.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482667), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=180.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1306.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=4 team_for_game=28
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 13 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479983), 'team': 28} team=28
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=60.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 896.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482804), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=85.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 833.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 242
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=182.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[240.0, 3486.0, 1382.0, 3600.0]
DEBUG: intervals_input keys: [np.int64(2025020469)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020483 from data/20252026/shifts/shifts_2025020483.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020469 rows_in_game=242 parsed_intervals=4 team_for_game=4
_apply_intervals: game 2025020469 df_game_rows=242
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020483 key=4v5 len=2
DEBUG: get_game_intervals_cached HIT 2025020483 key=5v4 len=3
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(54)} team=np.int64(54)
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=211.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1367.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=6 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 15 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477447), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=129.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1137.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475913), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=360.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 3767.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=4 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 18 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481033), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=64.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1117.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 2 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478483), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=82.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 1053.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 6 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=86.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 970.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=18.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 570.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020483 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=207.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1243.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=6 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475188), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=150.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 854.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 11 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8475191), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=149.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1302.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478396), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=104.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1163.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478403), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=78.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 555.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=144.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 1356.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=153.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 1163.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480727), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=72.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 1181.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=168.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 3764.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 10 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478435), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=21.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 821.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020483 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (241, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482804), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=59.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 847.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=88.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 993.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479353), 'team': 54} team=54
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=112.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[168.0, 3764.0, 1585.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 241
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=185.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[360.0, 3764.0, 819.0, 3767.0]
DEBUG: intervals_input keys: [np.int64(2025020483)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
INFO:root:Loaded cached shifts for game 2025020501 from data/20252026/shifts/shifts_2025020501.pkl
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020483 rows_in_game=241 parsed_intervals=5 team_for_game=54
_apply_intervals: game 2025020483 df_game_rows=241
Filtered season dataframe to 14 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476925), 'team': 54} team=54
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: get_game_intervals_cached HIT 2025020501 key=4v5 len=3
DEBUG: get_game_intervals_cached HIT 2025020501 key=5v4 len=0
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'team': np.int64(4)} team=np.int64(4)
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=242.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 3900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 16 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8481035), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 995.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020501 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (260, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480015), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 899.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020501 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (260, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8484387), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=76.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1065.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 4 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477989), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=115.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1090.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476461), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=51.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 790.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 3 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479022), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1378.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020501 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (260, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482126), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=23.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 721.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 1 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477903), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=148.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1377.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8476372), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=98.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 922.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 9 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8480220), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=2.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1322.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=1 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260

_apply_intervals debug: no rows matched any intervals
intervals_obj per_game count = 1
 game 2025020501 intervals_parsed= 1
skipped_games (sample): []
df_in shape: (260, 26) columns_count= 26
Warning: condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482142), 'team': 4} (team=4) matched 0 rows; producing an empty plot without training/loading model
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=118.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 876.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 7 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8479336), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=92.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 984.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8482804), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=96.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 900.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=2 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 5 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8478454), 'team': 4} team=4
xgs_map: using provided DataFrame (in-memory) -> rows= 260
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=145.0 conditions=['game_state', 'is_net_empty', 'player_id', 'team'] pooled=[242.0, 3897.0, 1548.0, 3900.0]
DEBUG: intervals_input keys: [np.int64(2025020501)] types=[<class 'numpy.int64'>]
/home/spoon/new_puck/.venv/lib/python3.13/site-packages/sklearn/utils/validation.py:2742: UserWarning: X has feature names, but RandomForestClassifier was fitted without feature names
  warnings.warn(
_apply_intervals: intervals per_game count=1
_apply_intervals: game 2025020501 rows_in_game=260 parsed_intervals=3 team_for_game=4
_apply_intervals: game 2025020501 df_game_rows=260
Filtered season dataframe to 12 events by condition {'game_state': ['4v5'], 'is_net_empty': [0], 'player_id': np.int64(8477948), 'team': 4} team=4
Cache processing complete.
Config: Mode=aggressive, Workers=1, Platform=Pi
--- Cached Player Analysis for 20252026 ---
DEBUG: Process ID: 1906
Loading season data...
Loaded season dataframe from data/20252026/20252026_df.csv -> shape=(9449, 25)
DEBUG: Filtered df_data size: 7805
DEBUG: Sample game_ids in global df: [2025010008 2025010026 2025010036 2025010047 2025010063]
Found 498 players needing updates.
Sanitized PIDs: 498 unique integers.
DEBUG_UNIQUENESS: Total=498, Unique=498
DEBUG: df_data['player_id'] type: float64
Loading league baseline...
league: loading baseline from analysis/league/20252026/5v5/20252026_league_baseline.npy
league: failed to load baseline: Expecting value: line 195 column 17 (char 4902). Recomputing...
league: computing baseline for 20252026...
Loaded season dataframe from data/20252026/20252026_df.csv -> shape=(9449, 25)
INFO:root:Loaded cached shifts for game 2025010047 from data/20252026/shifts/shifts_2025010047.pkl
league: Predicting xG...
league: Processing 13 teams...
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=2781.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2884.0, 3400.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025010063 from data/20252026/shifts/shifts_2025010063.pkl
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=2995.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3000.0, 3895.0, 3900.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=2781.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2884.0, 3400.0, 3600.0]
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=2995.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3000.0, 3895.0, 3900.0]
INFO:root:Loaded cached shifts for game 2025020030 from data/20252026/shifts/shifts_2025020030.pkl
league: error processing BOS: 'NoneType' object has no attribute 'get'
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=2869.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2871.0, 3881.0, 3883.0]
INFO:root:Loaded cached shifts for game 2025020501 from data/20252026/shifts/shifts_2025020501.pkl
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=3355.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3358.0, 3897.0, 3900.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=2869.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2871.0, 3881.0, 3883.0]
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=3355.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3358.0, 3897.0, 3900.0]
INFO:root:Loaded cached shifts for game 2025020293 from data/20252026/shifts/shifts_2025020293.pkl
league: error processing CAR: 'NoneType' object has no attribute 'get'
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=3300.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3304.0, 3596.0, 3600.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=3300.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3304.0, 3596.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020012 from data/20252026/shifts/shifts_2025020012.pkl
league: error processing DAL: 'NoneType' object has no attribute 'get'
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=2832.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2916.0, 3490.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020044 from data/20252026/shifts/shifts_2025020044.pkl
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=2378.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2500.0, 3478.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020363 from data/20252026/shifts/shifts_2025020363.pkl
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=3120.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3120.0, 3600.0, 3600.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=2832.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2916.0, 3490.0, 3600.0]
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=2378.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2500.0, 3478.0, 3600.0]
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=3120.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3120.0, 3600.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025010026 from data/20252026/shifts/shifts_2025010026.pkl
league: error processing FLA: 'NoneType' object has no attribute 'get'
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=2417.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3143.0, 2874.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020204 from data/20252026/shifts/shifts_2025020204.pkl
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=2782.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2787.0, 3895.0, 3900.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=2417.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3143.0, 2874.0, 3600.0]
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=2782.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2787.0, 3895.0, 3900.0]
INFO:root:Loaded cached shifts for game 2025010094 from data/20252026/shifts/shifts_2025010094.pkl
league: error processing MTL: 'NoneType' object has no attribute 'get'
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=3226.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3263.0, 3863.0, 3900.0]
INFO:root:Loaded cached shifts for game 2025020339 from data/20252026/shifts/shifts_2025020339.pkl
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=2891.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2921.0, 3570.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020395 from data/20252026/shifts/shifts_2025020395.pkl
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=2898.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2911.0, 3587.0, 3600.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=3226.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3263.0, 3863.0, 3900.0]
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=2891.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2921.0, 3570.0, 3600.0]
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=2898.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2911.0, 3587.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020170 from data/20252026/shifts/shifts_2025020170.pkl
league: error processing NJD: 'NoneType' object has no attribute 'get'
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3179.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3237.0, 3503.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020223 from data/20252026/shifts/shifts_2025020223.pkl
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=3006.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3120.0, 3486.0, 3600.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3179.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3237.0, 3503.0, 3600.0]
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=3006.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3120.0, 3486.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025010008 from data/20252026/shifts/shifts_2025010008.pkl
league: error processing NSH: 'NoneType' object has no attribute 'get'
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=2307.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2939.0, 3017.0, 3900.0]
INFO:root:Loaded cached shifts for game 2025010083 from data/20252026/shifts/shifts_2025010083.pkl
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=3104.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3202.0, 3502.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020127 from data/20252026/shifts/shifts_2025020127.pkl
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=3047.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3047.0, 3900.0, 3900.0]
INFO:root:Loaded cached shifts for game 2025020381 from data/20252026/shifts/shifts_2025020381.pkl
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=2801.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2801.0, 3900.0, 3900.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=2307.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2939.0, 3017.0, 3900.0]
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=3104.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3202.0, 3502.0, 3600.0]
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=3047.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3047.0, 3900.0, 3900.0]
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=2801.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2801.0, 3900.0, 3900.0]
INFO:root:Loaded cached shifts for game 2025020112 from data/20252026/shifts/shifts_2025020112.pkl
league: error processing NYI: 'NoneType' object has no attribute 'get'
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=2500.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2595.0, 3492.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020232 from data/20252026/shifts/shifts_2025020232.pkl
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=2880.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2880.0, 3799.0, 3799.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=2500.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2595.0, 3492.0, 3600.0]
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=2880.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2880.0, 3799.0, 3799.0]
league: error processing OTT: 'NoneType' object has no attribute 'get'
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=2307.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2939.0, 3017.0, 3900.0]
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=2417.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3143.0, 2874.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025010036 from data/20252026/shifts/shifts_2025010036.pkl
DEBUG: _get_shifts_df game=2025010036 season=20252026
DEBUG: gs_timeline len=0
DEBUG: timing_result game=2025010036 inter_sec=0.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[0.0, 0.0, 0.0]
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=2781.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2884.0, 3400.0, 3600.0]
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=2995.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3000.0, 3895.0, 3900.0]
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=3104.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3202.0, 3502.0, 3600.0]
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=3226.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3263.0, 3863.0, 3900.0]
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=2832.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2916.0, 3490.0, 3600.0]
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=2869.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2871.0, 3881.0, 3883.0]
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=2378.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2500.0, 3478.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020066 from data/20252026/shifts/shifts_2025020066.pkl
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=3154.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3216.0, 3538.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020081 from data/20252026/shifts/shifts_2025020081.pkl
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=3000.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3000.0, 3757.0, 3757.0]
INFO:root:Loaded cached shifts for game 2025020094 from data/20252026/shifts/shifts_2025020094.pkl
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=2050.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2787.0, 2729.0, 3600.0]
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=2500.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2595.0, 3492.0, 3600.0]
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=3047.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3047.0, 3900.0, 3900.0]
INFO:root:Loaded cached shifts for game 2025020150 from data/20252026/shifts/shifts_2025020150.pkl
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=2968.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2968.0, 3884.0, 3900.0]
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3179.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3237.0, 3503.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020188 from data/20252026/shifts/shifts_2025020188.pkl
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=2205.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2623.0, 2882.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020196 from data/20252026/shifts/shifts_2025020196.pkl
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=3115.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3263.0, 3452.0, 3600.0]
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=2782.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2787.0, 3895.0, 3900.0]
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=3006.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3120.0, 3486.0, 3600.0]
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=2880.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2880.0, 3799.0, 3799.0]
INFO:root:Loaded cached shifts for game 2025020266 from data/20252026/shifts/shifts_2025020266.pkl
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=3060.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3060.0, 3679.0, 3679.0]
INFO:root:Loaded cached shifts for game 2025020280 from data/20252026/shifts/shifts_2025020280.pkl
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=3360.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3360.0, 3900.0, 3900.0]
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=3300.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3304.0, 3596.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020324 from data/20252026/shifts/shifts_2025020324.pkl
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=3169.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3174.0, 3826.0, 3831.0]
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=2891.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2921.0, 3570.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020353 from data/20252026/shifts/shifts_2025020353.pkl
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=3237.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3325.0, 3512.0, 3600.0]
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=3120.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3120.0, 3600.0, 3600.0]
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=2801.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2801.0, 3900.0, 3900.0]
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=2898.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2911.0, 3587.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020407 from data/20252026/shifts/shifts_2025020407.pkl
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=2757.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2757.0, 3600.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020423 from data/20252026/shifts/shifts_2025020423.pkl
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=2386.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2386.0, 3597.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020453 from data/20252026/shifts/shifts_2025020453.pkl
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=3146.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3257.0, 3489.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020469 from data/20252026/shifts/shifts_2025020469.pkl
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=3006.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3120.0, 3486.0, 3600.0]
INFO:root:Loaded cached shifts for game 2025020483 from data/20252026/shifts/shifts_2025020483.pkl
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=3069.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3072.0, 3764.0, 3767.0]
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=3355.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3358.0, 3897.0, 3900.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025010008 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025010008 inter_sec=2307.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2939.0, 3017.0, 3900.0]
DEBUG: _get_shifts_df game=2025010026 season=20252026
DEBUG: gs_timeline len=11
DEBUG: timing_result game=2025010026 inter_sec=2417.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3143.0, 2874.0, 3600.0]
DEBUG: _get_shifts_df game=2025010036 season=20252026
DEBUG: gs_timeline len=0
DEBUG: timing_result game=2025010036 inter_sec=0.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[0.0, 0.0, 0.0]
DEBUG: _get_shifts_df game=2025010047 season=20252026
DEBUG: gs_timeline len=15
DEBUG: timing_result game=2025010047 inter_sec=2781.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2884.0, 3400.0, 3600.0]
DEBUG: _get_shifts_df game=2025010063 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010063 inter_sec=2995.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3000.0, 3895.0, 3900.0]
DEBUG: _get_shifts_df game=2025010083 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025010083 inter_sec=3104.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3202.0, 3502.0, 3600.0]
DEBUG: _get_shifts_df game=2025010094 season=20252026
DEBUG: gs_timeline len=13
DEBUG: timing_result game=2025010094 inter_sec=3226.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3263.0, 3863.0, 3900.0]
DEBUG: _get_shifts_df game=2025020012 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020012 inter_sec=2832.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2916.0, 3490.0, 3600.0]
DEBUG: _get_shifts_df game=2025020030 season=20252026
DEBUG: gs_timeline len=16
DEBUG: timing_result game=2025020030 inter_sec=2869.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2871.0, 3881.0, 3883.0]
DEBUG: _get_shifts_df game=2025020044 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020044 inter_sec=2378.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2500.0, 3478.0, 3600.0]
DEBUG: _get_shifts_df game=2025020066 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020066 inter_sec=3154.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3216.0, 3538.0, 3600.0]
DEBUG: _get_shifts_df game=2025020081 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020081 inter_sec=3000.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3000.0, 3757.0, 3757.0]
DEBUG: _get_shifts_df game=2025020094 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020094 inter_sec=2050.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2787.0, 2729.0, 3600.0]
DEBUG: _get_shifts_df game=2025020112 season=20252026
DEBUG: gs_timeline len=19
DEBUG: timing_result game=2025020112 inter_sec=2500.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2595.0, 3492.0, 3600.0]
DEBUG: _get_shifts_df game=2025020127 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020127 inter_sec=3047.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3047.0, 3900.0, 3900.0]
DEBUG: _get_shifts_df game=2025020150 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020150 inter_sec=2968.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2968.0, 3884.0, 3900.0]
DEBUG: _get_shifts_df game=2025020170 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020170 inter_sec=3179.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3237.0, 3503.0, 3600.0]
DEBUG: _get_shifts_df game=2025020188 season=20252026
DEBUG: gs_timeline len=17
DEBUG: timing_result game=2025020188 inter_sec=2205.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2623.0, 2882.0, 3600.0]
DEBUG: _get_shifts_df game=2025020196 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020196 inter_sec=3115.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3263.0, 3452.0, 3600.0]
DEBUG: _get_shifts_df game=2025020204 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020204 inter_sec=2782.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2787.0, 3895.0, 3900.0]
DEBUG: _get_shifts_df game=2025020223 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020223 inter_sec=3006.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3120.0, 3486.0, 3600.0]
DEBUG: _get_shifts_df game=2025020232 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020232 inter_sec=2880.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2880.0, 3799.0, 3799.0]
DEBUG: _get_shifts_df game=2025020266 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020266 inter_sec=3060.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3060.0, 3679.0, 3679.0]
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=3360.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3360.0, 3900.0, 3900.0]
DEBUG: _get_shifts_df game=2025020293 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020293 inter_sec=3300.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3304.0, 3596.0, 3600.0]
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=3169.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3174.0, 3826.0, 3831.0]
DEBUG: _get_shifts_df game=2025020339 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020339 inter_sec=2891.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2921.0, 3570.0, 3600.0]
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=3237.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3325.0, 3512.0, 3600.0]
DEBUG: _get_shifts_df game=2025020363 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020363 inter_sec=3120.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3120.0, 3600.0, 3600.0]
DEBUG: _get_shifts_df game=2025020381 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020381 inter_sec=2801.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2801.0, 3900.0, 3900.0]
DEBUG: _get_shifts_df game=2025020395 season=20252026
DEBUG: gs_timeline len=14
DEBUG: timing_result game=2025020395 inter_sec=2898.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2911.0, 3587.0, 3600.0]
DEBUG: _get_shifts_df game=2025020407 season=20252026
DEBUG: gs_timeline len=20
DEBUG: timing_result game=2025020407 inter_sec=2757.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2757.0, 3600.0, 3600.0]
DEBUG: _get_shifts_df game=2025020423 season=20252026
DEBUG: gs_timeline len=21
DEBUG: timing_result game=2025020423 inter_sec=2386.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[2386.0, 3597.0, 3600.0]
DEBUG: _get_shifts_df game=2025020453 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020453 inter_sec=3146.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3257.0, 3489.0, 3600.0]
DEBUG: _get_shifts_df game=2025020469 season=20252026
DEBUG: gs_timeline len=9
DEBUG: timing_result game=2025020469 inter_sec=3006.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3120.0, 3486.0, 3600.0]
DEBUG: _get_shifts_df game=2025020483 season=20252026
DEBUG: gs_timeline len=12
DEBUG: timing_result game=2025020483 inter_sec=3069.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3072.0, 3764.0, 3767.0]
DEBUG: _get_shifts_df game=2025020501 season=20252026
DEBUG: gs_timeline len=8
DEBUG: timing_result game=2025020501 inter_sec=3355.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3358.0, 3897.0, 3900.0]
league: error processing PHI: 'NoneType' object has no attribute 'get'
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=3360.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3360.0, 3900.0, 3900.0]
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=3169.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3174.0, 3826.0, 3831.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025020280 season=20252026
DEBUG: gs_timeline len=6
DEBUG: timing_result game=2025020280 inter_sec=3360.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3360.0, 3900.0, 3900.0]
DEBUG: _get_shifts_df game=2025020324 season=20252026
DEBUG: gs_timeline len=10
DEBUG: timing_result game=2025020324 inter_sec=3169.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3174.0, 3826.0, 3831.0]
league: error processing STL: 'NoneType' object has no attribute 'get'
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=3237.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3325.0, 3512.0, 3600.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025020353 season=20252026
DEBUG: gs_timeline len=7
DEBUG: timing_result game=2025020353 inter_sec=3237.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[3325.0, 3512.0, 3600.0]
league: error processing TBL: 'NoneType' object has no attribute 'get'
DEBUG: _get_shifts_df game=2025010036 season=20252026
DEBUG: gs_timeline len=0
DEBUG: timing_result game=2025010036 inter_sec=0.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[0.0, 0.0, 0.0]
xgs_map: using provided DataFrame (in-memory) -> rows= 9449
DEBUG: _get_shifts_df game=2025010036 season=20252026
DEBUG: gs_timeline len=0
DEBUG: timing_result game=2025010036 inter_sec=0.0 conditions=['game_state', 'is_net_empty', 'team'] pooled=[0.0, 0.0, 0.0]
/home/spoon/new_puck/scripts/run_player_analysis.py:443: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, ax = plt.subplots(figsize=(10, 6))
/home/spoon/new_puck/scripts/run_player_analysis.py:415: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, ax = plt.subplots(figsize=(10, 6))
