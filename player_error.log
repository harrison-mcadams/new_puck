Config: Platform=Mac/PC, Workers=4
Data Dir: C:/Users/harri/Desktop/new_puck/data
--- Cached Player Analysis for 20252026 ---
DEBUG: Process ID: 14684
Loading season data...
Loaded season dataframe from data\20252026.csv -> shape=(162732, 30)
C:\Users\harri\Desktop\new_puck\puck\plot.py:380: UserWarning: You passed a edgecolor/edgecolors ('face') for an unfilled marker ('x').  Matplotlib is ignoring the edgecolor in favor of the facecolor.  This behavior may change in the future.
  h = ax.scatter(grp1[xcol], grp1[ycol], c=c1, marker=m, s=s, edgecolors=ec, zorder=5, alpha=0.7)
C:\Users\harri\Desktop\new_puck\puck\plot.py:386: UserWarning: You passed a edgecolor/edgecolors ('face') for an unfilled marker ('x').  Matplotlib is ignoring the edgecolor in favor of the facecolor.  This behavior may change in the future.
  h2 = ax.scatter(grp2[xcol], grp2[ycol], c=c2, marker=m, s=s, edgecolors=ec, zorder=5, alpha=0.7)
Building Player-Team Map...
DEBUG: Filtered df_data size: 133981
DEBUG: Sample game_ids in global df: [2025020003 2025020002 2025020001 2025020004 2025020005]
Found 901 players needing updates.
Sanitized PIDs: 901 unique integers.
DEBUG_UNIQUENESS: Total=901, Unique=901
DEBUG: df_data['player_id'] type: float64
Loading league baseline...
league: loading baseline from analysis\league\20252026\5v5\20252026_league_baseline.npy
DEBUG: Final pids_sorted len=901
DEBUG: Final pids_sorted unique len=901
DEBUG: Start of pids_sorted: [8470613, 8470621, 8471214, 8471215, 8471675, 8471685, 8471724, 8471734, 8471817, 8473419]
Checking cache dir: C:/Users/harri/Desktop/new_puck/data\cache\20252026\partials
Starting Single-Pass Data Loading for 901 players...
Loading game 0/615...Loading game 20/615...Loading game 40/615...Loading game 60/615...Loading game 80/615...Loading game 100/615...Loading game 120/615...Loading game 140/615...Loading game 160/615...Loading game 180/615...Loading game 200/615...Loading game 220/615...Loading game 240/615...Loading game 260/615...Loading game 280/615...Loading game 300/615...Loading game 320/615...Loading game 340/615...Loading game 360/615...Loading game 380/615...Loading game 400/615...Loading game 420/615...Loading game 440/615...Loading game 460/615...Loading game 480/615...Loading game 500/615...Loading game 520/615...Loading game 540/615...Loading game 560/615...Loading game 580/615...Loading game 600/615...Data Loading Complete. Computing Aggregates...
Calculating Percentiles...
Saved player summary to C:/Users/harri/Desktop/new_puck/analysis\players\20252026\player_summary_5v5.json
Generating Player Scatter Plots...
Filtering players with <= 5 games. Before: 900
After: 817
Generated player scatter plots in C:/Users/harri/Desktop/new_puck/analysis\players\20252026
Preparing tasks...
Generating Plots for 900 players (Serial)...
Processing 0/900...Saved plot to C:/Users/harri/Desktop/new_puck/analysis\players\20252026/COL\8470613_map.png
Traceback (most recent call last):
  File "C:\Users\harri\Desktop\new_puck\scripts\run_player_analysis.py", line 637, in <module>
    run_analysis()
  File "C:\Users\harri\Desktop\new_puck\scripts\run_player_analysis.py", line 469, in run_analysis
    if res is not None and res > global_scan_max:
                                 ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'global_scan_max' where it is not associated with a value
